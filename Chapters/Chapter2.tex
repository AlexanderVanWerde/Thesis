\chapter{The Behaviour of $\A_X^R$-Modules}
\todo[inline]{Mention BVWZ}
The classical approximation of the roots of the $b$-polynomial due to \cite{kashiwara1976b} relies on a quotient module $\int \M / \D_X u$ being holonomic.
This is no longer true in the multivariate case but a refined assumption, called relative holonomicity, due to \cite{maisonobe2016filtration} still holds.
This refinement works with $\D_X\times\C[s]$-modules whence one gets characteristic varieties inside $T^*X \times \C^p$\todo{p?}.

\todo{Maybe also mention the example Robin put on the whiteboard? Possibly in the main body? }
\section{Modules over $\A_X^R$}
Let $X$ be a smooth complex irreducible algebraic variety of dimension $n$ and denote $\D_X$ for it's sheaf of rings of algebraic differential operators.
For a regular commutative $\C$-algebra integral domain $R$ we define a sheaf of rings on $X\times \Spec R$ by
$$\A_{X}^R = \D_X \otimes_\C \O_{R}; \qquad \A_X = \A_{X}^{\C[s]}$$
where we abbreviated $\O_R = \O_{\Spec R}$.
The order filtration $F_p\D_X$ extends to a filtration $F_p\A^R_X = F_p\D_X \otimes_\C \O_R$ on $\A^R_X$ which is called the relative filtration.

The proof of the following results proceeds precisely like the case of $\D_X$-modules which may be found in \cite[Chapter 2]{hotta2007d}.
\begin{proposition}
    A quasi-coherent $\A_X^R$-module $\M$ is coherent if and only if it admits a filtration such that $\grrel \M$ is coherent over $\grrel \A_X^R$.
\end{proposition}
\begin{proposition}
    Let $\M$ be a coherent $\A_X^R$-module, then the support of $\grrel \M$ in $T^*X \times \Spec R$ is independent of the chosen filtration. It is called the characteristic variety of $\M$ and denoted $\Chrel \M$.
\end{proposition}

A coherent $\A_X^R$-module $\M$ is said to be relative holonomic over $R$ if $\Chrel \M = \cup_w \Lambda_w \times S_w$
for irreducible conic Lagrangian subvarieties $\Lambda_w\subseteq T^*X$ and irreducible closed subvarieties $S_w\subseteq \Spec R$.
\subsection{Direct Image Functor for $\A_X^R$-modules}
    In this section we state the natural generalisation of the direct image functor for $\D_X$-modules to the relative case of $\A_X^R$-modules. As with $\D$-modules this is the most natural for right-modules.  \todo{This is all general knowledge, should anything be cited? }

    Let $\mu:Y\to X$ be some morphism of smooth algebraic varieties.  A-priori it is not even clear what $\A_X^R$-module should correspond to $\A_Y^R$ since there is no natural push forward of vector fields. This issue may be resolved by use of the transfer $(\A_Y^R,\mu^{-1}\A_X^R)$-bimodule $\A_{Y\to X}^R:= \O_Y \otimes_{\mu^{-1}\O_X}\mu^{-1}\A_X^R$.

    \begin{definition}
      The direct image functor $\int_\mu$ from $\bD^{b,r}(\A_Y^R)$ to $\bD^{b,r}(\A_X^R)$ is defined to be $\bR\mu_* (\M \otimes_{\D_Y}^L \blank)$. In particular, for any $\A_Y^R$ module $\M$ one has $\A_X^R$-modules $\int_\mu^j \M = \H^j \int_\mu \M$.
    \end{definition}

    To compute $\int_\mu^j \M$ a resolution for $\A_{Y\to X}$ is required.
    \begin{definition}
        Let $\M$ be a right $\A_Y^R$-module, the relative Spencer complex $\Sp_Y^\bullet(\M)$ is a complex of right $\A_Y^R$-modules, concentrated in negative degrees, with $\Sp_Y^{-k}(\M) = \M \otimes_{\O_Y} \wedge^{k}\Theta_Y$ and as differential the right-$\A_Y^R$-linear map $\delta$ given by
        \begin{align*}
            m\otimes \xi_1 \wedge \cdots \wedge \xi_k &\mapsto \sum_{i<j}(-1)^{i+j} m \otimes [\xi_i,\xi_j]\wedge \xi_1 \wedge \cdots \wedge \widehat{\xi}_i \wedge\cdots \widehat{\xi}_j \wedge \cdots \wedge \xi_k\\
            &- \sum_{i=1}^k (-1)^{i} m\xi_i \otimes \xi_1 \wedge \cdots \wedge \widehat{\xi}_i\wedge \cdots \wedge \xi_k
        \end{align*}
    \end{definition}
        \begin{lemma}
            The complex of $(\A_X,f^{-1}\A_Y)$-bimodules $\Sp^\bullet_{Y\to X}(\A_Y^R) := \Sp^\bullet_Y(\A_Y^R) \otimes_{\O_Y}\A_{Y \to X}^R$ is a resolution of $\A_{Y\to X}^R$ as a bimodule by locally free left $\A_Y^R$-modules.
        \end{lemma}
        \begin{proof}
            This is analogous to the case of $\D_Y$-modules in \cite[p33]{sabbah2011introduction}.\todo{Should work out the appropriate exercises in the reference sometime.}
        \end{proof}
        Since tensoring with locally free modules yields a exact functor it follows that $\int_\mu\M = \bR\mu_* (\M \otimes_{\A_Y^R} \Sp_{Y\to X}^\bullet(\A_Y^R))$. This means that $\int_\mu^j \M$ is the sheaf of right $\A_X^R$-modules associated to the presheaf $V \mapsto H^j(\mu^{-1}(V), \M \otimes_{\A_Y} \Sp_{Y\to X}^\bullet(\A_Y^R))$.\todo{should now be possible to describe a edge map}
    %Denote by $\bD^{b,r}_{qc}(\A_Y^{R})$ the full subcategory of $\bD^{b,r}(\A_Y^R)$ consisting of those complexes of right $\A_Y^R$-modules whose cohomology sheaves are quasi-coherent over $\O_Y\times \O_{\Spec R}$. Similarly for $\bD^{b,r}_{coh}(\A_Y^R)$ with the cohomology being coherent $\A_Y^R$-modules.
    %\begin{theorem}
    %    Let $\mu:X\to Y$ be a morphism of nonsingular algebraic varieties. Then the direct image $\int$ takes $\bD^{b,r}_{qc}(\A_Y^{R})$ into $\bD^{b,r}_{qc}(\A_X^{R})$. Moreover, when $\mu$ is proper the direct image takes $\bD^{b,r}_{coh}(\A_Y^R)$ into $\bD^{b,r}_{coh}(\A_X^R)$.
    %\end{theorem}
    %\begin{proof}
    %\todo{See \url{http://www.math.stonybrook.edu/~cschnell/mat615/lectures/lecture18.pdf}}
    %\end{proof}
\subsection{Preservation of Relative Holonomicity}
\subsection{Kashiwara's Estimate for the Characteristic Variety}
Let $\mu:Y\to X$ be a proper morphism of COMPLEX MANIFOLDS\todo{This requires a different proof than the algebraic case, although the complex manifold can be adjusted to the varieties case but this needs $\mu$ to be proper to get coherence results and this intermediate step is not actually necessary.}. Given a coherent $\A_X^R$-module $\M$ with relative characteristic variety $\Chrel \M$. We desire to estimate $\Chrel \int^j \M$ in terms of $\M$. Such a estimate in the non-relative case is known due to Kashiwara \cite{kashiwara1976b}.  We note that the assumption that $\mu$ is proper can be relaxed but this version will suffice for our purposes.

The original proof by Kashiwara \cite{kashiwara1976b} uses the theory of microlocal differential operators. The proof we consider here is adapted from a proof by Malgrange \cite{malgrange1985images} and we follow the exposition by Sabbah \cite[p36]{sabbah2011introduction}.

Consider the following cotangent diagram
$$
\begin{tikzcd}
    & \mu^* T^* X\times \Spec R \arrow[swap]{ld}{T^* \mu} \arrow{rd}{\widetilde{\mu}} & \\
    T^* Y\times \Spec R & & T^*X\times \Spec R
\end{tikzcd}
$$
where the maps $T^*\mu$ and $\widetilde{\mu}$ act on the first component.
\begin{theorem}
    Let $\M$ be a relative holonomic $\A_Y^R$-module. Then, for any $j\geq 0$, we have \todo{Check required assumptions, really we only need a good filtration but this is apparently nontrivial. }
    $$\Chrel\left(\int^j \M \right)\subseteq  \widetilde{\mu}\left((T^*\mu)^{-1}(\Chrel \M) \right).$$
\end{theorem}
The first step is to note that a similar inclusion is easy for the $\grrel \A_Y^R$-modules. For any $\grrel \A_Y^R$-module $\mathcal{M}$ define $\int^j \mathcal{M} :=  \H^j\left(\bR \mu_* (\bL(T^*\mu)^* \mathcal{M})\right).$ Note that $(T^*\mu)^*$ produces a sheaf on $\mu^* T^* X \times \Spec R$ by the tensor product  $\blank\otimes_{f^{-1}\O_X\times \O_{\Spec R}} \grrel \A_X^R$. Hence, looking at the supports, the following result is immediate.
\begin{lemma}
    For any $\grrel\A_Y^R$-module $\mathcal{M}$ it holds that
    $$\Supp \int^j \mathcal{M}\subseteq \widetilde{\mu}\left((T^* \mu)^{-1} \Supp \mathcal{M}\right).$$
\end{lemma}
Applying this to $\grrel \M$ it remains to understand the difference between $\grrel\int^j \M$ and $\int^j \grrel \M$. This may be done using relative Rees modules.
\begin{definition}
    Let $z$ be a new variable. The relative Rees sheaf of rings $\Rees\A_Y^R$ is defined as the subsheaf $\oplus_p F_p \A_Y^R z^p $ of $\A_Y^R \otimes_\C \C[z]$. Similarly, any filtered $\A_Y^R$-module $\M$ gives rise to a $\Rees\A_Y$-module $\Rrel\M := \oplus_p F_p \M z^p$.
\end{definition}
The following obvious isomorphisms of filtered modules allow us to view the relative Rees module as a way to interpolate between $\M$ and $\grrel\M$
$$\frac{\Rrel\M}{(z-1)\Rrel\M} \cong \M; \qquad \frac{\Rrel\M}{z\Rrel\M} = \grrel \M.$$
Conversely, the second formula may be used to produce a filtered $\A_Y^R$-module from any graded $\Rees\A_Y^R$-module without $\C[z]$-torsion.

One can define $\int^j \Rrel \M$ similarly to the $\D$-module direct image and these are coherent $\A_X^R$-modules by the following adaptation of \todo{theorem 3.4.1 in Sabbah}

\chapter{The Behaviour of $\A_X^R$-Modules}
\todo{Mention BVWZ}

The classical approximation of the roots of the $b$-polynomial due to \cite{kashiwara1976b} relies on a quotient module $\int \M / \D_X u$ being holonomic.
This is no longer true in the multivariate case but a refined assumption, called relative holonomicity, due to \cite{maisonobe2016filtration} still holds.
This refinement works with $\D_X\times\C[s]$-modules whence one gets characteristic varieties inside $T^*X \times \C^p$\todo{p?}.

\todo{Maybe also mention the example Robin put on the whiteboard? Possibly in the main body? }
\section{Modules over $\A_X^R$}
\subsection{Basic Definitions and Properties}
Let $X$ be a smooth complex irreducible algebraic variety of dimension $n$ and denote $\D_X$ for it's sheaf of rings of algebraic differential operators.
For a regular commutative $\C$-algebra integral domain $R$ we define a sheaf of rings on $X\times \Spec R$ by
$$\A_{X}^R = \D_X \otimes_{\underline{\C}} \O_{R}; \qquad \A_X = \A_{X}^{\C[s]}$$
where we abbreviated $\O_R = \O_{\Spec R}$. It will also be convenient to use the abbreviation $\O_{X}^R := \O_{X \times \Spec R}$.


The order filtration $F_p\D_X$ extends to a filtration $F_p\A^R_X = F_p\D_X \otimes_{\underline{\C}} \O_R$ on $\A^R_X$ which is called the relative filtration.
The associated graded objects are denoted by $\grrel$. Denote $\pi:T^*X\times \Spec R \to X\times \Spec R$ for the projection map.
As in the case of $\D_X$-modules in chapter 1 \todo{cite} one can view $\pi^{-1}(\grrel\A_X^R)$ as a subsheaf of $\O_{T^*X}^R$ and for any $\grrel\A_X^R$-module $\mathcal{M}$ there is a corresponding module on $T^*X\times \Spec R$ defined by $\O_{T^*X}^R\otimes_{\pi^{-1}\grrel\A_X^R}\pi^{-1}\mathcal{M}$.
By abuse of notation the corresponding module on $T^*X\times \Spec R$ is still denoted with $\mathcal{M}$ and we adopt the perspective that $\grrel\A_X^R$-modules always live on $T^*X\times \Spec R$ unless explicitly mentioned otherwise.


Similarly to the case of $\D_X$ in the first chapter that \todo{Cite when C1 is written} it holds that $\A_X^R$ is the sheaf of rings generated by $\O_X^R$ and $\Theta_X$ inside of $\mathcal{E}nd_{\underline{\C}}(\O_X^R)$. Giving a left $\A_X^R$-module is equivalent to giving a $\O_X^R$-module $\M$ with $\Theta_X$-action such that
$\xi\cdot (fm) = f (\xi \cdot m)  + \xi(f)\ m  $
for any sections $f$ of $\O_X^R$ and $\xi$ of $\Theta_X$. Similarly, giving a right $\A_X^R$-module is equivalent to giving a $\O_X$-module $\M$ with $\Theta_X$-action such that $(mf)\cdot\xi = (m\cdot\xi)f - m\ \xi(f) $ for any sections $f$ of $\O_X^R$ and $\xi$ of $\Theta_X$.

The proof of the following results proceeds precisely like the case of $\D_X$-modules which may be found in \cite[Chapter 2]{hotta2007d}. \todo{Probably cite C1 instead}
\begin{proposition}\label{prop: CoherentAndGoodFiltration}
    A quasi-coherent $\A_X^R$-module $\M$ is coherent if and only if it admits a filtration such that $\grrel \M$ is coherent over $\grrel \A_X^R$. Such a filtration is called a good filtration.
\end{proposition}
\begin{proposition}
    Let $\M$ be a coherent $\A_X^R$-module, then the support of $\grrel \M$ in $T^*X \times \Spec R$ is independent of the chosen filtration. It is called the characteristic variety of $\M$ and denoted $\Chrel \M$.
\end{proposition}

A coherent $\A_X^R$-module $\M$ is said to be relative holonomic over $R$ if $\Chrel \M = \cup_w \Lambda_w \times S_w$
for irreducible conic Lagrangian subvarieties $\Lambda_w\subseteq T^*X$ and irreducible closed subvarieties $S_w\subseteq \Spec R$.
\subsection{Basic Operations}\label{sec: BasicOperations}
For any right $\A_{X}^R$-module $\M$ and left $\D_X$-module $\N$ the tensor product $\M \otimes_{\O_X} \N$ comes equipped with a right $\A_X^R$-module structure defined by
$$f\cdot (m\otimes n) = mf \otimes n; \qquad \xi \cdot (m\otimes n) = m\xi \otimes n - m\otimes \xi n $$
for any sections $f$ of $\O_X^R$ and $\xi$ in $\Theta_X$. The same definition applies for a $\A_X^R$-module structure on $\M\otimes_{\O_X^R} \N$ whenever $\N$ is a left $\A_X^R$-module.

Similarly, given a left $\D_X$-module $\mathscr{L}$ and a left $\A_X^R$-module $\N$ a left $\A_X^R$-module structure on $\mathscr{L} \otimes_{\O_X} \mathscr{L}$ is defined by
$$f \cdot (\ell\otimes n) =\ell \otimes fn; \qquad \xi \cdot (\ell\otimes n ) = \xi \ell \otimes n + \ell \otimes \xi n$$
for any sections $f$ of $\O_X^R$ and $\xi$ in $\Theta_X$.

\begin{lemma}\label{lem: IsomorphismTensors}
  Let $\mathscr{M}, \N$ be right and left $\A_X^R$-modules respectively and let $\mathscr{L}$ be a left $\D_X$-module. Then there is a isomorphism of left $\A_X^R$-modules
  $$(\M \otimes_{\O_X} \mathscr{L})\otimes_{\O_X^R} \N \cong \M \otimes_{\O_X^R} (\mathscr{L}\otimes_{\O_X} \N).   $$
\end{lemma}
\begin{proof}
  This is immediate by checking that the obvious bijection conserves the $\A_X^R$-module structure. Note that the only nontrivial check is the action of a section $\xi$ from $\Theta_X$.
\end{proof}
\begin{lemma}\label{lem: FreeLeftAModuleTensor}
  Let $\N$ be a left $\A_X^R$-module which is locally free as a $\O_X^R$-module. Consider $\A_X^R$ as a right $\A_X^R$-module, then $\A_X^R \otimes_{\O_X^R} \N$ is locally free as a right $\A_X^R$-module.
\end{lemma}
\begin{proof}
  Consider local coordinates $x_1,\ldots, x_n$ on $X$ and a local $\O_X^R$-basis $\{n_\beta\}_\beta$ for $\N$. Then $\{1\otimes n_\beta\}_{\beta}$ will be a local $\A_X^R$-basis for $\A_X^R \otimes_{\O_X^R} \N$.

  To see that this generates the $\A_X^R$-module note that $\{\xi^\alpha \otimes n_\beta\}_{\alpha,\beta}$
  is a $\O_X^R$-basis set when $\alpha$ runs over all multi-indices in $\Z_{\geq 0}^n$.
  These sections can be recovered using the $\A_X^R$-action on the proposed generating set by induction on $\abs{\alpha}$.
  Indeed, $\xi^\alpha \cdot (1 \otimes n_\beta)$ equals $\xi^\alpha \otimes n_\beta$ up to a element in the $\O_X^R$-span of $\{\xi^\gamma \otimes n_\beta\}_{\abs{\gamma}<\abs{\alpha}}$.

  For the freedom, suppose there is a local $\A_X^R$-relation $\sum_\beta P_\beta \cdot 1\otimes n_\beta = 0$ with some $P_\beta$ nonzero. This is of the form $\sum_{\alpha, \beta} f_{\alpha,\beta} \xi^\alpha \cdot 1\otimes n_\beta = 0$ with the $f_{\alpha,\beta}$ sections of $\O_X^R$ not all equal to zero.
  Pick some multi-index $\mu\in \Z_{\geq 0}^n$ and of maximal degree such that $f_{\mu,\beta}$ is non-zero for some $\beta$.
  Then, rewriting $\sum_{\alpha, \beta} f_\alpha \xi^\alpha \cdot 1\otimes n_\beta = 0$ in terms of the $\O_X^R$-basis $\{\xi^\alpha \otimes n_\beta\}_{\alpha,\beta}$ one finds a non-zero coeffiencient at $\xi^\eta \otimes n_\beta$ for some $\beta$ which is a contradiction.
\end{proof}
\section{Direct Image Functor for $\A_X^R$-modules}
    In this section we state the natural generalisation of the direct image functor for $\D_X$-modules to the relative case of $\A_X^R$-modules. As with $\D$-modules this is the most natural for right-modules.\todo{more introduction}

    \subsection{Transfer Modules and $\A_Y^R$-module Direct Image}
    Let $\mu:Y\to X$ be some morphism of smooth algebraic varieties, by abuse of notation we will also denote $\mu$ for the induced map from $Y\times \Spec R$ to $X\times \Spec R$.

    A-priori it is not even clear what $\A_X^R$-module should correspond to $\A_Y^R$ since there is no natural push forward of vector fields.
    This issue may be resolved by use of the transfer $(\A_Y^R,\mu^{-1}\A_X^R)$-bimodule $\A_{Y\to X}^R:= \O_Y^R \otimes_{\mu^{-1}\O_X^R}\mu^{-1}\A_X^R$.
    Here, the right $\mu^{-1}\A_X^R$-module structure is just the action on the second component and definitions like \cref{sec: BasicOperations} are used to define the left $\A_Y^R$-module structure. To be precise
    $$f\cdot (g\otimes \mu^{-1}h_X) = fg \otimes \mu^{-1}h_X; \qquad \xi\cdot (g\otimes\mu^{-1}h_X) = \xi g \otimes \mu^{-1}h_X + g \otimes T\mu(\xi)\mu^{-1}h_X $$
    for any sections $f$ of $\O_Y^R$ and $\xi$ of $\Theta_Y$. Here $T\mu(\xi)$ is a local section of $\O_Y\otimes_{\mu^{-1}\O_X} \mu^{-1}\Theta_X$.
    \begin{definition}
      The direct image functor $\int_\mu$ from $\bD^{b,r}(\A_Y^R)$ to $\bD^{b,r}(\A_X^R)$ is defined to be $\bR\mu_* (\blank\otimes_{\A_Y^R}^L \A_{Y\to X}^R)$.
      For any $\A_Y^R$ module $\M$ the $j$-th direct image is the $\A_X^R$-modules $\int_\mu^j \M = \H^j \int_\mu \M$.
      The subscript $\mu$ will be surpressed whenever there is no ambiguity.
    \end{definition}

    To compute the direct image $\int^j \M$ a resolution for the transfer bimodule $\A_{Y\to X}$ is required.
    \begin{definition}
        Let $\M$ be a right $\A_Y^R$-module, the relative Spencer complex $\Sp_Y^\bullet(\M)$ is a complex of right $\A_Y^R$-modules, concentrated in negative degrees, with $\Sp_Y^{-k}(\M) = \M \otimes_{\O_Y} \wedge^{k}\Theta_Y$ and as differential the right-$\A_Y^R$-linear map $\delta$ given by
        \begin{align*}
            m\otimes \xi_1 \wedge \cdots \wedge \xi_k &\mapsto \sum_{i<j}(-1)^{i+j} m \otimes [\xi_i,\xi_j]\wedge \xi_1 \wedge \cdots \wedge \widehat{\xi}_i \wedge\cdots \widehat{\xi}_j \wedge \cdots \wedge \xi_k\\
            &- \sum_{i=1}^k (-1)^{i} m\xi_i \otimes \xi_1 \wedge \cdots \wedge \widehat{\xi}_i\wedge \cdots \wedge \xi_k
        \end{align*}
    \end{definition}
    The following lemma and it's proof are a generalisation of exercise 1.20 in \cite{sabbah2011introduction} to the relative case.
    \begin{lemma}\label{lem: RelativeSpencerResolvesOXR}
      The relative Spencer complex $\Sp_Y^\bullet(\A_Y^R)$ is a locally free resolution of $\O_X^R$ as left $\A_X^R$-module.
    \end{lemma}
    \begin{proof}
      Define a filtration on $\Sp_Y^\bullet(\A_Y^R)$ by the complexes $F_k\Sp_Y^\bullet(\A_Y^R)$ which have term $F_{k-\ell}\A_Y^R\otimes_{\O_Y}\wedge^\ell \Theta_Y$ in spot $\ell$.
      This filtration induces the complexes $\gr_k^{rel} \Sp_X^\bullet(\A_Y^R)$ with term  $\gr_{k-\ell}^{rel}\A_Y^R\otimes_{\O_Y}\wedge^\ell \Theta_Y$ in spot $\ell$.

      In local coordinates $x_1,\ldots, x_n$ one finds that $\grrel\Sp_Y^\bullet := \oplus_k \grrel_k \Sp_Y^\bullet(\A_Y^R)$ is the Koszul complex of $\O_Y^R[\xi_1,\ldots,\xi_n] = \grrel \A_Y^R$ with respect to  $\xi_1,\ldots, \xi_n$.\todo{Should I explain what a Koszul complex is?}
      Since $\xi_1,\ldots,\xi_n$ form a regular sequence a standard result on Koszul complexes\todo{Give reference to some book} yields that $\grrel\Sp_Y^\bullet(\A_Y^R)$ is a locally free resolution of $\O_Y^R$ as $\grrel \A_Y^R$-module.

      On the other hand, it is immediate that $F_0 \Sp^\bullet(\A_Y^R) = \gr_0^{rel}\Sp^\bullet(\A_Y^R)$ is  $\O_Y^R$ viewed as a complex. Hence, there is no contribution to $\gr^{rel}\Sp_Y^\bullet(\A_Y^R)$ from the terms of $k>0$.
      That is to say that $\gr_k^{rel}\Sp_Y^\bullet(\A_Y^R)$ is quasi-isomorphic to the zero complex for $k>0$.
      Hence, $F_0\Sp_Y^\bullet(\A_Y^R)\hookrightarrow \Sp_Y^\bullet(\A_Y^R)$ is a quasi-isomorphism by the exactness of the direct limit.
      \todo{Would be nice to give a reference, proof may be found on stackexchange}
      It follows that  $\Sp_Y^\bullet(\A_Y^R)$ is a resolution of $\O_X^R$.
      That the terms of $\Sp_Y^\bullet(\A_Y^R)$ are locally free follows from \cref{lem: FreeLeftAModuleTensor} after some minor adjustments in the statement and proof.
    \end{proof}

    Define the transfer Spencer complex as the complex of  $(\A_Y^R,f^{-1}\A_X)$-bimodules given by $\Sp^\bullet_{Y\to X}(\A_Y^R) := \Sp^\bullet_Y(\A_Y^R) \otimes_{\O_Y^R}\A_{Y \to X}^R$.
    The following lemma and it's proof are direct generalisation of exercise 3.4 in \cite{sabbah2011introduction} to the relative case.
    \begin{lemma}\label{lem: SpencerResolutionTransferModule}
      The transfer Spencer complex $\Sp^\bullet_{Y\to X}(\A_Y^R)$ is a resolution of $\A_{Y\to X}^R$ as a bimodule by locally free left $\A_Y^R$-modules.
    \end{lemma}
    \begin{proof}
       To see that the terms of the complex are locally free recall from \cref{lem: IsomorphismTensors} the following isomorphisms of left $\A_Y^R$-modules
        \begin{align*}
           (\A_Y^R \otimes_{\O_Y} \wedge^\ell\Theta_Y )\otimes_{\O_Y^R}\A_{Y\to X} &
           \cong \A_Y^R \otimes_{\O_Y^R}(  \wedge^\ell\Theta_Y \otimes_{\O_Y}\A_{Y\to X}).
        \end{align*}
        \todo{May be possible to remove this step from the proof and removing need for minor adjustment of previous proof. }
      Note that $\A_{Y\to X}^R$ is a locally free $\O_Y^R$-module since it is the pullback of a locally free module on $X\times \Spec R$.
      Combined with the fact that $\wedge^\ell \Theta$ is a locally free $\O_Y$-module this yields that $ \wedge^\ell\Theta_Y \otimes_{\O_Y}\A_{Y\to X}$ is a locally free $\O_Y^R$-module.
      Hence \cref{lem: IsomorphismTensors} is applicable and yields that the terms of the transfer Spencer complex are locally free $\A_Y^R$-modules.

      That the transfer Spencer complex is a resolution of $\A_{Y\to X}^R$ follows from \cref{lem: RelativeSpencerResolvesOXR} by using that $\A_{Y\to X}^R$ is a locally free and hence flat over $\O_Y^R$.
    \end{proof}


    Since tensoring with locally free modules yields a exact functor this simplifies the computation of the direct image as follows.
    \begin{corollary}
        It holds that $\int = \bR\mu_* (\blank\otimes_{\A_Y^R} \Sp_{Y\to X}^\bullet(\A_Y^R))$.
    \end{corollary}
    A strategy one can employ in proving theorems on some space $X$ is by first solving them on a nicer space $Y$ equipped with a map $Y\to X$. This can then be related to the problem on $X$ by use of the direct image. For this purpose it is useful that any global section of $\mathcal{M}$ induces a global section of the direct image. This is usually done in the language of left modules but for us it is more natural to work with right $\A_Y^R$-modules.
    \begin{lemma}
        Let $\M$ be a right $\A_Y^R$-module. Then any global section $m\in\Gamma(Y,\M)$ induces a global section of $\int^0\M)$.
    \end{lemma}
    \begin{proof}
      By the Leray spectral sequence there is a functorial isomorphism
      $$\mathbb{H}^\bullet(Y,\M\otimes_{\A_Y^R} \Sp_{Y\to X}^\bullet(\A_Y^R)) \cong \mathbb{H}^\bullet(X,\bR\mu_*(\M\otimes_{\A_Y^R} \Sp_{Y\to X}^\bullet(\A_Y^R))).$$
      In particular it follows that $\mathbb{H}^0(Y,\M \otimes_{\A_Y^R} \Sp_{Y\to X}^\bullet(\A_Y^R)) \cong \Gamma(X,\int^0\M)$. The \v Cech spectral sequence now induces the desired global section in the direct image based on the section $m\otimes 1$ of $\M \otimes_{\A_Y^R}\Sp_{Y\to X}^0(\A_Y^R)$.
    \end{proof}
    \begin{theorem}
      Long exact sequence
    \end{theorem}
    \subsection{Functorial Properties of the Direct Image}
    \begin{theorem}
       Let $\mu:Z\to Y$ and $\nu:Y\to X$ be morphisms of smooth algebraic varieties. If $\mu$ is proper then $\int_{\nu\circ \mu} = \int_\nu \int_\mu$.
    \end{theorem}
    \begin{proof}
      See \url{http://www.math.stonybrook.edu/~cschnell/mat615/lectures/lecture17.pdf}
    \end{proof}
    This theorem reduces the computation of direct images to closed embeddings and projections by writing $\mu = \pi \circ \iota$ for $\iota:Y\to Y\times X$ and $\pi:Y\times X\to X$.
        %These cases are handled by the following theorem.
        %\begin{theorem}
        %   If $\iota: Y\to X$ is a closed embedding then $\int_\iota = \iota_*(\blank \otimes_{\A_{Y}} \A_{Y\to X})$.
        %   If $\pi:Y\times X \to X$ is the projection then $\int_\pi = \bR \pi_*(\blank \otimes_{\O_{Y\times X}} \wedge^{-\bullet}\Theta_{Y\times X/X}) $.\todo{Still need to adjust $\pi$ formula for relativity}
        %\end{theorem}



    Denote by $\bD^{b,r}_{qc}(\A_Y^{R})$ the full subcategory of $\bD^{b,r}(\A_Y^R)$ consisting of those complexes of right $\A_Y^R$-modules whose cohomology sheaves are quasi-coherent over $\O_Y\times \O_{\Spec R}$. Similarly for $\bD^{b,r}_{coh}(\A_Y^R)$ with the cohomology being coherent $\A_Y^R$-modules.
    \begin{theorem}\label{thm: ConservationQuasiCoherentAndCoherentIfProper}
        Let $\mu:X\to Y$ be a morphism of nonsingular algebraic varieties. Then the direct image $\int$ takes $\bD^{b,r}_{qc}(\A_Y^{R})$ into $\bD^{b,r}_{qc}(\A_X^{R})$. Moreover, when $\mu$ is proper the direct image takes $\bD^{b,r}_{coh}(\A_Y^R)$ into $\bD^{b,r}_{coh}(\A_X^R)$.
    \end{theorem}
    \begin{proof}
      See \url{http://www.math.stonybrook.edu/~cschnell/mat615/lectures/lecture18.pdf}
    \end{proof}
\subsection{Kashiwara's Estimate for the Characteristic Variety}
Let $\mu:Y\to X$ be a proper morphism of smooth algebraic varieties. Given a coherent $\A_X^R$-module $\M$ with relative characteristic variety $\Chrel \M$. We desire to estimate $\Chrel \int^j \M$ in terms of $\Chrel\M$. Such a estimate in the non-relative case is known due to Kashiwara. %

The original proof by \cite{kashiwara1976b} uses the theory of microlocal differential operators. The idea of the following proof is due to \cite{malgrange1985images} in a $K$-theoretic context. We follow the exposition of \cite{sabbah2011introduction} and replace it with the corresponding relative notions. %We note that the assumption that $\mu$ is proper can be relaxed but this version will suffice for our purposes.
\\

\noindent
Consider the following cotangent diagram
$$
\begin{tikzcd}
    & \mu^* T^* X\times \Spec R \arrow[swap]{ld}{T^* \mu} \arrow{rd}{\widetilde{\mu}} & \\
    T^* Y\times \Spec R & & T^*X\times \Spec R
\end{tikzcd}
$$
where the maps $T^*\mu$ and $\widetilde{\mu}$ act on the first component.
\begin{theorem}\label{thm: KashiwaraEstimate}
    Let $\M$ be a coherent $\A_Y^R$-module. Then, for any $j\geq 0$, we have
    $$\Chrel\left(\int^j \M \right)\subseteq  \widetilde{\mu}\left((T^*\mu)^{-1}(\Chrel \M) \right).$$
\end{theorem}
Note that the statement is local so, after replacing $X$ by some affine open, it may be assumed that $X\times \Spec R$ and $Y\times \Spec R$ are compact.
The first step is to note that a similar inclusion is easy for the $\grrel \A_Y^R$-modules.
The direct image functor on $\grrel \A_Y^R$-modules $\mathcal{M}$ is defined by $\int^j \mathcal{M} :=  \bR^j \widetilde{\mu}_* ( \bL(T^*\mu)^*\mathcal{M}).$
Here, $(T^*\mu)^*(\blank)$ produces a sheaf on $\mu^*T^*X\times \Spec R$ by $ \blank\otimes_{\mu^{-1}\O_X^R} \grrel \A_X^R$.
Looking at the supports the following result is immediate.
\begin{lemma}
    For any $\grrel\A_Y^R$-module $\mathcal{M}$ it holds that
    $$\supp \int^j \mathcal{M}\subseteq \widetilde{\mu}\left((T^* \mu)^{-1} \supp \mathcal{M}\right).$$
\end{lemma}
Applying this lemma to $\grrel\M$ it remains to show that $\supp\grrel\int^j\M\subseteq \supp\int^j \grrel\M$. This is proved in \cref{prop: SuppGrrelIntInclusion}. The main technical ingredient in the proof is the Rees modules associated to a filtered $\A_Y^R$-module $\M$.
\begin{definition}
    Let $z$ be a new variable. The Rees sheaf of rings $\Rees\A_Y^R$ is defined as the subsheaf $\oplus_p F_p \A_Y^R z^p $ of $\A_Y^R \otimes_\C \C[z]$. Similarly, any filtered $\A_Y^R$-module $\M$ gives rise to a $\Rees\A_Y$-module $\Rrel\M := \oplus_p F_p \M z^p$.
\end{definition}
Given a $\A_Y^R$-module $\M$ with a good filtration it follows that $\Rrel\M$ is a coherent $\Rees\A_Y^R$-module similarly to \cref{prop: CoherentAndGoodFiltration}.
The following isomorphisms of filtered modules on $Y\times \Spec R$ are essential.
They mean that the Rees module can be viewed as a parametrisation of various relevant modules.
$$\frac{\Rrel\M}{(z-1)\Rrel\M} \cong \M; \qquad \frac{\Rrel\M}{z\Rrel\M} \cong \grrel \M;\qquad \frac{\Rrel\M}{z^\ell\Rrel\M} \cong  \grl\M.$$
Here $\grl$ takes a filtered object and returns $\oplus_k F_{k}/F_{k-\ell}$.
The first formula may be be used to find a corresponding filtered $\A_Y^R$-module for any graded $\Rees\A_Y^R$-module without $\C[z]$-torsion.

The $j$th direct image of a $\Rees\A_Y^R$-module $\mathcal{M}$ is the sheaf of $\Rees\A_X^R$-modules on $X\times\Spec R$ defined by $\int^j \mathcal{M} = \bR^j\mu_*(\mathcal{M}\otimes^L_{\Rees \A_Y^R} \Rrel \A_{Y\to X}^R)$.
Here the filtration on $\A_{Y\to X}^R$ is defined by $F_i\A_{Y\to X}^R =\O_{Y}^R \otimes_{\mu^{-1}\O_X^R}\mu^{-1}F_i\A_X^R $.
The direct image may be restricted to the category of graded Rees modules in which case it returns a graded Rees module. Coherence is preserved similarly to \cref{thm: ConservationQuasiCoherentAndCoherentIfProper}.

Recall that a $\grrel\A_Y^R$-modules on $Y\times \Spec R$ could be be viewed as a sheaf on $T^*Y\times \Spec R$ and is already equipped with a direct image.
The Rees module viewpoint agrees with the earlier definition by the following lemma.

\begin{lemma}\label{lem: ReesAndOtherDirectImagesAgree}
  Consider a filterd $\A_Y^R$-module $\M$. Then viewing $\int^j \Rrel\M / z\Rrel\M$ with it's $\grrel\A_X^R$-module structure as a sheaf on $T^*X\times \Spec R$ recovers the $\grrel\A_Y^R$-module direct image $\int^j \grrel\M$. Viewing  $\int^j \Rrel\M / (z-1)\M$ as a $\A_X^R$-module recovers $\int^j \M$.
\end{lemma}
\begin{proof}
  We give the proof for $\int^j \grrel \M$, the proof for $\int^j \M$ is similar but easier.


  Consider the following Cartesian square
  $$
      \begin{tikzcd}
        \mu^*T^* X \times \Spec R \arrow{r}{T^*\mu} \arrow{d}{{\widetilde{\mu}}} &T^*Y\times \Spec R \arrow{r}{\pi_Y} & Y\times \Spec R\arrow{d}{\mu} \\
        T^*X\arrow{rr}{\pi_X}  \times \Spec R && X\times \Spec R.
      \end{tikzcd}
  $$
  Since $\pi_X$ is flat the derived version of the flat base change theorem yields that \todo{Check in detail that the theorem is applicable and has this conclusion due to flatness}
  $$\bL\pi_X^*\bR\mu_*(\frac{\Rrel\M}{z\Rrel \M}\otimes^L_{\A_Y^R}\Rrel \A_{Y\to X}^R) = \bR\widetilde{\mu}_*\bL(T^*\mu\circ\pi_Y)^*(\frac{\Rrel\M}{z\Rrel \M}\otimes^L_{\A_Y^R}\Rrel \A_{Y\to X}^R).$$
  Since $\pi_X$ is flat it follows that $\H^j \bL\pi_X^*(\blank) = \pi_X^*\H^j(\blank)$\todo{$\H^j \bL\pi_X^*(\blank) = \pi_X^*\H^j(\blank)$?}. It now suffices to show that the right hand side is $\int \grrel\M$.

  Since $\pi_Y$ is flat it holds that $\bL(T^*\mu \circ \pi_Y)^* = \bL (T^*\mu)^* \circ \bL \pi_Y^*$\todo{$\bL(T^*\mu \circ \pi_Y)^* = \bL (T^*\mu)^* \circ \bL \pi_Y^*$?}.
  We show that $\bL\pi_Y^*(\frac{\Rrel\M}{z\Rrel \M}\otimes^L_{\A_Y^R}\Rrel \A_{Y\to X}^R)\cong \grrel\M \otimes^L_{\mu^{-1}\O_X^R}\widetilde{\mu}^*\grrel\A_{X}^R$ from which the result follows immediately.

  Let $\mathcal{F}^\bullet$ denote a bimodule resolution for $\Rrel \A_{Y\to X}^R$ by locally free left $\Rees\A_Y^R$-modules.
  Then $(\Rees \A_Y^R / z\Rees \A_Y^R)\otimes_{\Rees \A_Y^R}\mathcal{F}^\bullet$ is a bimodule resolution for $\grrel \A_{Y\to X}^R$ by locally free left $\grrel\A_Y^R$-modules.
  Now $\bL\pi_Y^*$ just means applying $\pi^{-1}(\blank)\otimes \O_{T^*Y}$ to the terms of this free resolution.
  Due to flatness this yields a free resolution in $\pi^{*}\grrel\A_Y^R$-modules of $\pi^* \grrel\A_{Y\to X}^R$.
  Since $\grrel \A_{Y\to X}^R = \O_Y^R \otimes_{\mu^{-1}\O_X^R} \mu^{-1}\grrel\A_X^R$ and $\pi^*\mu^* = \widetilde{\mu}^*\pi^*$ the desired equality follows. \todo{Write out more}
\end{proof}
It turns out that one can directly compare $\grl\int^j\M$ and $\int^j \grl\M$ when $\ell$ is large. Some care is required since since $\int^j \Rrel \M$ may have $\C[z]$-torsion.
\begin{lemma}\label{lem: KernelZellStabilises}
  Consider a $\A_Y^R$-module $\M$ with a good filtration. Then, for sufficiently large $\ell$, the kernel of $z^\ell$ in $\int^j \Rrel \M$ stabilises. For such $\ell$ the quotient $\int^j \Rrel \M/ \ker z^\ell$ is the $\Rees \A_X^R$-coherent module associated to a good filtration on $\int^j \M$.
\end{lemma}
\begin{proof}
  By $\int \Rrel \M$ being coherent over the sheaf of Noetherian rings $\Rees\A_X^R$ it follows that $\ker z^\ell$ locally stabilises. This is sufficient since $X\times \Spec R$ is assumed to be compact.

    Now consider the short exact sequence $0\to \Rrel \M \xrightarrow{z-1} \Rrel \M \to \M \to 0$. This induces a long exact sequence
    $$\cdots \to \int^j \Rrel \M \xrightarrow{z-1} \int^j \Rrel \M \to \int^j \M \to \int^{j+1} \Rrel \M \xrightarrow{z-1}\cdots. $$
    Since $\int^{j+1} \Rrel \M$ is a graded $\Rees\A_X^R$-module it follows that $z-1$ is injective whence $\int^j \Rrel \M / (z-1)\int^j \Rrel \M \cong \int^j \M$. This yields the desired result using that $\int^j \Rrel \M / \ker z^\ell$ is $\C[z]$-torsion free and the isomorphism
    $$ \frac{\int^j \Rrel \M }{(z-1)\int^j \Rrel \M } \cong \frac{\int^j \Rrel \M /\ker z^\ell }{(z-1)(\int^j \Rrel \M/\ker z^\ell) }.$$
\end{proof}
From now on we equip $\int^j \M$ with the good filtation inherited from the Rees module's direct image.
\begin{lemma}\label{lem: EllLargeSubquotent}
    Consider a $\A_Y^R$-module $\M$ with a good filtration. Then, if $\ell$ is sufficiently large, $\grl \int^j\M$ is a subquotient of $\int^j\grl\M$.
\end{lemma}
\begin{proof}
  The short exact sequence $0\to \Rrel\M \xrightarrow{z^\ell}\Rrel \M \to \Rrel\M / z^\ell \Rrel\M \to 0$ induces a long exact sequence
  $$\cdots \to \int^j \Rrel \M \xrightarrow{z^\ell} \int^j \Rrel \M \to \int^j \Rrel\M/z^\ell \Rrel\M \to \int^{j+1} \Rrel \M \xrightarrow{z^\ell}\cdots. $$
  Hence, $\int^j \Rrel \M / z^\ell \int^j \Rrel \M$ is a submodule of $\int^j (\Rrel\M/z^\ell \Rrel\M)$ and it remains to show that $\Rrel \int^j \M/ z^\ell \Rrel \int^j \M$ is a quotient of $\int^j \Rrel \M / z^\ell \int^j \Rrel \M$.

  Let $\ell$ be sufficiently large so that \cref{lem: KernelZellStabilises} yields a isomorphism $\int^j \Rrel \M / \ker z^\ell \cong \Rrel\int^j \M$. The map $z^\ell$ induces a isomorphism $\int^j \Rrel \M / \ker z^\ell \cong z^\ell \int^j \Rrel \M$. Therefore $z^\ell \int^j \Rrel \M / z^{2\ell}\int^j \Rrel\M \cong \Rrel \int^j \M / z^\ell \Rrel\int^j \M $.
  The desired quotient follows by applying the map $m\mapsto z^\ell m$ on $\int^j \Rrel \M / z^\ell \int^j \Rrel \M$.
\end{proof}
The main remaining task is to relate these results to the desired case of $\ell = 1$.
\begin{definition}
  For any $\ell \geq 1$ the $G$-filtration on a $\Rees\A_Y^R$-module $\mathcal{M}$ is defined by the decreasing sequence of $\grl\A_Y^R$-submodules $G_j \mathcal{M} := z^{j}\mathcal{M}$.
\end{definition}
\begin{lemma}\label{lem: GradedGGradedLYieldsGraded}
  For any filtered $\A_Y^R$-module $\M$ and $\ell \geq 1$ there is the a isomorphism of $\gr \A_Y^R$-modules
  $$\gr^G \grl \M \cong (\grrel\M)^\ell.$$
\end{lemma}
\begin{proof}
  This follows from directly from the fact that $G_j\grl\M = \oplus_k F_{k-j}\M /F_{k-\ell}\M$.
\end{proof}
\begin{lemma}\label{lem: grGCommutes}
  Consider a $\Rees\A_Y^R$-module $\mathcal{M}$. Then one has a isomorphism $\gr^G\int\mathcal{M} \cong \int\gr^G\mathcal{M}$ in $\bD^{b,r}(\grrel\A_X^R)$.
\end{lemma}
\begin{proof}
  Writing out the direct image functors the desired result is a isomorphism $$\gr^G\bR\mu_*(\mathcal{M}\otimes^L_{\Rees\A_Y^R} \Rees\A_{Y\to X}^R)  \cong \bR\mu_*(\gr^G\mathcal{M}\otimes^L_{\mu^{-1}\O_X^R}\grrel\A_X^R).$$
  The proof of the commutation proceeds in two steps corresponding to the two derived functors.

  Let $\F^\bullet$ be a bimodule resolution for $\Rrel\A_{Y\to X}^R$ by locally free left $\Rees \A_Y^R$-modules.
  There is a $G$-filtration on this complex given by $z^j(\mathcal{M}\otimes_{\Rees\A_Y^R} \F^\bullet) = (z^j\mathcal{M})\otimes_{\Rees\A_Y^R} \F^\bullet$.
  By the flatness of locally free sheaves and the short exact sequence $0\to \oplus_j z^j \mathcal{M} \to \oplus_j z^{j-1}\mathcal{M} \to \gr^G \mathcal{M} \to 0$ it follows that $\gr^G(\mathcal{M}\otimes_{\Rees\A_Y^R} \F^\bullet) \cong (\gr^G\mathcal{M})\otimes_{\Rees\A_Y^R} \F^\bullet$.
  Further, by the argument in the proof of \cref{lem: ReesAndOtherDirectImagesAgree} the complex of $\gr^G\A_Y^R$-modules  $(\gr^G\mathcal{M})\otimes_{\Rees\A_Y^R} \F^\bullet$ can be viewed as a representative of $(\gr^G\mathcal{M})\otimes^L_{\mu^{-1}\O_X^R}\grrel\A_X^R$.\todo{Check after lemma is entirely proven}

  Denote $\mathcal{G}(\blank)$ for the functor which takes a sheaf complex and returns its Godement resolution.
  Flabby sheaves are acyclic for $\mu_*$ so the Godement resolution may be used to compute $\bR\mu_*$.
  Moreover, since the terms of a Godement resolution are essentially direct sums of formal products of stalks, it is immediate that $z^i \mathcal{G}(\mathcal{N}^\bullet) = \mathcal{G}(z^i\mathcal{N}^\bullet)$ and that $\gr^G\mathcal{G}(\mathcal{N}^\bullet) =\mathcal{G}(\gr^G\mathcal{N}^\bullet)$ for any complex of right $\mu^{-1}\Rees\A_X^R$-modules $\mathcal{N}^\bullet$.
  Applying $\mu_*$ to these equalities and setting $\mathcal{N}^\bullet = \mathcal{M}\otimes_{\Rees\A_Y^R} \F^\bullet$ yields the desired result.
\end{proof}
\begin{proposition}\label{prop: SuppGrrelIntInclusion}
  For a filtered $\A_Y^R$-module $\M$ with a good filtration it holds that  $$\supp \grrel\int^j\M \subseteq \supp \int^j \grrel\M.$$
\end{proposition}
\begin{proof}
  Let $\ell\geq 0$ be sufficiently large so that \cref{lem: EllLargeSubquotent} holds, that is to say that $\grl\int^j \M$ is a subquotient of $\int^j \grl \M$.
  By \cref{lem: GradedGGradedLYieldsGraded} it holds that $\gr^G\grl \int^j \M \cong (\grrel\int\M)^\ell$.
  Since $\grl \int^j \M$ is a subquotient of $\int \grl\M$ it remains to show that the support of $\gr^G \int^j \grl\M$ is a subset of the support of $\int^j \gr \M$.

  This can be established with the spectral sequence associated of the $G$-filtered complex $\int \grl \M$. Since the $G$-filtration is finite on $\grl\A_X^R$-modules the associated spectral sequence abbuts by general results\todo{Found spectral sequence result online, add good reference.}. To be precise the associated spectral sequence with terms
  $E^2_{pq} = \H^{p+q}\gr^G \int \grl \M$ abuts to $\gr^G\int \M$.
  By \cref{lem: grGCommutes} and \cref{lem: GradedGGradedLYieldsGraded} it holds that $E^2_{pq} \cong (\int^{p+q}\gr \M)^\ell$. \todo{Or $E^1$? Seems to depend on preference but should actually matter somewhat for the differentials.}
  It follows that $\supp\gr^G \int^j \grl\M$ is a subset of the support of $\int \gr \M$ which completes the proof.
\end{proof}

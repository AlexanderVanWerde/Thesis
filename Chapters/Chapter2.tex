\chapter{Relative Holonomic Modules}
\section{Introduction}\label{sec: IntoductionChapterRelative}
Fix a variety $X$ and a morphism $F:X\to \C^p: x \mapsto (f_1(x), \ldots, f_p(x))$. Denote $D$ for the divisor defined by $\prod f_i$ and let $\mu:Y\to X$ be a resolution of singularities for $(X,D)$.
This means that $\mu$ is a projective morphism which is a isomorphism over the complement of $D$ and such that $\mu^*D = \sum_{i=1}^r \operatorname{mult}_{E_i} a_i E_i$ is in normal crossings form.
Associated the behaviour of $\mu$ over $D$ is measured by the relative canonical divisor $K_{Y/X} = \sum_{i=1}^r k_i E_i$ which is locally defined by the Jacobian of $\mu$.
Write $G:Y\to \C^p$ for the lift of $F$ to $Y$.
Introducing new variables $s_1,\ldots,s_p$ we abbreviate $F^s= f_1^{s_1} \cdots f_p^{s_p}$ and similarly for $G^s$.


The local Bernstein-Sato Ideal $B_{F,x}$ of the function germ of $F$ at some point $x\in X$ consists of all polynomials $b(s_1,\ldots, s_n)$ such that there exists some local partial differential operator $P\in \D_{X,x}\otimes \C[s_1,\ldots,s_n]$ with the following equality in the stalk at $x$
$$b(s_1,\ldots, s_n) F^s = P\cdot F^{s+1}.$$
The global Bernstein-Sato Ideal $B_F$ of $F$ is the intersection of all local Bernstein-Sato Ideals.\todo{Restate more generally with $+a$ when proof is done.}

The goal of this chapter is to estimate the zero locust $Z(B_{F})\subseteq \C^p$.
This zero locust generalises the roots of the Bernstein-Sato polynomial in the monovariate case.
The classical approximation of the roots of the $b$-polynomial is due to \cite{kashiwara1976b} and this estimation was further refined by \cite{lichtin1989poles}.
The idea in both proofs is that it is easy to explicitly compute the Bernstein-Sato polynomial for monomials and that one can reduce to this case by use of the resolution of singularities.
The main non-trivial step in these arguments is to translate the solution upstairs to a solution on $X$.
This makes use of the direct image of $\D_X$-modules.
The essential insight in the refined estimate due to Lichtin is that the direct image of $\D_X$-modules is more natural for right $\D_X$-modules than left $\D_X$-modules.


The estimate by Kashiwara has been generalised to the multivariate situation in \cite{budur2020zero}.
The main challenge in such a multivariate generalisation is that the classical proof relies on modules of the type $\D_X f^{s}/ \D_X f^{s+1}$ being holonomic.
This is no longer the case for the multivariate generalisation $\D_X[s_1,\ldots, s_n]f^s /\D_X[s_1,\ldots, s_n]f^{s+1}.$
Tthe notion of relative holonomicity, due to \cite{maisonobe2016filtration}, still holds.

In this chapter we generalise the refined estimate by \cite{lichtin1989poles} to the multivariate situation.
The main new ingredient is a induction argument which reduces the problem to the monovariate case where relative holonomicity becomes ordinary holonomicity.
This induction is similar to the arguments in \cite{budur2019zero}.
\begin{theorem}\label{thm: EstimateBernsteinSatoZeroLocust}
  With notation as above every irreducible component of $Z(B_F)$ of codimension $1$ is a hyperplane of the form
  $$\operatorname{mult}_{E_i}(g_1) s_1 + \cdots + \operatorname{mult}_{E_i}(g_r)s_r + k_i + c_i=0$$
  with $c_i \in \mathbb{Z}_{\geq 0 }$.
\end{theorem}
\todo{Should also give a overview of the results that are already known here. }
\section{Relative Notions}
\subsection{Modules over $\A_X^R$}
Let $X$ be a smooth complex irreducible algebraic variety of dimension $n$ and denote $\D_X$ for it's sheaf of rings of algebraic differential operators.
For a regular commutative $\C$-algebra integral domain $R$ we define a sheaf of rings on $X\times \Spec R$ by
$$\A_{X}^R = \D_X \otimes_{\underline{\C}} \O_{R}; \qquad \A_X = \A_{X}^{\C[s]}$$
where we abbreviated $\O_R = \O_{\Spec R}$. It will also be convenient to use the abbreviation $\O_{X}^R := \O_{X \times \Spec R}$.


The order filtration $F_p\D_X$ extends to a filtration $F_p\A^R_X = F_p\D_X \otimes_{\underline{\C}} \O_R$ on $\A^R_X$ which is called the relative filtration.
The associated graded objects are denoted by $\grrel$. Denote $\pi:T^*X\times \Spec R \to X\times \Spec R$ for the projection map.
As in the case of $\D_X$-modules in chapter 1 \todo{cite} one can view $\pi^{-1}(\grrel\A_X^R)$ as a subsheaf of $\O_{T^*X}^R$ and for any $\grrel\A_X^R$-module $\mathcal{M}$ there is a corresponding module on $T^*X\times \Spec R$ defined by $\O_{T^*X}^R\otimes_{\pi^{-1}\grrel\A_X^R}\pi^{-1}\mathcal{M}$.
By abuse of notation the corresponding module on $T^*X\times \Spec R$ is still denoted with $\mathcal{M}$ and we adopt the perspective that $\grrel\A_X^R$-modules always live on $T^*X\times \Spec R$ unless explicitly mentioned otherwise.


Similarly to the case of $\D_X$ in the first chapter that \todo{Cite when C1 is written} it holds that $\A_X^R$ is the sheaf of rings generated by $\O_X^R$ and $\Theta_X$ inside of $\mathcal{E}nd_{\underline{\C}}(\O_X^R)$. Giving a left $\A_X^R$-module is equivalent to giving a $\O_X^R$-module $\M$ with $\Theta_X$-action such that
$\xi\cdot (fm) = f (\xi \cdot m)  + \xi(f)\ m  $
for any sections $f$ of $\O_X^R$ and $\xi$ of $\Theta_X$. Similarly, giving a right $\A_X^R$-module is equivalent to giving a $\O_X$-module $\M$ with $\Theta_X$-action such that $(mf)\cdot\xi = (m\cdot\xi)f - m\ \xi(f) $ for any sections $f$ of $\O_X^R$ and $\xi$ of $\Theta_X$.

The proof of the following results proceeds precisely like the case of $\D_X$-modules which may be found in \cite[Chapter 2]{hotta2007d}. \todo{Probably cite C1 instead}
\begin{proposition}\label{prop: CoherentAndGoodFiltration}
    A quasi-coherent $\A_X^R$-module $\M$ is coherent if and only if it admits a filtration such that $\grrel \M$ is coherent over $\grrel \A_X^R$. Such a filtration is called a good filtration.
\end{proposition}
\begin{proposition}
    Let $\M$ be a coherent $\A_X^R$-module, then the support of $\grrel \M$ in $T^*X \times \Spec R$ is independent of the chosen filtration. It is called the characteristic variety of $\M$ and denoted $\Chrel \M$.
\end{proposition}
%\todo{Add Chrel behaviour with respect to SES}
\subsection{Basic Operations}\label{sec: BasicOperations}
For any right $\A_{X}^R$-module $\M$ and left $\D_X$-module $\N$ the tensor product $\M \otimes_{\O_X} \N$ comes equipped with a right $\A_X^R$-module structure defined by
$$f\cdot (m\otimes n) = mf \otimes n; \qquad \xi \cdot (m\otimes n) = m\xi \otimes n - m\otimes \xi n $$
for any sections $f$ of $\O_X^R$ and $\xi$ in $\Theta_X$. Putting multiplication by $f$ on the other side of the tensor product this definition is also applicable for a right $\A_X^R$-module structure on $\M\otimes_{\O_X} \N$ if $\M$ is a right $\D_X$-module and $\N$ is a left $\A_X^R$-module. If both are $\A_X^R$-modules there is a right $\A_X^R$-module structure on $\M\otimes_{\O_X^R} \N$.

Similarly, given a left $\D_X$-module $\mathscr{L}$ and a left $\A_X^R$-module $\N$ a left $\A_X^R$-module structure on $\mathscr{L} \otimes_{\O_X} \N$ is defined by
$$f \cdot (\ell\otimes n) =\ell \otimes fn; \qquad \xi \cdot (\ell\otimes n ) = \xi \ell \otimes n + \ell \otimes \xi n$$
for any sections $f$ of $\O_X^R$ and $\xi$ in $\Theta_X$.

\begin{lemma}\label{lem: IsomorphismTensors}
  Let $\mathscr{M}, \N$ be right and left $\A_X^R$-modules respectively and let $\mathscr{L}$ be a left $\D_X$-module. Then there is a isomorphism of left $\A_X^R$-modules
  $$(\M \otimes_{\O_X} \mathscr{L})\otimes_{\O_X^R} \N \cong \M \otimes_{\O_X^R} (\mathscr{L}\otimes_{\O_X} \N).   $$
\end{lemma}
\begin{proof}
  This is immediate by checking that the obvious bijection conserves the $\A_X^R$-module structure. Note that the only nontrivial check is the action of a section $\xi$ from $\Theta_X$.
\end{proof}
\begin{lemma}\label{lem: FreeLeftAModuleTensor}
  Let $\N$ be a left $\A_X^R$-module which is locally free as a $\O_X^R$-module. Consider $\A_X^R$ as a right $\A_X^R$-module, then $\A_X^R \otimes_{\O_X^R} \N$ is locally free as a right $\A_X^R$-module.
\end{lemma}
\begin{proof}
  Consider local coordinates $x_1,\ldots, x_n$ on $X$ and a local $\O_X^R$-basis $\{n_\beta\}_\beta$ for $\N$. Then $\{1\otimes n_\beta\}_{\beta}$ will be a local $\A_X^R$-basis for $\A_X^R \otimes_{\O_X^R} \N$.

  To see that this generates the $\A_X^R$-module note that $\{\xi^\alpha \otimes n_\beta\}_{\alpha,\beta}$
  is a $\O_X^R$-basis set when $\alpha$ runs over all multi-indices in $\Z_{\geq 0}^n$.
  These sections can be recovered using the $\A_X^R$-action on the proposed generating set by induction on $\abs{\alpha}$.
  Indeed, $\xi^\alpha \cdot (1 \otimes n_\beta)$ equals $\xi^\alpha \otimes n_\beta$ up to a element in the $\O_X^R$-span of $\{\xi^\gamma \otimes n_\beta\}_{\abs{\gamma}<\abs{\alpha}}$.

  For the freedom, suppose there is a local $\A_X^R$-relation $\sum_\beta P_\beta \cdot 1\otimes n_\beta = 0$ with some $P_\beta$ nonzero. This is of the form $\sum_{\alpha, \beta} f_{\alpha,\beta} \xi^\alpha \cdot 1\otimes n_\beta = 0$ with the $f_{\alpha,\beta}$ sections of $\O_X^R$ not all equal to zero.
  Pick some multi-index $\mu\in \Z_{\geq 0}^n$ and of maximal degree such that $f_{\mu,\beta}$ is non-zero for some $\beta$.
  Then, rewriting $\sum_{\alpha, \beta} f_\alpha \xi^\alpha \cdot 1\otimes n_\beta = 0$ in terms of the $\O_X^R$-basis $\{\xi^\alpha \otimes n_\beta\}_{\alpha,\beta}$ one finds a non-zero coeffiencient at $\xi^\eta \otimes n_\beta$ for some $\beta$ which is a contradiction.
\end{proof}
\begin{lemma}
  The functor $\Omega_X\otimes_{\O_X}\blank$ which takes a left $\A_X^R$-modules and returns a right $\A_X^R$-module is an equivalence of categories with pseudoinverse  $\mathscr{H}om_{\O_X}(\Omega_X,\blank)$.
\end{lemma}
\begin{proof}
  For any right $\A_X^R$-module $\M$ the left $\A_X^R$-module structure on $\mathscr{H}om_{\O_X}(\Omega_X, \M)$ is defined by
  $$(f \cdot \varphi)(\omega)= \varphi(\omega)\cdot f; \qquad (\xi\cdot \varphi)(\omega) = \varphi(\omega \cdot \xi) - \varphi(\omega)\cdot \xi. $$
  for any sections $f$ of $\O_X^R$ and $\xi$ in $\Theta_X$.

  For any left $\A_X^R$-module $\M$ there is a natural isomorphism of $\O_X^R$-modules $\Omega_X\otimes_{\O_X}\H om _{\O_X}(\Omega_X, \M) \cong \M$ by sending $\omega \otimes \varphi$ to $\varphi(\omega)$.
  Similarly for any right $\A_X^R$-module $\M$ the isomorphism $\M \cong \H om_{\O_X}(\Omega_X, \Omega_X\otimes \M)$ associates to a section $m$ of $\M$ the morphism $\omega \mapsto \omega \otimes m$.
  A direct computation verifies these isomorphisms commute with the $\A_X^R$-module structure.
\end{proof}

\subsection{Relative Holonomicity}
A coherent $\A_X^R$-module $\M$ is said to be relative holonomic over $R$ if $\Chrel \M = \cup_w \Lambda_w \times S_w$
for irreducible conic Lagrangian subvarieties $\Lambda_w\subseteq T^*X$ and irreducible closed subvarieties $S_w\subseteq \Spec R$.

\begin{lemma}
  The sheaf $\M := \A_Y G^s$ is relatively holonomic with relative characteristic variety
  $$\Chrel \M := \bigcup_{J\subseteq \{1,\ldots, n\}} T^\perp Y_J \times \C^p $$
  where $Y_J = \{y\in Y: g_j(y) = 0  \text{ for all }j\in J \}$. \footnote{$T^\perp$ denotes covectors annihilating the tangent space. }
\end{lemma}
\begin{proof}
  Working on a affine open $U$ we may assume that $G^s=x_1^{a_1s_1}\cdots x_k^{a_k s_k} u_{k+1}^{s_{k+1}} \cdots, u_{p}^{s_p}$ for coordinate functions $x_1,\ldots, x_p$, natural numbers $a_1,\ldots, a_k>0$ and invertible sections $u_{k+1},\ldots,u_{p}$ of $\O_Y$.
  We claim that $\A_U G^S \cong \A_U^R/\mathcal{I}$ where $\mathcal{I}$ is the left ideal sheaf generated by the $x_i\partial_i - a_is_i$ and $\partial_{j} - s_{j}u_j^{-1}$.

  Denoting $\varphi:\A_U \to \A_U G^s$ for the obvious surjection we certainly have that $\mathcal{I}$ is a subsheaf of $\ker \varphi$.
  It remains to show that $\ker\varphi / \mathcal{I} = 0$.
  Let $P=\sum c_{\alpha \beta} x^\alpha \partial^\beta$ represent some section in $\ker \varphi/\mathcal{I}$ where the non-zero $c_{\alpha \beta}$ do not vanish in $0$.
  By the relations $\partial_{j} - s_{j}u_j^{-1}$ it can be assumed that the only nonzero components of the multi-indices $\beta$ lie in $1,\ldots, k$.
  By $\A_U$-linear combinations of $x_i \partial_i - a_is_i$ it can further be enforced that the terms are either have $\alpha_i = 0$ or $\beta_i = 0$ for any $i=1,\ldots, k$. When acting on $G^s$ with the remainder the coefficients all end on different monomial coefficients to $G^s$ which means they have to be zero in order for $P$ to be in the kernel. This shows $\ker\varphi = \mathcal{I}$ as desired.

  It follows that $\grrel \mathcal{A}_UG^s \cong \grrel\A_U /\grrel \mathcal{I}$. It holds that $\grrel \mathcal{I}$ is generated by $x_i \xi_i$ and $\xi_j$ whence the result follows.
\end{proof}
The following lemma and it's proof may be found in \cite{maisonobe2016filtration}.
\begin{lemma}
  Let $\M$ be a finitely generated $\A_Y^R$-module. Suppose that $\Chrel \M \subseteq \Lambda \times \Spec R$ for some, not necessarily irreducible, conic Lagrangian subvariety $\Lambda\subseteq T^*X$. Then $\M$ is relative holonomic over $R$.
\end{lemma}
The Bernstein-Sato ideal may be defined more generally for any $\A_X^R$-module $\M$ as $B_\M := \Ann_{R}\M$. To see how this generalises $B_F$ one considers $\A_X^R F^s$ as a $\Xt$-module.
Here $t$ is a new variable which commutes with sections of $\D_X$ and satisfies $ts_i - s_it = 1$ for any $i=1,\ldots, n$.  The $\Xt$-module structure on $\A_X^R F^s$ is then defined by extending $tF^s = F^{s + 1}$. From this point of view $B_F = B_{\A_X^R F^s / t\A_X^R F^s}$.
\begin{proposition}\label{prop: ProjectionBernsteinSatoRelativeChar}
  $Z(B_n) = p_2(\Ch^{rel}(\M))$
\end{proposition}

\section{Direct Image Functor for $\A_X^R$-modules}
    In this section we state the natural generalisation of the direct image functor for $\D_X$-modules to the relative case of $\A_X^R$-modules. As with $\D$-modules this is the most natural for right-modules.\todo{more introduction}

    \subsection{Transfer Modules and $\A_Y^R$-module Direct Image}
    Let $\mu:Y\to X$ be some morphism of smooth algebraic varieties, by abuse of notation we will also denote $\mu$ for the induced map from $Y\times \Spec R$ to $X\times \Spec R$.

    A-priori it is not even clear what $\A_X^R$-module should correspond to $\A_Y^R$ since there is no natural push forward of vector fields.
    This issue may be resolved by use of the transfer $(\A_Y^R,\mu^{-1}\A_X^R)$-bimodule $\A_{Y\to X}^R:= \O_Y^R \otimes_{\mu^{-1}\O_X^R}\mu^{-1}\A_X^R$.
    Here, the right $\mu^{-1}\A_X^R$-module structure is just the action on the second component and definitions like \cref{sec: BasicOperations} are used to define the left $\A_Y^R$-module structure. To be precise
    $$f\cdot (g\otimes \mu^{-1}h_X) = fg \otimes \mu^{-1}h_X; \qquad \xi\cdot (g\otimes\mu^{-1}h_X) = \xi g \otimes \mu^{-1}h_X + g \otimes T\mu(\xi)\mu^{-1}h_X $$
    for any sections $f$ of $\O_Y^R$ and $\xi$ of $\Theta_Y$. Here $T\mu(\xi)$ is a local section of $\O_Y\otimes_{\mu^{-1}\O_X} \mu^{-1}\Theta_X$.
    \begin{definition}
      The direct image functor $\int_\mu$ from $\bD^{b,r}(\A_Y^R)$ to $\bD^{b,r}(\A_X^R)$ is defined to be $\bR\mu_* (\blank\otimes_{\A_Y^R}^L \A_{Y\to X}^R)$.
      For any $\A_Y^R$ module $\M$ the $j$-th direct image is the $\A_X^R$-modules $\int_\mu^j \M = \H^j \int_\mu \M$.
      The subscript $\mu$ will be surpressed whenever there is no ambiguity.
    \end{definition}

    To compute the direct image $\IntJ{j} \M$ a resolution for the transfer bimodule $\A_{Y\to X}$ is required.
    \begin{definition}
        Let $\M$ be a right $\A_Y^R$-module, the relative Spencer complex $\Sp_Y^\bullet(\M)$ is a complex of right $\A_Y^R$-modules, concentrated in negative degrees, with $\Sp_Y^{-k}(\M) = \M \otimes_{\O_Y} \wedge^{k}\Theta_Y$ and as differential the right-$\A_Y^R$-linear map $\delta$ given by
        \begin{align*}
            m\otimes \xi_1 \wedge \cdots \wedge \xi_k &\mapsto \sum_{i<j}(-1)^{i+j} m \otimes [\xi_i,\xi_j]\wedge \xi_1 \wedge \cdots \wedge \widehat{\xi}_i \wedge\cdots \widehat{\xi}_j \wedge \cdots \wedge \xi_k\\
            &- \sum_{i=1}^k (-1)^{i} m\xi_i \otimes \xi_1 \wedge \cdots \wedge \widehat{\xi}_i\wedge \cdots \wedge \xi_k
        \end{align*}
    \end{definition}
    The following lemma and it's proof are a generalisation of exercise 1.20 in \cite{sabbah2011introduction} to the relative case.
    \begin{lemma}\label{lem: RelativeSpencerResolvesOXR}
      The relative Spencer complex $\Sp_Y^\bullet(\A_Y^R)$ is a locally free resolution of $\O_X^R$ as left $\A_X^R$-module.
    \end{lemma}
    \begin{proof}
      Define a filtration on $\Sp_Y^\bullet(\A_Y^R)$ by the complexes $F_k\Sp_Y^\bullet(\A_Y^R)$ which have term $F_{k-\ell}\A_Y^R\otimes_{\O_Y}\wedge^\ell \Theta_Y$ in spot $\ell$.
      This filtration induces the complexes $\gr_k^{rel} \Sp_X^\bullet(\A_Y^R)$ with term  $\gr_{k-\ell}^{rel}\A_Y^R\otimes_{\O_Y}\wedge^\ell \Theta_Y$ in spot $\ell$.

      In local coordinates $x_1,\ldots, x_n$ one finds that $\grrel\Sp_Y^\bullet := \oplus_k \grrel_k \Sp_Y^\bullet(\A_Y^R)$ is the Koszul complex of $\O_Y^R[\xi_1,\ldots,\xi_n] = \grrel \A_Y^R$ with respect to  $\xi_1,\ldots, \xi_n$.\todo{Should I explain what a Koszul complex is?}
      Since $\xi_1,\ldots,\xi_n$ form a regular sequence a standard result on Koszul complexes\todo{Give reference to some book} yields that $\grrel\Sp_Y^\bullet(\A_Y^R)$ is a locally free resolution of $\O_Y^R$ as $\grrel \A_Y^R$-module.

      On the other hand, it is immediate that $F_0 \Sp^\bullet(\A_Y^R) = \gr_0^{rel}\Sp^\bullet(\A_Y^R)$ is  $\O_Y^R$ viewed as a complex. Hence, there is no contribution to $\gr^{rel}\Sp_Y^\bullet(\A_Y^R)$ from the terms of $k>0$.
      That is to say that $\gr_k^{rel}\Sp_Y^\bullet(\A_Y^R)$ is quasi-isomorphic to the zero complex for $k>0$.
      Hence, $F_0\Sp_Y^\bullet(\A_Y^R)\hookrightarrow \Sp_Y^\bullet(\A_Y^R)$ is a quasi-isomorphism by the exactness of the direct limit.
      \todo{Would be nice to give a reference, proof may be found on stackexchange}
      It follows that  $\Sp_Y^\bullet(\A_Y^R)$ is a resolution of $\O_X^R$.
      That the terms of $\Sp_Y^\bullet(\A_Y^R)$ are locally free follows from \cref{lem: FreeLeftAModuleTensor} after some minor adjustments in the statement and proof.
    \end{proof}

    Define the transfer Spencer complex as the complex of  $(\A_Y^R,f^{-1}\A_X)$-bimodules given by $\Sp^\bullet_{Y\to X}(\A_Y^R) := \Sp^\bullet_Y(\A_Y^R) \otimes_{\O_Y^R}\A_{Y \to X}^R$.
    The following lemma and it's proof are direct generalisation of exercise 3.4 in \cite{sabbah2011introduction} to the relative case.
    \begin{lemma}\label{lem: SpencerResolutionTransferModule}
      The transfer Spencer complex $\Sp^\bullet_{Y\to X}(\A_Y^R)$ is a resolution of $\A_{Y\to X}^R$ as a bimodule by locally free left $\A_Y^R$-modules.
    \end{lemma}
    \begin{proof}
       To see that the terms of the complex are locally free recall from \cref{lem: IsomorphismTensors} the following isomorphisms of left $\A_Y^R$-modules
        \begin{align*}
           (\A_Y^R \otimes_{\O_Y} \wedge^\ell\Theta_Y )\otimes_{\O_Y^R}\A_{Y\to X} &
           \cong \A_Y^R \otimes_{\O_Y^R}(  \wedge^\ell\Theta_Y \otimes_{\O_Y}\A_{Y\to X}).
        \end{align*}
        \todo{May be possible to remove this step from the proof and removing need for minor adjustment of previous proof. }
      Note that $\A_{Y\to X}^R$ is a locally free $\O_Y^R$-module since it is the pullback of a locally free module on $X\times \Spec R$.
      Combined with the fact that $\wedge^\ell \Theta$ is a locally free $\O_Y$-module this yields that $ \wedge^\ell\Theta_Y \otimes_{\O_Y}\A_{Y\to X}$ is a locally free $\O_Y^R$-module.
      Hence \cref{lem: IsomorphismTensors} is applicable and yields that the terms of the transfer Spencer complex are locally free $\A_Y^R$-modules.

      That the transfer Spencer complex is a resolution of $\A_{Y\to X}^R$ follows from \cref{lem: RelativeSpencerResolvesOXR} by using that $\A_{Y\to X}^R$ is a locally free and hence flat over $\O_Y^R$.
    \end{proof}


    Since tensoring with locally free modules yields a exact functor this simplifies the computation of the direct image as follows.
    \begin{corollary}
        It holds that $\int = \bR\mu_* (\blank\otimes_{\A_Y^R} \Sp_{Y\to X}^\bullet(\A_Y^R))$.
    \end{corollary}
    A strategy one can employ in proving theorems on some space $X$ is by first solving them on a nicer space $Y$ equipped with a map $Y\to X$. This can then be related to the problem on $X$ by use of the direct image. For this purpose it is useful that any global section of $\mathcal{M}$ induces a global section of the direct image. This is usually done in the language of left modules but for us it is more natural to work with right $\A_Y^R$-modules.
    \begin{lemma}\label{lem: GlobalSectionDirectImage}
        Let $\M$ be a right $\A_Y^R$-module. Then any global section $m\in\Gamma(Y,\M)$ induces a global section of $\Int\M)$.
    \end{lemma}
    \begin{proof}
      By the Leray spectral sequence there is a functorial isomorphism
      $$\mathbb{H}^\bullet(Y,\M\otimes_{\A_Y^R} \Sp_{Y\to X}^\bullet(\A_Y^R)) \cong \mathbb{H}^\bullet(X,\bR\mu_*(\M\otimes_{\A_Y^R} \Sp_{Y\to X}^\bullet(\A_Y^R))).$$
      In particular it follows that $\mathbb{H}^0(Y,\M \otimes_{\A_Y^R} \Sp_{Y\to X}^\bullet(\A_Y^R)) \cong \Gamma(X,\Int\M)$. The \v Cech spectral sequence now induces the desired global section in the direct image based on the section $m\otimes 1$ of $\M \otimes_{\A_Y^R}\Sp_{Y\to X}^0(\A_Y^R)$.
    \end{proof}
    \begin{theorem}
      Long exact sequence
    \end{theorem}
    \subsection{Functorial Properties of the Direct Image}
    \begin{theorem}
       Let $\mu:Z\to Y$ and $\nu:Y\to X$ be morphisms of smooth algebraic varieties. If $\mu$ is proper then $\int_{\nu\circ \mu} = \int_\nu \int_\mu$.
    \end{theorem}
    \begin{proof}
      See \url{http://www.math.stonybrook.edu/~cschnell/mat615/lectures/lecture17.pdf}
    \end{proof}
    This theorem reduces the computation of direct images to closed embeddings and projections by writing $\mu = \pi \circ \iota$ for $\iota:Y\to Y\times X$ and $\pi:Y\times X\to X$.
        %These cases are handled by the following theorem.
        %\begin{theorem}
        %   If $\iota: Y\to X$ is a closed embedding then $\int_\iota = \iota_*(\blank \otimes_{\A_{Y}} \A_{Y\to X})$.
        %   If $\pi:Y\times X \to X$ is the projection then $\int_\pi = \bR \pi_*(\blank \otimes_{\O_{Y\times X}} \wedge^{-\bullet}\Theta_{Y\times X/X}) $.\todo{Still need to adjust $\pi$ formula for relativity}
        %\end{theorem}



    Denote by $\bD^{b,r}_{qc}(\A_Y^{R})$ the full subcategory of $\bD^{b,r}(\A_Y^R)$ consisting of those complexes of right $\A_Y^R$-modules whose cohomology sheaves are quasi-coherent over $\O_Y\times \O_{\Spec R}$. Similarly for $\bD^{b,r}_{coh}(\A_Y^R)$ with the cohomology being coherent $\A_Y^R$-modules.
    \begin{theorem}\label{thm: ConservationQuasiCoherentAndCoherentIfProper}
        Let $\mu:X\to Y$ be a morphism of nonsingular algebraic varieties. Then the direct image $\int$ takes $\bD^{b,r}_{qc}(\A_Y^{R})$ into $\bD^{b,r}_{qc}(\A_X^{R})$. Moreover, when $\mu$ is proper the direct image takes $\bD^{b,r}_{coh}(\A_Y^R)$ into $\bD^{b,r}_{coh}(\A_X^R)$.
    \end{theorem}
    \begin{proof}
      See \url{http://www.math.stonybrook.edu/~cschnell/mat615/lectures/lecture18.pdf}
    \end{proof}
\subsection{Kashiwara's Estimate for the Characteristic Variety}
Let $\mu:Y\to X$ be a proper morphism of smooth algebraic varieties. Given a coherent $\A_X^R$-module $\M$ with relative characteristic variety $\Chrel \M$. We desire to estimate $\Chrel \IntJ{j} \M$ in terms of $\Chrel\M$. Such a estimate in the non-relative case is known due to Kashiwara. %

The original proof by \cite{kashiwara1976b} uses the theory of microlocal differential operators. The idea of the following proof is due to \cite{malgrange1985images} in a $K$-theoretic context. We follow the exposition of \cite{sabbah2011introduction} and replace it with the corresponding relative notions. %We note that the assumption that $\mu$ is proper can be relaxed but this version will suffice for our purposes.
\\

\noindent
Consider the following cotangent diagram
$$
\begin{tikzcd}
    & \mu^* T^* X\times \Spec R \arrow[swap]{ld}{T^* \mu} \arrow{rd}{\widetilde{\mu}} & \\
    T^* Y\times \Spec R & & T^*X\times \Spec R
\end{tikzcd}
$$
where the maps $T^*\mu$ and $\widetilde{\mu}$ act on the first component.
\begin{theorem}\label{thm: KashiwaraEstimate}
    Let $\M$ be a coherent $\A_Y^R$-module. Then, for any $j\geq 0$, we have
    $$\Chrel\left(\IntJ{j} \M \right)\subseteq  \widetilde{\mu}\left((T^*\mu)^{-1}(\Chrel \M) \right).$$
\end{theorem}
Note that the statement is local so, after replacing $X$ by some affine open, it may be assumed that $X\times \Spec R$ and $Y\times \Spec R$ are compact.
The first step is to note that a similar inclusion is easy for the $\grrel \A_Y^R$-modules.
The direct image functor on $\grrel \A_Y^R$-modules $\mathcal{M}$ is defined by $\int^j \mathcal{M} :=  \bR^j \widetilde{\mu}_* ( \bL(T^*\mu)^*\mathcal{M}).$
Here, $(T^*\mu)^*(\blank)$ produces a sheaf on $\mu^*T^*X\times \Spec R$ by $ \blank\otimes_{\mu^{-1}\O_X^R} \grrel \A_X^R$.
Looking at the supports the following result is immediate.
\begin{lemma}
    For any $\grrel\A_Y^R$-module $\mathcal{M}$ it holds that
    $$\supp \int^j \mathcal{M}\subseteq \widetilde{\mu}\left((T^* \mu)^{-1} \supp \mathcal{M}\right).$$
\end{lemma}
Applying this lemma to $\grrel\M$ it remains to show that $\supp\grrel\IntJ{j}\M\subseteq \supp\int^j \grrel\M$. This is proved in \cref{prop: SuppGrrelIntInclusion}. The main technical ingredient in the proof is the Rees modules associated to a filtered $\A_Y^R$-module $\M$.
\begin{definition}
    Let $z$ be a new variable. The Rees sheaf of rings $\Rees\A_Y^R$ is defined as the subsheaf $\oplus_p F_p \A_Y^R z^p $ of $\A_Y^R \otimes_\C \C[z]$. Similarly, any filtered $\A_Y^R$-module $\M$ gives rise to a $\Rees\A_Y$-module $\Rrel\M := \oplus_p F_p \M z^p$.
\end{definition}
Given a $\A_Y^R$-module $\M$ with a good filtration it follows that $\Rrel\M$ is a coherent $\Rees\A_Y^R$-module similarly to \cref{prop: CoherentAndGoodFiltration}.
The following isomorphisms of filtered modules on $Y\times \Spec R$ are essential.
They mean that the Rees module can be viewed as a parametrisation of various relevant modules.
$$\frac{\Rrel\M}{(z-1)\Rrel\M} \cong \M; \qquad \frac{\Rrel\M}{z\Rrel\M} \cong \grrel \M;\qquad \frac{\Rrel\M}{z^\ell\Rrel\M} \cong  \grl\M.$$
Here $\grl$ takes a filtered object and returns $\oplus_k F_{k}/F_{k-\ell}$.
The first formula may be be used to find a corresponding filtered $\A_Y^R$-module for any graded $\Rees\A_Y^R$-module without $\C[z]$-torsion.

The $j$th direct image of a $\Rees\A_Y^R$-module $\mathcal{M}$ is the sheaf of $\Rees\A_X^R$-modules on $X\times\Spec R$ defined by $\int^j \mathcal{M} = \bR^j\mu_*(\mathcal{M}\otimes^L_{\Rees \A_Y^R} \Rrel \A_{Y\to X}^R)$.
Here the filtration on $\A_{Y\to X}^R$ is defined by $F_i\A_{Y\to X}^R =\O_{Y}^R \otimes_{\mu^{-1}\O_X^R}\mu^{-1}F_i\A_X^R $.
The direct image may be restricted to the category of graded Rees modules in which case it returns a graded Rees module. Coherence is preserved similarly to \cref{thm: ConservationQuasiCoherentAndCoherentIfProper}.

Recall that a $\grrel\A_Y^R$-modules on $Y\times \Spec R$ could be be viewed as a sheaf on $T^*Y\times \Spec R$ and is already equipped with a direct image.
The Rees module viewpoint agrees with the earlier definition by the following lemma.

\begin{lemma}\label{lem: ReesAndOtherDirectImagesAgree}
  Consider a filterd $\A_Y^R$-module $\M$. Then viewing $\int^j \Rrel\M / z\Rrel\M$ with it's $\grrel\A_X^R$-module structure as a sheaf on $T^*X\times \Spec R$ recovers the $\grrel\A_Y^R$-module direct image $\int^j \grrel\M$. Viewing  $\int^j \Rrel\M / (z-1)\M$ as a $\A_X^R$-module recovers $\IntJ{j} \M$.
\end{lemma}
\begin{proof}
  We give the proof for $\int^j \grrel \M$, the proof for $\IntJ{j} \M$ is similar but easier.


  Consider the following Cartesian square
  $$
      \begin{tikzcd}
        \mu^*T^* X \times \Spec R \arrow{r}{T^*\mu} \arrow{d}{{\widetilde{\mu}}} &T^*Y\times \Spec R \arrow{r}{\pi_Y} & Y\times \Spec R\arrow{d}{\mu} \\
        T^*X\arrow{rr}{\pi_X}  \times \Spec R && X\times \Spec R.
      \end{tikzcd}
  $$
  Since $\pi_X$ is flat the derived version of the flat base change theorem yields that \todo{Check in detail that the theorem is applicable and has this conclusion due to flatness}
  $$\bL\pi_X^*\bR\mu_*(\frac{\Rrel\M}{z\Rrel \M}\otimes^L_{\A_Y^R}\Rrel \A_{Y\to X}^R) = \bR\widetilde{\mu}_*\bL(T^*\mu\circ\pi_Y)^*(\frac{\Rrel\M}{z\Rrel \M}\otimes^L_{\A_Y^R}\Rrel \A_{Y\to X}^R).$$
  Since $\pi_X$ is flat it follows that $\H^j \bL\pi_X^*(\blank) = \pi_X^*\H^j(\blank)$\todo{$\H^j \bL\pi_X^*(\blank) = \pi_X^*\H^j(\blank)$?}. It now suffices to show that the right hand side is $\int \grrel\M$.

  Since $\pi_Y$ is flat it holds that $\bL(T^*\mu \circ \pi_Y)^* = \bL (T^*\mu)^* \circ \bL \pi_Y^*$\todo{$\bL(T^*\mu \circ \pi_Y)^* = \bL (T^*\mu)^* \circ \bL \pi_Y^*$?}.
  We show that $\bL\pi_Y^*(\frac{\Rrel\M}{z\Rrel \M}\otimes^L_{\A_Y^R}\Rrel \A_{Y\to X}^R)\cong \grrel\M \otimes^L_{\mu^{-1}\O_X^R}\widetilde{\mu}^*\grrel\A_{X}^R$ from which the result follows immediately.

  Let $\mathcal{F}^\bullet$ denote a bimodule resolution for $\Rrel \A_{Y\to X}^R$ by locally free left $\Rees\A_Y^R$-modules.
  Then $(\Rees \A_Y^R / z\Rees \A_Y^R)\otimes_{\Rees \A_Y^R}\mathcal{F}^\bullet$ is a bimodule resolution for $\grrel \A_{Y\to X}^R$ by locally free left $\grrel\A_Y^R$-modules.
  Now $\bL\pi_Y^*$ just means applying $\pi^{-1}(\blank)\otimes \O_{T^*Y}$ to the terms of this free resolution.
  Due to flatness this yields a free resolution in $\pi^{*}\grrel\A_Y^R$-modules of $\pi^* \grrel\A_{Y\to X}^R$.
  Since $\grrel \A_{Y\to X}^R = \O_Y^R \otimes_{\mu^{-1}\O_X^R} \mu^{-1}\grrel\A_X^R$ and $\pi^*\mu^* = \widetilde{\mu}^*\pi^*$ the desired equality follows. \todo{Write out more}
\end{proof}
It turns out that one can directly compare $\grl\IntJ{j}\M$ and $\int^j \grl\M$ when $\ell$ is large. Some care is required since since $\int^j \Rrel \M$ may have $\C[z]$-torsion.
\begin{lemma}\label{lem: KernelZellStabilises}
  Consider a $\A_Y^R$-module $\M$ with a good filtration. Then, for sufficiently large $\ell$, the kernel of $z^\ell$ in $\int^j \Rrel \M$ stabilises. For such $\ell$ the quotient $\int^j \Rrel \M/ \ker z^\ell$ is the $\Rees \A_X^R$-coherent module associated to a good filtration on $\IntJ{j} \M$.
\end{lemma}
\begin{proof}
  By $\int \Rrel \M$ being coherent over the sheaf of Noetherian rings $\Rees\A_X^R$ it follows that $\ker z^\ell$ locally stabilises. This is sufficient since $X\times \Spec R$ is assumed to be compact.

    Now consider the short exact sequence $0\to \Rrel \M \xrightarrow{z-1} \Rrel \M \to \M \to 0$. This induces a long exact sequence
    $$\cdots \to \int^j \Rrel \M \xrightarrow{z-1} \int^j \Rrel \M \to \IntJ{j} \M \to \int^{j+1} \Rrel \M \xrightarrow{z-1}\cdots. $$
    Since $\int^{j+1} \Rrel \M$ is a graded $\Rees\A_X^R$-module it follows that $z-1$ is injective whence $\int^j \Rrel \M / (z-1)\int^j \Rrel \M \cong \IntJ{j} \M$. This yields the desired result using that $\int^j \Rrel \M / \ker z^\ell$ is $\C[z]$-torsion free and the isomorphism
    $$ \frac{\int^j \Rrel \M }{(z-1)\int^j \Rrel \M } \cong \frac{\int^j \Rrel \M /\ker z^\ell }{(z-1)(\int^j \Rrel \M/\ker z^\ell) }.$$
\end{proof}
From now on we equip $\IntJ{j} \M$ with the good filtation inherited from the Rees module's direct image.
\begin{lemma}\label{lem: EllLargeSubquotent}
    Consider a $\A_Y^R$-module $\M$ with a good filtration. Then, if $\ell$ is sufficiently large, $\grl \IntJ{j}\M$ is a subquotient of $\int^j\grl\M$.
\end{lemma}
\begin{proof}
  The short exact sequence $0\to \Rrel\M \xrightarrow{z^\ell}\Rrel \M \to \Rrel\M / z^\ell \Rrel\M \to 0$ induces a long exact sequence
  $$\cdots \to \int^j \Rrel \M \xrightarrow{z^\ell} \int^j \Rrel \M \to \int^j \Rrel\M/z^\ell \Rrel\M \to \int^{j+1} \Rrel \M \xrightarrow{z^\ell}\cdots. $$
  Hence, $\int^j \Rrel \M / z^\ell \int^j \Rrel \M$ is a submodule of $\int^j (\Rrel\M/z^\ell \Rrel\M)$ and it remains to show that $\Rrel \IntJ{j} \M/ z^\ell \Rrel \IntJ{j} \M$ is a quotient of $\int^j \Rrel \M / z^\ell \int^j \Rrel \M$.

  Let $\ell$ be sufficiently large so that \cref{lem: KernelZellStabilises} yields a isomorphism $\int^j \Rrel \M / \ker z^\ell \cong \Rrel\int^j \M$. The map $z^\ell$ induces a isomorphism $\int^j \Rrel \M / \ker z^\ell \cong z^\ell \int^j \Rrel \M$. Therefore $z^\ell \int^j \Rrel \M / z^{2\ell}\int^j \Rrel\M \cong \Rrel \IntJ{j} \M / z^\ell \Rrel\IntJ{j} \M $.
  The desired quotient follows by applying the map $m\mapsto z^\ell m$ on $\int^j \Rrel \M / z^\ell \int^j \Rrel \M$.
\end{proof}
The main remaining task is to relate these results to the desired case of $\ell = 1$.
\begin{definition}
  For any $\ell \geq 1$ the $G$-filtration on a $\Rees\A_Y^R$-module $\mathcal{M}$ is defined by the decreasing sequence of $\grl\A_Y^R$-submodules $G_j \mathcal{M} := z^{j}\mathcal{M}$.
\end{definition}
\begin{lemma}\label{lem: GradedGGradedLYieldsGraded}
  For any filtered $\A_Y^R$-module $\M$ and $\ell \geq 1$ there is the a isomorphism of $\gr \A_Y^R$-modules
  $$\gr^G \grl \M \cong (\grrel\M)^\ell.$$
\end{lemma}
\begin{proof}
  This follows from directly from the fact that $G_j\grl\M = \oplus_k F_{k-j}\M /F_{k-\ell}\M$.
\end{proof}
\begin{lemma}\label{lem: grGCommutes}
  Consider a $\Rees\A_Y^R$-module $\mathcal{M}$. Then one has a isomorphism $\gr^G\int\mathcal{M} \cong \int\gr^G\mathcal{M}$ in $\bD^{b,r}(\grrel\A_X^R)$.
\end{lemma}
\begin{proof}
  Writing out the direct image functors the desired result is a isomorphism $$\gr^G\bR\mu_*(\mathcal{M}\otimes^L_{\Rees\A_Y^R} \Rees\A_{Y\to X}^R)  \cong \bR\mu_*(\gr^G\mathcal{M}\otimes^L_{\mu^{-1}\O_X^R}\grrel\A_X^R).$$
  The proof of the commutation proceeds in two steps corresponding to the two derived functors.

  Let $\F^\bullet$ be a bimodule resolution for $\Rrel\A_{Y\to X}^R$ by locally free left $\Rees \A_Y^R$-modules.
  There is a $G$-filtration on this complex given by $z^j(\mathcal{M}\otimes_{\Rees\A_Y^R} \F^\bullet) = (z^j\mathcal{M})\otimes_{\Rees\A_Y^R} \F^\bullet$.
  By the flatness of locally free sheaves and the short exact sequence $0\to \oplus_j z^j \mathcal{M} \to \oplus_j z^{j-1}\mathcal{M} \to \gr^G \mathcal{M} \to 0$ it follows that $\gr^G(\mathcal{M}\otimes_{\Rees\A_Y^R} \F^\bullet) \cong (\gr^G\mathcal{M})\otimes_{\Rees\A_Y^R} \F^\bullet$.
  Further, by the argument in the proof of \cref{lem: ReesAndOtherDirectImagesAgree} the complex of $\gr^G\A_Y^R$-modules  $(\gr^G\mathcal{M})\otimes_{\Rees\A_Y^R} \F^\bullet$ can be viewed as a representative of $(\gr^G\mathcal{M})\otimes^L_{\mu^{-1}\O_X^R}\grrel\A_X^R$.\todo{Check after lemma is entirely proven}

  Denote $\mathcal{G}(\blank)$ for the functor which takes a sheaf complex and returns its Godement resolution.
  Flabby sheaves are acyclic for $\mu_*$ so the Godement resolution may be used to compute $\bR\mu_*$.
  Moreover, since the terms of a Godement resolution are essentially direct sums of formal products of stalks, it is immediate that $z^i \mathcal{G}(\mathcal{N}^\bullet) = \mathcal{G}(z^i\mathcal{N}^\bullet)$ and that $\gr^G\mathcal{G}(\mathcal{N}^\bullet) =\mathcal{G}(\gr^G\mathcal{N}^\bullet)$ for any complex of right $\mu^{-1}\Rees\A_X^R$-modules $\mathcal{N}^\bullet$.
  Applying $\mu_*$ to these equalities and setting $\mathcal{N}^\bullet = \mathcal{M}\otimes_{\Rees\A_Y^R} \F^\bullet$ yields the desired result.
\end{proof}
\begin{proposition}\label{prop: SuppGrrelIntInclusion}
  For a filtered $\A_Y^R$-module $\M$ with a good filtration it holds that  $$\supp \grrel\IntJ{j}\M \subseteq \supp \int^j \grrel\M.$$
\end{proposition}
\begin{proof}
  Let $\ell\geq 0$ be sufficiently large so that \cref{lem: EllLargeSubquotent} holds, that is to say that $\grl\IntJ{j} \M$ is a subquotient of $\int^j \grl \M$.
  By \cref{lem: GradedGGradedLYieldsGraded} it holds that $\gr^G\grl \IntJ{j} \M \cong (\grrel\int\M)^\ell$.
  Since $\grl \IntJ{j} \M$ is a subquotient of $\int \grl\M$ it remains to show that the support of $\gr^G \int^j \grl\M$ is a subset of the support of $\int^j \gr \M$.

  This can be established with the spectral sequence associated of the $G$-filtered complex $\int \grl \M$. Since the $G$-filtration is finite on $\grl\A_X^R$-modules the associated spectral sequence abbuts by general results\todo{Found spectral sequence result online, add good reference.}. To be precise the associated spectral sequence with terms
  $E^2_{pq} = \H^{p+q}\gr^G \int \grl \M$ abuts to $\gr^G\int \M$.
  By \cref{lem: grGCommutes} and \cref{lem: GradedGGradedLYieldsGraded} it holds that $E^2_{pq} \cong (\int^{p+q}\gr \M)^\ell$. \todo{Or $E^1$? Seems to depend on preference but should actually matter somewhat for the differentials.}
  It follows that $\supp\gr^G \int^j \grl\M$ is a subset of the support of $\int \gr \M$ which completes the proof.
\end{proof}

\section{Non-commutative Homological Notions}
In this section we discuss homological notions associated to the $\Ext$-functor over a ring $A$ which may not be commutative.   These notions are particularly well-behaved for relatively holonomic modules.

\subsection{Auslander Regularity}
Based on appendix \cite{budur2019zero} which is itself based on \cite{bjork1979rings}. $X$ is assumed to be affine
\begin{definition}
  Homological dimension
\end{definition}
\begin{definition}
  Grade
\end{definition}
The following definition should be viewed in perspective of  the Auslander-Buchsbaum-Serre theorem which asserts that a commutative local ring is regular if and only if it has finite global homological dimension. This connection to the commutative notion of regularity is further clarified by propositions ...
\begin{definition}
  Auslander regular ring
\end{definition}
\begin{proposition}
  Connection with commutative case $\gr$
\end{proposition}
\begin{proposition}
  If $A$ is regular commutative
\end{proposition}
\begin{proposition}
  gl.dim in terms of $j(M)$
\end{proposition}
\begin{proposition}
  $j(\blank) = j(\gr)$
\end{proposition}
\begin{corollary}\label{cor: AXRBehaviourGradesJAndChrel}
  For finitely generated $\A_X^R$-modules
  $$j(\M) + \dim \Chrel \M = 2n + \dim R $$
\end{corollary}
\subsection{Pure Modules}
\begin{definition}
  Pure
\end{definition}
\begin{lemma}
  Behaviour $\Ext$
\end{lemma}
\begin{lemma}
  $\Ext$ of relative holonomic remains so
\end{lemma}
\begin{lemma}\label{lem: NotBernsteinInjectiveAutomorphism}
  Let $\M$ be a relative holonomic $\A_X^R$-module which is $(n+k)$-pure for some $0\leq k \leq \dim R$. If $b\in R$ is not contained in any minimal prime ideal containing $B_\M$ then multiplication by $b$ induces injective automorphisms on $\N$ and $\Ext^{n+k}_{\A_X^R}(\M,\A_X^R)$.
\end{lemma}
\begin{lemma}\label{lem: CMLemmaBudur}
  $M/\ell$ conserves CM, like prop 3.4.3 in \cite{budur2019zero}
\end{lemma}

\begin{lemma}\label{lem: RestrictToCM}
  Let $\M$ be a relative holonomic $\A_X^R$-module of grade $j(\M) = (n+k)$ some $0\leq k < \dim R$.

  Then there exists a polynomial $\ell$ of degree one such that $\M \otimes_R R/(\ell)$ is a relative holonomic  $\A_X^{R/(\ell)}$-module of grade $n+k$. Moreover, if $k=0$ then $\ell$ can be arbitrary.
\end{lemma}
\begin{proof}
  Like prop 3.4.3 in \cite{budur2019zero} using that $E_{0,n+k}2 = \Tor_0^{\A_X^R}(\Ext_{\A_X^R}^{n+k},\A_{X}^{R/(b)}) \cong \Ext_{\A_X^R}^{n+k}(\M,\A_R)\otimes_{R}R/(b) \neq 0$ in the spectral sequence.

  Here $\Ext_{\A_X^R}^{n+k}(\M,\A_R)\otimes_{R}R/(b) \neq 0$ is where the existence and $k<\dim R$ is needed. It's like the first part of the proof of prop 3.4.3 using that $\Ext$ is always pure and $\ell$ can be chosen appropriately.
\end{proof}
\subsection{Cohen-Macauley}
\begin{definition}
  Cohen-Macauley
\end{definition}
\begin{lemma}\label{lem: GradeToCMOverOpen}
  Relative holonomic with $j(\M)= n+k$ is $(n+k)$-CM over a open $\Spec R$ of codimension $>k$. Similarly $j(\M)> n+k$ yields zero.
\end{lemma}
\begin{proof}
  Like lemma 3.5.2 in \cite{budur2019zero}
\end{proof}



The following lemma is a generalisations of a result by \cite{kashiwara1976b} to the relative case.
The proof and statement are more involved than the original result by Kashiwara but follow the same line of thought.
\begin{lemma}\label{lem: StabilisationtN}
  Let $\M$ be a relative holonomic $\A_X^R$-module which comes equipped with the structure of a $\Xt$-module.
  Suppose that $\M$ has grade $j(\M) = n+k$ with $k\geq 1$.
  Then there exists a open $\Spec R' \subseteq \Spec R$ such that $\M' = \M \otimes_{R} R'$ is a relative holonomic $\A_X^{R'}$-module with $t^N \M' = 0$ for $N$ sufficiently large. Moreover, it may be assumed that $\Spec R \setminus \Spec R'$ has codimension strictly greater than $k$.
\end{lemma}
\begin{proof}
  The proof is split in two main parts. The first part it is establises that $\Ext^{n+k}_{\A_X^{R'}}(t^i\M',\ab\A_X^{R'})$ stabilises and that the $t^i\M'$ are $(n+k)$-Cohen-Macauley. It follows that $t^i\M'$ stabilises and the final part of the proof deduces that the stable value is zero.

  Note that $\M/t\M$ is a coherent sheaves over the Noetherian sheaf of rings $\A_X^R$.
  Hence, the kernel of the morphisms $\M/t\M \to t^i\M / t^{i+1}\M$ stabilise.
  Let $N\geq 0$ be sufficiently large so that these kernels are constant for $i\geq N$.

  By use of \cref{lem: GradeToCMOverOpen} it may be assumed that $\Spec R'$ is such that $t^i\M'$, $\M'/t^{i}\M'$, $t^i\M'/t^{i+1}\M'$ and the kernels $K_i$ of the morphisms $\M'/t\M' \to t^i \M'/ t^{i+1} \M'$ are zero or $(n+k)$-Cohen-Macauley for any $i=0,\ldots,N$.
  Since localisation is an exact functor the stabilisation of kernels for $i\geq N$ is still valid over $\Spec R'$.
  The first steps in this proof use the stabilisation to estabish that the modules are actually $(n+k)$-Cohen-Macaulay for arbitrary $i\geq 0$. For notational simplicity we abbreviate $\Ext^{k}(\M') :=\Ext^{k}_{\A_X^{R'}}(\M',\A_X^{R'})$.

  The surjection $\M'/t\M' \to t^i \M'/t^{i+1}$ induces a long exact sequence
  $$0 \to \Ext^{n+k}\left(\frac{t^i\M'}{ t^{i+1}\M'}\right) \to  \Ext^{n+k}\left(\frac{\M'}{t\M'}\right) \to \Ext^{n+k}\left(K_i\right) \to \Ext^{n+k+1}\left(\frac{t^i\M'}{ t^{i+1}\M'}\right)\to \cdots $$
  In particular there is a isomorphism $\Ext^{n+k+1}(t^i\M'/t^{i+1}\M') \cong \Ext^{n+k}(K_i)\ab/\img \Ext^{n+k}(\M'\ab /t\M')$ whose left-hand-side is known to vanish when $i\leq N$.
  Since the righ-hand-side is constant for $i\geq N$ it follows that $\Ext^{n+k+1}(t^i\M'/t^{i+1}\M')\cong 0$ for any $i\geq 0$.
  The higher order terms of the long exact sequence yield $\Ext^{n+k+j}(\frac{t^i\M'}{ t^{i+1}\M'}) \cong 0$ for $j>1$.
  This shows that $t^i \M'/t^{i+1}\M'$ is $(n+k)$-Cohen-Macaulay or zero for any $i\geq 0$.


  The injection $t^{i+1} \M'\to t^{i}\M'$ induces exact sequences
  $$\Ext^{n+k+j}\left(\frac{t^i\M'}{ t^{i+1}\M'}\right) \to  \Ext^{n+k+j}\left(t^{i}\M'\right) \to \Ext^{n+k +j}\left(t^{i+1} \M'\right).$$
  By induction on $i$ it follows that $t^i\M'$ is $(n+k)$-Cohen-Macaulay or zero for any $i\geq 0$.
  Similarly the long exact sequence induced by the surjection $\M/t^{i+1}\M' \to \M'/t^{i}\M'$ yields that $\M/t^{i}\M$ is $(n+k)$-Cohen-Macaulay or zero for any $i\geq 0$.


  By the Cohen-Macauley results which have been established it follows that the morphisms $\Ext^{n+k}( t^i\M') \to  \Ext^{n+k}(t^{i+1}\M')$ and $\Ext^{n+k}(\M') \to \Ext^{n+k} (t^i\M',\ab \A_X^{R'})$ are surjective.
  Note that $\Ext^{n+k}(\M)$ is a coherent sheaf over the Noetherian sheaf of rings $\A_X^{R'}$.
  Hence the kernels of $\Ext^{n+k}(\M') \to \Ext^{n+k} (t^i\M')$ stabilise.
  After possibly increasing $N$ it follows that the morphisms $\Ext^{n+k}(t^i\M') \to  \Ext^{n+k}(t^{i+1}\M')$ are isomorphisms for $i\geq N$ which means that $\Ext^{n+k}(t^{i+1}\M')$ stabilises.

  By $t^i \M'$ being $(n+k)$-Cohen-Macaulay it follows that $\Ext^{n+k}(\Ext^{n+k}(t^i\M')) \cong t^i\M'$.\todo{Provide reference, maybe include and prove earlier since this is easy from double complex}
  It follows that $t^i \M'$ stabilises for $i\geq N$ and remains to show that this stable value is $0$.
  If the stable value is nonzero then it is $(n+k)$-Cohen-Macaulay with $k>1$.
  By \cref{cor: AXRBehaviourGradesJAndChrel} and \cref{prop: ProjectionBernsteinSatoRelativeChar} it follows that there exists some nonzero $b(s_1,\ldots,s_p) \in B_{t^N\M'}$.
  Note that one has the commutation relation
  $$tb(s_1,\ldots,s_p) = b(s_1+1,\ldots, s_p + 1)t.$$
  Since $t^{N+1}\M' = t^N\M'$ it follows by iteration that $b(s_1+n,\ldots, s_p + n)\in B_{t^N \M'}$ for any $n\geq 0$.
  This implies that $Z(B_{t^N\M'}) = 0$ which means that $t^N\M' = 0$.\todo{Geometrically obvious but may want to add formal argument}
\end{proof}
\section{Estimation of the Bernstein-Sato Zero Locust}
This section contains the main result of this chapter, namely a proof of the improved estimate for the Bernstein-Sato zero locust which was announced in \cref{thm: EstimateBernsteinSatoZeroLocust}.
We use the same notation as \cref{sec: IntoductionChapterRelative}.
This proof is similar to the method employed by \cite{lichtin1989poles} and \cite{kashiwara1976b} but a new induction argument is required in the proof of \cref{lem: GradeNPlusOne}.\\

\noindent
Recall that the global Bernstein-Sato Ideal is the intersection of all local ones.
This means that the global Bernstein-Sato zero locust $Z(B_F)$ is the union of all local ones so it suffices to estimate $Z(B_{F,x})$.
In particular, it may be assumed that $X$ is affine and admits global coordinates $x_1,\ldots,x_n$.

Due to these global coordinates there is a $\O_X^R$-linear isomorphism between any left $\A_X^R$-module $\N$ and it's right version $\Omega_X \otimes_{\O_X}\N$. Concretely, any section $u$ of $\N$ gives rise to the section $u^* := u dx$. Further, for any operator $P$ of $\A_X^R$ there is a adjoint $P^*$ such that
$$(P\cdot u)^* =   u^* \cdot P^*$$
for any section $u$ of $\N$. For a vector field $\xi := \sum_i\xi_i \partial_i$ comparison of the definitions shows that $\xi^* := \sum_i\partial_i\xi_i$ satisfies this equality and this extends to $\A_X^R$ by iterating.

By this procedure the functional equation $P F^{s+1} = b F^s$ may equivalently be stated as the equation
$$F^{s+1}dx \cdot P^* = b F^s dx $$
in $\A_X F^s \otimes_{\O_X}\Omega_X$.
The corresponding module $\M$ on $Y$ will be the submodule of $\Omega_Y\otimes_{\O_Y} \A_Y G^s$ spanned by $G^s \mu^*(dx)$.
This may be viewed as a $\XtR{Y}{}$-module by the action $t G^s \mu^*(dx) = G^{s+1} \mu^*(dx)$.
Replacing $\A_XF^s$ by it's right version $\A_XF^s \otimes_{\O_X}\Omega_X$ is convenient because the direct image functor is more natural for right modules.
This will make it easier to transfer information along the resolution of singularities to.
Further, it explains why the relative canonical divisor occurs in the improved estimate of \cref{thm: EstimateBernsteinSatoZeroLocust}.
This is because $\mu^*(dx)$ gives a local equation for $K_{Y/X}$.
\begin{lemma}\label{lem: BernsteinSatoPolynomialUpstairs}
  In the notation of \cref{sec: IntoductionChapterRelative} a polynomial of the form
  $\prod_{i=1}^p \prod_{j=0}^N(\operatorname{mult}_{E_i}(g_1)\ab s_1 + \cdots + \operatorname{mult}_{E_i}(g_r)\ab s_r + k_i + j)$
  belongs to the Bernstein-Sato ideal $B_{\M/t\M}$ if $N\geq 0$ is sufficiently large.
\end{lemma}
\begin{proof}
  This may be checked locally.
  Take a open $U\subseteq Y$ which is sufficiently small to admit local coordinates $z_1,\ldots,z_n$ where $z_i$ determines $E_i$ if $E_i\cap U \neq \emptyset$.

  In these local coordinates $G^s = \prod_{i=1}^p u_i^{s_i} \prod_{i=1}^nz_i^{\sum_{j=1}^p M_{ij}s_j}$ and $\mu^*(dx) = v \prod_{i=1}^n z_i^{m_i} dz$ where $M_{ij} \leq \operatorname{mult}_{E_i}(g_j)$, $m_i \leq k_i$ and $u_i,v$ are local units.
  For notational convenience set $u_i=1$ and $s_i=0$ for $i>p$.
  Denote $N_i = \sum_j M_{ij}$ and $\xi_i = \partial_i - \sum_{j=1}^n s_ju_j \partial_i(u_j)$ for any $i=1,\ldots,p$.
  Let $P = v^{-1}(\prod_{i=1}^p u_i^{-1})\xi_1^{N_1} \cdots \xi_p^{N_p} v$ then
  $$v\prod_{i=1}^n u_i^{s_j + 1}z_i^{\sum_{j=1}^p M_{ij}(s_j+1) + m_i}dz \cdot P =  b v \prod_{i=1}^nu_i^{s_j}z_i^{\sum_{j=1}^p M_{ij}s_j + m_i}dz $$
  where
  $$b = \prod_{i=1}^p(\sum_{j=1}^p M_{ij}s_j + m_i + N_i)(\sum_{j=1}^p M_{ij}s_j + m_i + N_i - 1)\cdots(\sum_{j=1}^p M_{ij}s_j + m_i).$$
\end{proof}

By \cref{lem: GlobalSectionDirectImage} the global section $G^s \mu^*(dx)$ of $\M$ gives rise to a global section $u$ of $\Int\M$.
Denote $\U$ for the right $\A_X$-module generated by $u$.
From \cref{lem: BernsteinSatoPolynomialUpstairs} one gets a $b$-polynomial of a desirable form for $\Int \M/t\Int\M$.
The main remaining difficulty in the proof is to induce a $b$-polynomial for $\U/t\U$.
This will exploit \cref{lem: StabilisationtN} whence it is needed that $\Int\M /\U$ has grade at least $n+1$.

Let $\ell_1,\ldots,\ell_{p-1}\in \C[s]$ be degree one polynomials which will be fixed later.
For any $i=0\ldots,p$ let $L_i$ be the ideal of $\C[s]$ generated by $\ell_1,\ldots,\ell_i$.
Assume that the $\ell_i$ are chosen sufficiently generically so that $Z(L_{p-1})$ is a line.

In what follows we want to consider the $\A_Y$-module $\M$ as $\D_Y$-modules.
This could disturb coherence.
To solve this one introduces new coordinates such that there are vector fields $\mathcal{S}_1,\ldots, \mathcal{S}_p$ which acts as $s_1,\ldots,s_p$ on the generator.

Note that there are finitely many codimension $1$ components in $Z(B_F)$.
Hence, there exist $p$ independent linear polynomials $\sum_{i=1}^p d_{ij}s_i$ such that for any $j$ there is no hyperplane parallel to $\sum_{i=1}^p d_{ij}s_i = 0$ in $Z(B_F)$.
Moreover, it may be assumed that the $d_{ij}$ are nonnegative integers.
Introduce new coordinates $z_{n+1}, \ldots,z_{n+p}$ and set $\mathcal{X}:= X\times \C^p$ and $\mathcal{Y} := Y\times \C^p$.
For any $j=1,\ldots, p$ set $\widetilde{f}_j = f_j\prod_{i=1}^p z_{n+i}^{d_{ij}}$.
Note that the induced map $\mathcal{Y} \to \mathcal{X}$ is a resolution of singularities for $\prod \widetilde{f}_i$ and that $\widetilde{g}_j = g_j\prod_{i=1}^p z_{n+i}^{d_{ij}}$ is the pullback of $\widetilde{f}_i$.

For any $i=1,\ldots,p$ it holds that
$$\widetilde{G}^s \mu^*(dx)\cdot \partial_{n+i} = \sum_{j=1}^p d_{ij}s_j x_j^{-1} \widetilde{G}^s \mu^*(dx).$$
Since the linear polynomials are independent a appropriate $\C$-linear combination provides a vector field $\zeta_j$ with $\widetilde{G}^s \mu^*(dx)\cdot \zeta_j = s_{j}z_j^{-1}\widetilde{G}^s \mu^*(dx)$.
Set $\mathcal{S}_j = \zeta_jz_j$ so that $\widetilde{G}^s \mu^*(dx) \cdot \mathcal{S}_j = s_j \widetilde{G}^s \mu^*(dx) $.
This solves the coherence isssue.
\begin{lemma}\label{lem: ReplacementIsAllowed}
  If $b\in B_{\widetilde{F},x}$ for any $x\in X\times \{0\}^p$ then $b \in B_F$.
\end{lemma}
\begin{proof}
  Take local coordinates $x_1,\ldots, x_{n+p}$ near $x$ and let $P$ be in the stalk of $\A_{\mathcal{X}}$ at $x$ such that $b \widetilde{F}^s = P \widetilde{F}^{s+1}$.
  Similarly to the above there is a $\C$-basis $\xi_1,\ldots,\xi_p$ for the span of $\partial_{n+1}, \ldots, \partial_{n+p}$ so that $\mathcal{S}_j := x_{n+j}\xi_j$ satisfies $\mathcal{S}_j \cdot \widetilde{F}^s = s_{j}\widetilde{F}^s$.
  Expand $P$ as a polynomials in $\xi_1,\ldots,\xi_p$
  $$P = \sum_{\alpha} P_\alpha \xi_{1}^{\alpha_1}\cdots \xi_{p}^{\alpha_p}$$
  where the coefficients $P_\alpha$ live in a stalk of $\O_{\mathcal{X}}\otimes_{\O_X}\D_X$.

  Let $N$ be greater than the maximal value of $\abs{\alpha}$ then
  $$(x_{n+1}\cdots x_{n+p})^N b \widetilde{F}^s = \left(\sum_{\alpha} \prod_{i=1}^p (s_i + 1)^{\alpha_i} \sum_\beta Q_{\alpha\beta} \partial_1^{\beta_1}\cdots \partial_n^{\beta_n} \right)\widetilde{F}^{s+1}$$
  where the $P_\alpha$ were expanded as polynomials in $\partial_1,\ldots,\partial_n$ with coefficients $Q_{\alpha\beta}$ from $\O_{\mathcal{X}}$.
  Observe that $\partial_1,\ldots, \partial_n$ act on the formal symbol $\widetilde{F}^{s+1}$ the same as they act on the formal symbol $F^{s+1}$.

  Now consider this functional equation on the analytification of $\mathcal{X}$ and expand the $Q_{\alpha\beta}$ as power series at $x$.
  Identifying powers of $x_{n+1}\cdots x_{n+p}$ on both sides a functional equation with analytical coefficients for $F^s$ follows.
  This establishes that $b \in B_{F,x}$ for any $x\in X$ provided analytical and algebraic Bernstein-Sato ideals are equal.\todo{Is this true?}
\end{proof}
Note that replacing $F$ by $\widetilde{F}$ leaves \cref{thm: EstimateBernsteinSatoZeroLocust} unchanged up to hyperplanes parallel to $\sum_{i=1}^p d_{ij}s_i = 0$.
These are not in $Z(B_F)$ by assumption so, by \cref{lem: ReplacementIsAllowed}, it remains to prove the theorem for $\widetilde{F}$.
For notational simplicity we simply write $F$ instead of $\widetilde{F}$.
\begin{lemma}\label{lem: CharVarEstimateW}
  The $\D_\mathcal{Y}$-module $\M\otimes_{\C[s]}\C[s]/L_{p-1}$ is coherent and it's characteristic variety satisfies $\Ch\M\otimes_{\C[s]}\C[s]/L_{p-1} \subseteq V \cup W $ where $V$ is isotropic and $W$ is a irreducible variety of dimension $\dim \mathcal{Y} +1$ which dominates $\mathcal{Y}$.
\end{lemma}
\begin{proof}
  Recall that we ensured that $\M$ is a coherent $\D_\mathcal{Y}$-module.
  Hence, also $\M\otimes_{\C[s]}\C[s]/L_{p-1}$ will be a coherent $\D_\mathcal{Y}$-module.

  Take local coordinates $z_1,\ldots,z_n,z_{n+1},\ldots,z_{n+p}$ on $\mathcal{Y}$ as in the proof of \cref{lem: BernsteinSatoPolynomialUpstairs}.
  This is to say that locally
  $$G^s \mu^*(dx) = v \prod_{i=1}^nu_i^{s_j}z_i^{\sum_{j=1}^p M_{ij}s_j + m_i}\prod_{i=1}^n z_{n+i}^{\sum_{j=1}^p d_{ij}s_j} dz.$$
  Let $s_0$ denote a new variable so that $\C[s]/L_{p-1}\cong \C[s_0]$.
  Then $\M\otimes_{\C[s_0]}R/L_{p-1}$ may be viewed as the $\D_\mathcal{Y}$-module which is locally generated by a formal symbol
  $$[G^s \mu^*(dx)] =v \prod_{i=1}^{2n} u_i^{A_i s_0 + a_i}z_i^{B_i s_0 + b_i} dz $$
  where $A_i,B_i,a_i,b_i$ are complex numbers and we set $u_{n+i}=1$.
  Moreover, since the linear functions $\sum_{j=1}^p d_{ij}s_j$ on the final terms in $G^s\mu^*(dx)$ formed a basis for the linear polynomials there will be at least one $B_{i+n}$ which is nonzero.

  Denote $w = v\prod_{i=1}^n u_i^{a_i}$ and consider for any $j=1,\ldots,n+p$ the operation of $w^{-1}\partial_j wz_j$ on the generator
  $$[G^s \mu^*(dx)]\cdot w^{-1}\partial_j w =((B_j s_0 + b_j)z_j^{-1} + \sum_{i=1}^{n} A_i s_0 u_i^{-1}\partial_j(u_i) )[G^s \mu^*(dx)].$$
  Recall that the $s_1,\ldots,s_n$ could be produced by acting with a vector field.
  Since $s_0$ is found with affine relations it follows that there exists some differential operator $\mathcal{S}_0$ of degree $1$ such that $s_0 [G^s \mu^*(dx)] = [G^s \mu^*(dx)]\cdot \mathcal{S}_0$.
  Now we get a well-defined surjection $\D_\mathcal{Y}/I \to \M\otimes_{\C[s]}\C[s]/L_{p-1}$ where $I$ denotes the right ideal generated by $w^{-1}\partial_j wz_j - b_j - \mathcal{S} h_i$ with $h_j = B_j + z_j\sum_{i=1}^n A_iu_i^{-1}\partial_j(u_i)$ for $j=1,\ldots, n+p$.

  Note that $ z_j\sum_{i=1}^n A_iu_i^{-1}\partial_j(u_i) = 0$ for $j>n$.
  Hence, the $h_{n+j}$ are complex scalars and they are not all zero since there exists a nonzero $B_{n+j}$.
  After renumbering we now have that $h_1 \in \C^\times$.
  Denoting $\zeta_j, \sigma_0$ for the elements of $\gr \D_\mathcal{X}$ which correspond to $\partial_j, \mathcal{S}_0$ respectively it holds that $\gr I$ contains $z_j \zeta_j - h_j \sigma_0$ for any $j=1,\ldots, n+p$.
  Then also $h_1z_j \zeta_j - h_jz_1 \zeta_1$ is in $\gr I$ for any $j=2,\ldots, n+p$.
  This yields the desired bound for the characteristic variety.
\end{proof}
\begin{lemma}\label{lem: QuotientsRelativeHolonomic}
  If the $\A_\mathcal{X}$-module $\Int\M/U$ has grade $\dim \mathcal{X}$ then the quotients $(\Int\M/\U)\otimes_{\C[s]} \C[s]/L_{i}$ are relative holonomic $\A_\mathcal{X}^{R/L_i}$-modules of grade $\dim\mathcal{X}$.
\end{lemma}
\begin{proof}
  This follows by induction on $i=0,\ldots,p$ using \cref{lem: NotBernsteinInjectiveAutomorphism} which is applicable since grade $\dim \mathcal{X}$ means that the Bernstein-Sato ideals of $\Int\M/\U \otimes_{\C[s]} \C[s]/L_{i-1}$ is the zero ideal by \cref{cor: AXRBehaviourGradesJAndChrel} and \cref{prop: ProjectionBernsteinSatoRelativeChar}.
\end{proof}
\begin{lemma}\label{lem: InjectiveEll}
  Any polynomial $b\in \C[s]$ which is not in $L_i$ induces a injective automorphisms on $\M \otimes_{\C[s]}\C[s]/L_i$.
\end{lemma}
\begin{lemma}\label{lem: GradeNPlusOne}
  The relative holonomic $\A_\mathcal{X}$-module $\Int\M/\U$ has grade $j(\Int\M/\U)\geq \dim \mathcal{X}+1$.
\end{lemma}
\begin{proof}
  Suppose that $\Int\M/\U$ has grade $\dim \mathcal{X}$.
  A contradiction will be derived by replacing $\Int\M/\U$ with a holonomic $\D_\mathcal{X}$-module.
  The first task is to understand how $\int^0(\M\otimes_{\C[s]}\C[s]/L_{p-1})$ relates to $(\Int\M)\otimes_{\C[s]}\C[s]/L_{p-1}$.

  Recall from \cref{lem: InjectiveEll} that $\ell_{i}$ is injective on $\M \otimes_{\C[s]} \C[s]/L_{i-1}$. This implies that
  $\ell_{i}\Int \M \otimes_{\C[s]} \C[s]/L_{i-1} = \int^0 \ell_{i}\M\otimes_{\C[s]} \C[s]/L_{i-1}.$
  The injective automorphisms of $\ell_i$ on $\M \otimes_{\C[s]} \C[s]/L_{i-1}$ induces a long exact sequence of $\A_X^{\C[s]/L_{i-1}}$-modules
  $$0 \to \int^0\left(\M \otimes_{\C[s]} \frac{\C[s]}{L_{i-1}}\right) \xrightarrow{\ell_i} \int^0 \left(\M \otimes_{\C[s]} \frac{\C[s]}{L_{i-1}}\right) \to \int^0\left(\M \otimes_{\C[s]} \frac{\C[s]}{L_{i}}\right) \to \cdots $$
  whence $(\Int \M\otimes_{\C[s]} \C[s]/L_{i-1})\otimes_{\C[s]} \C[s]/(\ell_{i})$ is a submodule of $\int^0(\M \otimes_{\C[s]} \C[s]/L_{i})$.
  The quotient is isomorphic to the kernel $K_i$ of $\ell_i$ on $\int^1(\M \otimes_{\C[s]} \C[s]/L_{i-1})$.


  Denote $R_{i+1}$ for the ideal $(\ell_{i+1},\ldots,\ell_{p-1})$. Applying a tensor product with $\C[s]/R_{i+1}$ to the inclusion $(\Int \M/L_{i-1}) \otimes_{\C[s]}\C[s]/(\ell_i)\hookrightarrow \int^0(\M\otimes_{\C[s]}\C[s]/L_i)$ yields a exact sequence
  $$\cdots \to \Tor_{\C[s]}^1\left(K_i, \frac{\C[s]}{R_{i+1}}\right) \to \left(\Int \M\otimes_{\C[s]}\frac{\C[s]}{L_{i-1}}\right) \otimes_{\C[s]}\frac{\C[s]}{R_{i}} \to \left(\Int\M\otimes_{\C[s]}\frac{\C[s]}{L_i}\right)\otimes_{\C[s]}\frac{\C[s]}{R_{i+1}}.$$

  We claim that the $\ell_i$ can be chosen so that $\Tor_{\scaleto{\A_\mathcal{X}^{\C[s]/L_i}}{7pt}}^1(K_i, \A_\mathcal{X}^{\C[s]/L_{p-1}})$ is a relative holonomic $\A_\mathcal{X}^{R/L_{p-1}}$-module of grade greater than or equal to $\dim\mathcal{X}+1$.
  Let's show how this suffices to finish the proof and prove this claim afterwards. \\

  That the grade of $\Tor_{\scaleto{\A_\mathcal{X}^{\C[s]/L_i}}{7pt}}^1(K_i, \A_\mathcal{X}^{\C[s]/L_{p-1}})$ is greater than or equal to $\dim \mathcal{X}+1$ means that the Bernstein-Sato ideal is not trivial.
  Equivalently, for any $i$, there exists a non-zero polynomial $b_i\in \C[s]/L_{p-1}$ which annihilates $\Tor_{\C[s]/L_{i} }^1(K_i, \C[s]/R_{i+1} ))$.
  The kernels of the automorphisms induced by $b_i^m$ form a increasing sequence inside the coherent $\A_X^{\C[s]/L_{p-1}}$-module $(\Int \M\otimes_{\C[s]}\C[s]/L_{i-1})\otimes_{\C[s]}\C[s]/R_{i}$.
  Such a increasing sequence must stabilise which means that we can pick $m_i$ sufficiently large so that $$\img \Tor_{\C[s]}^1\left(K_i, \frac{\C[s]}{R_{i+1}}\right)\bigcap b_i^{m_i}\left(\Int \M\otimes_{\C[s]}\frac{\C[s]}{L_{i-1}}\right)\otimes_{\C[s]}\frac{\C[s]}{R_{i}} = 0.$$
  Set $B = \prod_{i=0}^{p-2} b_i^{m_i}$ then we get injections
  $$\cdots \hookrightarrow B \left(\Int \M\otimes_{\C[s]}\frac{\C[s]}{L_{i-1}}\right) \otimes_{\C[s]}\frac{\C[s]}{R_{i}} \hookrightarrow B\left(\Int\M\otimes_{\C[s]}\frac{\C[s]}{L_i}\right)\otimes_{\C[s]}\frac{\C[s]}{R_{i+1}}\hookrightarrow  $$


  Since $\mu$ is proper the Kashiwara estimate is applicable and \cref{lem: RestrictionIsCoherentAndChar} yields that $\int^0(\M\otimes_{\C[s]} \C[s]/L_{p-1})$ is a coherent $\D_\mathcal{X}$-module with characteristic variety $\widetilde{\mu}\left((T^*\mu)^{-1}(V\cup W)\right)$.
  It follows that $B(\Int\M)\otimes_{\C[s]}\C[s]/L_{p-1}$ is a coherent $\D_\mathcal{X}$-module
  and
  $$ \Ch B \left(\left(\Int\M\right)\otimes_{\C[s]}\frac{\C[s]}{L_{p-1}}\right)\subseteq \mathcal{L} \cup \widetilde{\mu}\left((T^*\mu)^{-1}(V\cup W)\right).$$

  Now observe that $B(\Int\M/ \U)\otimes_{\C[s]}\C[s]/L_{p-1}$ is a quotient of $B(\Int\M) \otimes_{\C[s]} \C[s]/L_{p-1}$ with support in the divisor $D$.
  Hence, $B(\Int\M/ \U)\otimes_{\C[s]}\C[s]/L$ is a coherent $\D_\mathcal{X}$-module with
  $$\Ch\left( B\left(\Int\M/ \U\right)\otimes_{\C[s]}\C[s]/L_{p-1}) \right)\subseteq \mathcal{L} \cup \widetilde{\mu}\left((T^*\mu)^{-1}(V\cup W)\right) \cap \left(T^*\mathcal{X}\times_\mathcal{X} D\right).$$

  This means $B(\Int\M/ \U)\otimes_{\C[s]}\C[s]/L_{p-1}$ is a holonomic $\D_\mathcal{X}$-module.
  Indeed, by (\todo{Put somewhere in Chapter 1 \cite[proposition 4.9]{kashiwara1976b}.}) $\widetilde{\mu}((T^*\mu)^{-1}(V))$ remains isotropic and forms no obstruction to the characteristic variety being Lagrangian.
  Moreover, $\widetilde{\mu}((T^*\mu)^{-1}(W))$ is irreducible of dimension $\dim \mathcal{X}+1$ and dominates $\mathcal{X}$.
  Intersecting $\widetilde{\mu}((T^*\mu)^{-1}(W))$ with $T^*\mathcal{X}\times_\mathcal{X} D$ now reduces the dimension so that $\dim \Ch B(\Int\M/ \U)\otimes_{\C[s]}\C[s]/L_{p-1} \leq \dim \mathcal{X}$.
  This means that $B(\Int\M/ \U)\otimes_{\C[s]}\C[s]/L_{p-1}$ is holonomic.
  By (\todo{\cite{bjork1979rings} holonomic means $s$ is algebraic}) this means that it's Bernstein-Sato ideal is non-zero.
  But then also the Bernstein-Sato ideal of $(\Int\M/ \U)\otimes_{\C[s]}\C[s]/L_{p-1}$ is non-zero.
  This contradicts \cref{lem: QuotientsRelativeHolonomic} and we conclude that the assumption the grade is $\dim \mathcal{X}$ must have been wrong.\\

  It remains to show that the $\ell_j$ can be chosen so that $\Tor_{\scaleto{\A_\mathcal{X}^{\C[s]/L_i}}{7pt}}^1(K_i, \A_\mathcal{X}^{\C[s]/L_{p-1}})$ is a relative holonomic $\A_\mathcal{X}^{\C[s]/L_{p-1}}$-module of grade greater than or equal to $\dim \mathcal{X}+1$.
  By a taking a $\A_{\mathcal{X}}^{\C[s]/L_{i}}$-free resolution of $K_i$ one finds that
  $$\bR \Hom_{\scaleto{\A_\mathcal{X}^{ \C[s]/L_{p-1} }}{8pt} }(K_i\otimes^L_{\scaleto{ \A_\mathcal{X}^{\C[s]/L{i}} }{8pt} } \A_\mathcal{X}^{\C[s]/L_{p-1} },\A_\mathcal{X}^{ \C[s]/L_{p-1}} ) \cong \bR \Hom_{ \scaleto{\A_\mathcal{X}^{\C[s]/L_{i}}}{8pt} } (K_i,\A_\mathcal{X}^{\C[s]/L_{i}}) \otimes^L_{\scaleto{ \A_\mathcal{X}^{\C[s]/L_{i}}}{8pt} } \A_\mathcal{X}^{\C[s]/L_{p-1}}.$$
  We compare the Grothendieck spectral sequences of both sides.

  The spectral sequence on the left-hand-side has terms
  $$E_{pq}^2 = \Ext_{\scaleto{\A_\mathcal{X}^{\C[s]/L_{p-1}}}{8pt} }^p(\Tor^{-q}(K_i,\A_X^{\C[s]/L_{p-1}}),\A_\mathcal{X}^{\C[s]/L_{p-1}}).$$
  Since $\Tor^{-q}(K_i,\A_X^{\C[s]/L_{p-1}})$ is a relative holonomic $\A_X^{\C[s]/L_{p-1}}$-module these terms are only nonzero for $p=\dim \mathcal{X}$ or $p = \dim \mathcal{X}+1$.
  In particular, the spectral sequence degenerates at $E^2$.
  Note that the statement that $\Tor_{\scaleto{\A_\mathcal{X}^{\C[s]/L_i}}{7pt}}^1(K_i, \A_\mathcal{X}^{\C[s]/L_{p-1}})$ has grade greater than or equal to $\dim \mathcal{X}+1$ is equivalent to $E^2_{\dim\mathcal{X},-1} = 0$.
  %This term is $\dim\mathcal{X}$-pure.
  %Hence, it suffices to ensure that all terms on the right-hand-side with $p+q = \dim\mathcal{X}-1$ have grade greater at least $n+1$.

  The spectral sequence on the right-hand-side has terms
  $$E^2_{pq} = \Tor^{-q}_{\scaleto{ \A_\mathcal{X}^{\C[s]/L_{i}}}{8pt} }(\Ext^p_{ \scaleto{\A_\mathcal{X}^{\C[s]/L_{i}}}{8pt} } (K_i,\A_\mathcal{X}^{\C[s]/L_{i}}), \A_\mathcal{X}^{\C[s]/L_{p-1}}).$$
  The claim follows if we can ensure that that the terms with $p-q = \dim \mathcal{X} -1$ have grade at least $\dim \mathcal{X} + 1$. Since grades can only increase when restricting to a open and localisation is a exact functor this statement holds on $\mathcal{X}\times\C^p$ if and only if holds on $\mathcal{X}\times\Spec R$ for some open subset $\Spec R\subseteq \C^p$. \todo{Maybe add more explanation?}

  The $\ell_i$ and the open $\Spec R$ are constructed inductively by induction on $i$. In every step it is ensured that $\Ext^{n+j}_{ \scaleto{\A_\mathcal{X}^{R/L_{i}}}{8pt} }(K_i, \A_\mathcal{X}^{R/L_i})$ is $(n+j)$-Cohen-Macaulay over $\A_X^{R/L_i}$ or zero for every $j\geq 0$, $Z(L_i)\cap \Spec R \neq 0$
  and that $\ell_i$
  induces a injection on $\Ext^{n+j}_{ \scaleto{\A_\mathcal{X}^{R/L_{i}}}{8pt} }(K_k, \A_\mathcal{X}^{R/L_k}) \otimes_{\scaleto{\A_\mathcal{X}^{R/L_{k}}}{8pt}} \A_{R/L_{i-1}}$
  for every $j\geq 1$ and $k<i$.

  Take some arbitrary $\ell_1$ for the base-case and use \cref{lem: GradeToCMOverOpen} to find a open $\Spec R \subseteq \C^p$ such that $\Ext^{n+j}_{ \scaleto{\A_\mathcal{X}^{R/L_{1}}}{8pt} }(K_1, \A_\mathcal{X}^{R/L_1})$  is $(n+j)$-Cohen-Macaulay for every $j\geq 0$.
  This only requires removing components of codimension greater than or equal to $1$ of $\Spec \C[s]/L_1$ so $Z(L_1)\cap \Spec R = \Spec R/L_1$ is non-empty.
  The final property is vacuous for $i=1$.

  Now assume that $i>1$ and that $\ell_1,\ldots, \ell_{i-1}$ are already constructed.
  First let's ensure that $\ell_i$
  induces a injection on $\Ext^{n+j}_{ \scaleto{\A_\mathcal{X}^{R/L_{i}}}{8pt} }(K_k, \A_\mathcal{X}^{R/L_k}) \otimes_{\scaleto{\A_\mathcal{X}^{R/L_{k}}}{8pt}} \A_{R/L_{i-1}}$
  for every $j\geq 0$ and $k<i$.
  By iterative application of \cref{lem: CMLemmaBudur} it holds that $\Ext^{n+j}_{ \scaleto{\A_\mathcal{X}^{R/L_{i}}}{8pt} }(K_k, \A_\mathcal{X}^{R/L_k}) \otimes_{\scaleto{\A_\mathcal{X}^{R/L_{k}}}{8pt}} \A_{R/L_{i-1}}$
  is $(n+j)$-Cohen-Macaulay over $\A_\mathcal{X}^{L_{i-1}}$.
  Take $\ell_i$ so that the induduced element of $R/L_{i-1}$ is non-constant and does not vanish on any irreducible component of the Bernstein-Sato zero locust of $\Ext^{n+j}_{ \scaleto{\A_\mathcal{X}^{R/L_{i}}}{8pt} }(K_k, \A_\mathcal{X}^{R/L_k}) \otimes_{\scaleto{\A_\mathcal{X}^{R/L_{k}}}{8pt}} \A_{R/L_{i-1}}$.
  Then, by \cref{prop: NotBernsteinInjectiveAutomorphism} the desired injectivity follows.
  As before, \cref{lem: GradeToCMOverOpen} can be used to to find a open $\Spec R' \subseteq \Spec R$ such that $\Ext^{n+j}_{ \scaleto{\A_\mathcal{X}^{R/L_{1}}}{8pt} }(K_1, \A_\mathcal{X}^{R/L_1})$  is $(n+j)$-Cohen-Macaulay for every $j\geq 1$ and  $Z(L_1)\cap \Spec R' = \Spec R'/L_1$ is non-empty.
  Note that $\Spec R$ by $\Spec R'$ will conserve the induction hypothesis.
  This concludes the inductive construction of the $\ell_i$.

  We can now show that $E^2_{pq}$ has grade at least $\dim \mathcal{X}+1$ whenever $p-q = \dim \mathcal{X}-1$.
  Certainly, $E_{\dim \mathcal{X}-1,0}$ by \cref{lem: AXRBehaviourGradesJAndChrel}.
  It remains to show that $\Tor^{j}_{\scaleto{ \A_\mathcal{X}^{\C[s]/L_{i}}}{8pt} }(\Ext^{\dim\mathcal{X}-j-1}_{ \scaleto{\A_\mathcal{X}^{\C[s]/L_{i}}}{8pt} } (K_i,\A_\mathcal{X}^{\C[s]/L_{i}}), \A_\mathcal{X}^{\C[s]/L_{p-1}})$
  has grade at least $\dim \mathcal{X}+1$ for any $j\geq 1$.

  By the injectivity of $\ell_i$ on 
\end{proof}

The following lemma and it's proof are similar to the monovariate case which may be found in \cite[p246]{bjork1979rings}.
\begin{lemma}
  There is a morphism right $\A_\mathcal{X}^R$-modules $\U\to \A_\mathcal{X}^RF^s \otimes_{\O_\mathcal{X}}\Omega_\mathcal{X}$ sending $u$ to $F^sdx$.
\end{lemma}
\begin{proof}
   The resolution of singularities $\mathcal{Y}\to \mathcal{X}$ is a isomorphism on the complement of $\prod f_i = 0$. Hence, a isomorphism $\U = \Int \M \cong  \A_\mathcal{X}^RF^s  \otimes_{\O_\mathcal{X}}\Omega_\mathcal{X}$ holds outside of $\prod f_i = 0$.

  Pick some open set $V\subseteq \mathcal{X}$ we must show that whenever $uP = 0$ in $\U(V)$ it follows that $(F^s dx)P = 0$.
  Due to the isomorphism it is certainly the case that $(F^s dx) P = 0$ outside of $\prod f_i = 0$.
  Hence, the support of the coherent sheaf of $\O_V^R$-modules $\O_V^R (F^s dx) P $ lies in $\prod f_i = 0$.
  The Nullstellen Satz now yields that $(\prod f_i)^N (F^s dx) P  = 0$ for some sufficiently large $N\geq 0$.
  Note that $\prod f_i$ is a non-zero divisor of $(F^s\otimes_{\O_\mathcal{X}} \Omega_\mathcal{X})(V)$. Hence, it follows that $(F^s dx) P= 0$ on $V$ as desired.
\end{proof}
\newpage
\section{Old Stuff}
\subsection{Sketch}
\begin{enumerate}
  \item It holds that $\A_X G^s$ is relative holonomic. Hence also $G^s \otimes \Omega_Y$ is relative holonomic. In particular the module $\M$ spanned by $G^s \otimes \mu^*(dx)$ is relative holonomic.
  \item By Kashiwara's estimate $\Int \M$ is relative holonomic and this contains a global section $u$.
  \item There is a surjection $u\to f^s$.
  \item Goal: Given $b$ which annihilates $\M/t\M$ show $B(s) = \prod b(s + k)$ annihilates $u/tu$.
  \begin{itemize}
    \item Problem: the usual argument exploits that $\Int \M /u$ is finite length.
    \item Induction step: If $B(\lambda)$ annihilates $(u/tu)\otimes \frac{\C}{(\ell)}$ for generic $\ell$ then $B(\lambda)$ annihilates $u/tu$. This is subtle due to a lack of Nakayama. Argument may be similar to Budur and Robin paper 1.
    \item Will require Cohen-Macauley similarly to Nero and Robin paper 1.
  \end{itemize}
  \item In the final step of the induction we need to deduce that $B(s)$ annihilates $u/tu \otimes \frac{\C[s]}{L}$. The standard method comes down the following observations
  \begin{itemize}
    \item $b \Int \M \subseteq t\Int\M$
    \item $t^N\Int\M / u = 0$ for large $N$
    \item Hence $Bu \subseteq B\Int\M \subseteq t^{N+1}\Int \M \subseteq tu$
  \end{itemize}
  In the final step of the induction we get that $(\Int\M \otimes \frac{\C[s]}{L}) / \widetilde{u}$ is holonomic from which we can deduce $t^N \Int \M \otimes \frac{\C[s]}{L} / \widetilde{u} = 0$. But we actually need $t^N (\Int\M/ u) \otimes \frac{\C[s]}{L} = 0$
  \item To get this note
  \begin{itemize}
    \item The $SES$
    $$ 0 \to \ell \M \to \M \to \M \otimes \frac{\C[]}{(\ell)} \to 0$$
    yields
    $$0 \to \int^0  \ell \M \to \Int \M \to \Int \M \otimes \frac{\C[]}{(\ell)}\to \cdots$$
    \item Provided $\ell$ does not contain irreducible parts of $Z(B)$ the map $\ell$ is injective upstairs by lemma 3.4.2 in paper 1 Nero and Robin so
    $$(\Int \M )\otimes \frac{\C[]}{\ell} \hookrightarrow \int^0 (\M \otimes \frac{\C[]}{(\ell)}) $$
  \end{itemize}
  \item Now
  $$0 \to u \to \Int \M \to \frac{\Int \M}{u} \to 0 $$
  induces
  $$\begin{tikzcd}
    Tor\arrow{r} & u\otimes \frac{\C[s]}{\ell}\arrow{r}\arrow{rd} & (\Int \M) \otimes \frac{\C[s]}{\ell}\arrow{r}\arrow[hookrightarrow]{d} & \frac{\Int \M}{u} \otimes \frac{\C[s]}{\ell}\arrow{r} & 0\\
    & & \Int \M \otimes \frac{\C[s]}{\ell}
  \end{tikzcd} $$
  \end{enumerate}

\chapter{$\D_X$-modules}\label{Ch: ChapterDX}
The goal of this chapter is to summarise some of the results and definitions which are common knowledge in the field of $\D_X$-modules.

The basic definitions of $\D_X$-module theory are given in \cref{sec: SheafOfDiff}.
The theory builds up to the Riemann-Hilbert correspondence in \cref{sec: Riemann-Hilbert} which states in general terms that a system of differential equations is equivalent to its solutions.
This result is powerful because it yields a connection between algebraic geometry and topology.
A particular instantiation of this correspondence is the connection between Bernstein-Sato polynomials and monodromy discussed in \cref{sec: MonodromyBS}.
Finally, we include the estimation of the roots of Bernstein-Sato polynomials due to Kashiwara and Lichtin.

Detailed treatments of the theory of $\D_X$-modules in the analytic case may be found in  \cite{bjork1979rings} and \cite{kashiwara2003d}. 
The canonical reference for the algebraic case is \cite{borel1987algebraic}. 
There is also a more recent textbook on the algebraic case by \cite{hotta2007d}.
\section{Sheaf of differential operators}\label{sec: SheafOfDiff}
Let $X$ denote a smooth algebraic variety or a complex manifold.
\begin{definition}
  The {\it sheaf of differential operators} $\D_X$ is the subsheaf of rings in $\mathcal{E}nd_{\C}(\O_X)$ generated by $\O_X$ and the vector fields $\Theta_X$.
\end{definition}
Observe that $\D_X$ is a sheaf of non-commutative rings.
Given local coordinates $x_1,\ldots, x_n$ on $X$ it holds that
$$\partial_i x_j - x_j\partial_i = \delta_{ij} $$
where $\partial_i= \frac{d}{dx_i}$ and $\delta$ denotes the Kronecker delta.
\begin{lemma}{\cite[Proposition 1.4.6., Theorem 4.1.2]{hotta2007d}}
  For any $x\in X$ the stalk $\D_{X,x}$ is left and right Noetherian. Moreover, in the algebraic case $\D_X$ is a left and right Noetherian sheaf of rings.
\end{lemma}
Giving a left $\D_X$-module is equivalent to giving a $\O_X$-module $\M$ with $\Theta_X$-action such that
$\xi\cdot (fm) = f (\xi \cdot m)  + \xi(f)\ m  $
for any sections $f$ of $\O_X$ and $\xi$ of $\Theta_X$. Similarly, giving a right $\D_X$-module is equivalent to giving a $\O_X$-module $\M$ with $\Theta_X$-action such that
$(mf)\cdot\xi = (m\cdot\xi)f - m\ \xi(f) $ for any sections $f$ of $\O_X$ and $\xi$ of $\Theta_X$.

Translation between left and right-modules is possible.
Denote $\omega_X$ for the sheaf of top-level differential forms.
Then $\omega_X$ comes equipped with the structure of a right $\D_X$-module where vector fields act by the Lie derivative.

For any left $\D_X$-module $\M$ a right $\D_X$-module structure on $\M\otimes_{\O_X}\omega_X$ may be defined by
$$m\otimes \omega \cdot \xi = m\otimes \omega\xi - \xi m \otimes \omega.$$
For any right $\D_X$-module $\M$ a left $\D_X$-module structure on $\Hom_{\O_X}(\omega_X, \M)$ may be defined by
$$(\xi\cdot \varphi)(\omega) = \varphi(\omega \cdot \xi) - \varphi(\omega)\cdot \xi. $$
The next lemma follows by a direct computation.
\begin{lemma}\label{lem: EquivalencLeftRight}
  The functor $\blank\otimes_{\O_X}\omega_X$ is an equivalence of categories with pseudoinverse  $\Hom_{\O_X}(\omega_X,\blank)$.
\end{lemma}
\begin{example}\label{ex: Solutions}
  Consider the differential equation defining the square root function $f(z)= z^{-1/2}$
  $$zf'(z) -1/2f(z) = 0.$$
  The use of $f$ to describe the differential equation is somewhat arbitrary.
  For instance take $g(z) = \exp(z)f(z)$ which satisfies the differential equation
  $$2z g'(z) -(2z + 1)g(z) = 0.$$
  The statement that non-trivial solutions of the differential equation for $f(z)$ can not be global on $\C^\times$ is equivalent to the same statement for the solutions to the differential equation for $g(z)$.

  Thus one is led to the following question.
  Is it possible to present a differential equation without having to make some arbitrary choice of function $f$ to describe it?
  This can indeed be accomplished by use of $\D_X$-modules.

  In the current example one should consider the analytic left $\D_{\C}$-module $\M$ which occurs as cokernel of the map
  $$P:\D_{\C} \to \D_{\C}: Q \mapsto  Q(z\partial_x -1/2).$$
  The solutions are then encoded in the sheaf $\Hom_{\D_\C}(\M,\O_\C)$.
\end{example}
\begin{remark}\label{rem: Solutions}
  More generally than the foregoing example for a system of differential equations
  $$\sum_{j=1}^k P_{ij}(x,\partial) f_j = 0; \qquad i= 1,\ldots,m$$
  with unknown functions $f_j$ on $X$ and differential operators $P_{ij}\in \D_X(X)$
  one can consider the cokernel $\M$ of the map
  $$P:\D_X^k \to \D_X^m : \left(Q_1,\ldots, Q_k\right) \mapsto \left(\ldots, \sum_{j=1}^k Q_j P_{ij},\ldots\right).$$
  The solutions in a left $\D_X$-module $\N$ are encoded by $\Hom_{\D_X}(\M,\N)$.
\end{remark}
\begin{example}\label{ex: fs}
  This example is essential in the study of Bernstein-Sato equations.
  Let $f\in \O_X(X)$ be some global section and introduce a new variable $s$.
  The free $\C[x,f^{-1}]$-module $\C[x,f^{-1}]f^s$ is equipped with the structure of left $\D_X$-module by setting
  $$\xi f^s = s \xi(f)f^{-1}f^{s}$$
  for any section $\xi$ of $\Theta_X$.
  One denotes $\D_Xf^s$ for the $\D_X$-submodule generated by $f^s$.
\end{example}
\subsection{Filtrations}
The non-commutativity of the sheaf of differential operators exits the typical domain of algebraic geometry.
This can be resolved by consideration of a graded structure.
The essential observation is that differential operators commute up to an element of lower order.
\begin{definition}
  The {\it order filtration} on $\D_X$ is defined inductively to be given by the sheaves of $\O_X$-submodules $F_i \D_X$ such that $F_0\D_X = \O_X$ and $F_i\D_X$ is maximal with $[F_i\D_X, F_i \D_X] \subseteq F_{i-1}\D_X$.
\end{definition}
The term $F_i \D_X$ in the order filtration can be described as containing all differential operators of order less than or equal to $i$.
Indeed, given local coordinates $x_1,\ldots, x_n$ one can see that $F_i\D_X$ is the $\O_X$-module which is locally generated by $\partial^\alpha = \partial_1^{\alpha_1}\cdots \partial_n^{\alpha_n}$ where $\alpha\in \mathbb{Z}_{\geq 0}^n$ is a multi-index with $\abs{\alpha} := \sum_{i}\alpha_i\leq i$.
The following observations are immediate.
\begin{lemma}
  The $F_i\D_X$ are coherent $\O_X$-modules and form an exhaustive filtration. This is to say that $\cup_{i\geq 0}F_i\D_X = \D_X$
  and that for any $i,j\geq 0$ it holds that $F_i\D_X \cdot F_j \D_X \subseteq F_{i+j}\D_X$.
\end{lemma}
One denotes $\gr \D_X = \oplus_{i\geq 0}F^i\D_X/F_{i-1}\D_X$ for the induced graded sheaf of rings.
Observe that $\gr\D_X$ is commutative by definition of the order filtration.

Let $\pi:T^*X \to X$ be the projection map.
It is known that $\gr\D_X \cong \pi_*\O_{T^*X}$ \cite[Section 2.1]{hotta2007d}.
The symplectic structure of $T^* X$ captures part of the non-commutativity.
Indeed, consider two differential operators $P, Q$.
Pick local coordinates $x_1,\ldots, x_n$ and decompose $P = \sum_{\alpha} p_\alpha \partial^\alpha $ and $Q = \sum_{\beta} q_\beta \partial^\beta$.
Let $m_1,m_2$ be the maximal values of $\abs{\alpha}$ and $\abs{\beta}$ with non-zero coefficients.
Then the induced elements of $P$ and $Q$ in $\gr \D_X$ are of the form $p = \sum_{\abs{\alpha} = m_1} p_\alpha \xi^\alpha$ and $q = \sum_{\abs{\beta} = m_2}q_\beta \xi^\beta $ where $\xi_i$ is the induced element in $\gr\D_X$ of $\partial_i$.
On the other hand, the induced element of $PQ - QP$ is $\sum_{i=1}^n\frac{\partial p}{\partial \xi_i}\frac{\partial q}{\partial x_i} - \frac{\partial q}{\partial \xi_i}\frac{\partial p}{\partial x_i}$.
This is precisely $\{p,q\}$ where $\{\blank,\blank\}$ is the Poisson bracket.


There is a similar notion of filtrations on $\D_X$-modules $\M$.
Assume that $\M$ is a left $\D_X$-module, the case for right modules is analogous.
A {\it filtration} consists of an increasing sequence of quasi-coherent $\O_X$-submodules $F_i\M$ of $\M$ such that $\cup_i F_i \M = \M$ and $F_i\D_X \cdot F_j\M \subseteq F_{i+j}\M$ where $i$ runs over $\mathbb{Z}_{\geq 0}$.
The graded objects $\gr\M = \oplus_{i\geq 0} F_i\M/F_{i-1}\M$ are $\gr\D_X$-modules.

The $\gr\D_X$-module $\gr\M$ has a corresponding module on $T^* X$ defined by $\O_{T^*X} \otimes_{\pi^{-1}\gr \D_X} \pi^{^-1}\gr\M$.
By abuse of notation this module is still denoted $\gr\M$ and it will always be implicitly assumed that $\gr \D_X$-modules live on $T^*X$ unless it is explicitly mentioned otherwise.
\begin{proposition}{\cite[Theorem 2.1.3., Section 4.1 ]{hotta2007d}}\label{prop: GoodFiltration}
  A $\D_X$-module $\M$ is coherent if and only if it locally admits a filtration such that $\gr \M$ is a coherent $\gr \D_X$-module. Such a filtration is called a {\it good filtration}.
  In the algebraic case the filtration can be taken globally.
\end{proposition}
\begin{proposition}{\cite[Theorem 2.2.1.]{hotta2007d}}
  Let $\M$ be a coherent $\D_X$-module, then the support of $\gr\M$ in $T^* X$ is an independent of the chosen good filtration.
  It is called the {\it characteristic variety} of $\M$ and denoted $\Ch \M$.
\end{proposition}
\begin{proposition}{\cite[Theorem 2.3.1,  2]{hotta2007d}}\label{prop: StructureChVar}
  Let $\M$ be a coherent $\D_X$-module, then $\Ch \M$ is a homogeneous and involutive closed subset of $T^* X$.
\end{proposition}
\begin{remark}
  The characteristic variety corresponds to the so-called method of characteristics in the classical study of partial differential equations.
  This method allows one to use the characteristic variety to determine qualitative properties such as the propagation of shock waves.

  Further relations between characteristic varieties and the properties of differential equations are made precise in the study of microlocal analysis.
\end{remark}
Characteristic varieties behave well with respect to quotients and submodules.
\begin{proposition}\label{prop: SESBehaviourChar}
  Consider a short exact sequence of coherent $\D_X$-modules
  $$0 \to \M_1 \to \M_2 \to \M_3 \to 0 $$
  then it holds that
  $$\Ch \M_2 = \Ch \M_1 \cup \Ch \M_3. $$
\end{proposition}
\begin{proof}
  A good filtration on $\M_2$ induces good filtrations on $\M_1$ and $\M_3$ and one has a short exact sequence
  $$0\to \gr \M_1 \to \gr \M_2 \to \gr \M_3 \to 0 $$
  whence the result follows.
\end{proof}
The characteristic variety corresponding to the $\D_X$-module in \Cref{ex: fs} is understood and may provide some intuition for general characteristic varieties.
\begin{proposition}{{\cite[Theorem 5.3]{kashiwara1976b}}}\label{prop: Charfs}
  The characteristic variety of the coherent $\D_X$-module $\D_Xf^s$ is the closure of
  $$W_f = \{(x,sf^{-1}(x)df(x)); \qquad f(x)\neq 0,\quad s\in \C \}$$
  in $T^*X$.
\end{proposition}
The following result follows from \Cref{prop: Charfs} by establishing that the part of the closure of $W_f$ above $f=0$ is isotropic.
\begin{proposition}{{\cite[Proposition 5.6]{kashiwara1976b}}}\label{prop: IsotropicAndDominate}
  One can write $\Ch \D_X f^s = \Lambda \cup W$ for some isotropic variety $\Lambda \subseteq T^*X$ and an irreducible $(n+1)$-dimensional variety $W$ which dominates $X$.
\end{proposition}
\subsection{Direct image}
In this section we describe the direct image of $\D_Y$-modules.
Let $\mu:Y\to X$ be a morphism of smooth algebraic varieties or complex manifolds.

A-priori, it is not even clear what $\D_X$-module should correspond to $\D_Y$.
This issue may be resolved by use of the {\it transfer $(\D_Y,\mu^{-1}\D_X)$-bimodule} $\D_{Y\to X}:= \O_Y \otimes_{\mu^{-1}\O_X}\mu^{-1}\D_X$.
Here, the right $\mu^{-1}\D_X$-module structure is just the action on the second component and the left $\D_Y$-module structure is defined by
$$f\cdot (g\otimes \mu^{-1}h) = fg \otimes \mu^{-1}h; \qquad \xi\cdot (g\otimes\mu^{-1}h) = \xi g \otimes \mu^{-1}h + g \otimes T\mu(\xi)\mu^{-1}h $$
for any sections $f$ of $\O_Y$ and $\xi$ of $\Theta_Y$.
Here $T\mu(\xi)$ is a local section of $\O_Y\otimes_{\mu^{-1}\O_X} \mu^{-1}\Theta_X$.
\begin{example}
  If $\mu:\C^2 \to \C:(x,y)\mapsto x$ is the projection map then sections of $\D_{\C^2\to \C }$ may be identified with finite sums of the form $\sum_{j=0}^n f_j(x,y)\partial_x^j$ where $f_j(x,y)$ are sections of $\O_{\C^2}$.
  The left $\D_{\C^2}$-module structure is such that
  $$\partial_y \cdot f\partial_x^j = \partial_{y}(f)\partial_x^j;\qquad \partial_x\cdot f\partial_{x}^j = \partial_x(f)\partial_x^j + f \partial_x^{j+1}.$$
\end{example}
\begin{example}
  If $\mu:\C \to \C^2: y \mapsto (0,y)$ is the inclusion then sections of $\D_{\C\to \C^2}$ may be identified with finite sums of the form $\sum f_{ij}(x,y)\partial_x^i \partial_y^j$ with $f_{ij}(x,y)$ sections of $\O_{\C^2}$ defined in a neighbourhood of the axis defined by $x=0$.
  The left $\D_{\C}$-module structure is such that
  $$
    \partial_y \cdot f\partial_x^i\partial_y^j = \partial_{y}(f)\partial_x^i\partial_y^j + f \partial_x^i\partial_y^{j+1}.
  $$
\end{example}
\begin{definition}
  The {\it direct image functor} $\int_\mu:D^{b,r}(\D_Y)\to D^{b,r}(\D_X)$ is given by $R\mu_* (\blank\otimes_{\D_Y}^L \D_{Y\to X})$.
  For any $\D_Y$ module $\M$ the $j$-th direct image is the $\D_X$-module $\int_\mu^j \M = H^j \int_\mu \M$.
  The subscript $\mu$ will be suppressed whenever there is no ambiguity.
\end{definition}
\begin{remark}\label{rem: Spencer}
  An explicit free resolution for the transfer module is known.
  This involves the Spencer complex $\Sp_Y^\bullet(\M)$ of a $\D_Y$-module $\M$ with $\Sp_Y^{-k}(\M) = \M\otimes_{\O_Y}\wedge^k \Theta_Y$.
  The details may be found in \cite{sabbah2011introduction}.
\end{remark}
\begin{remark}
  A direct image functor for left $\D_Y$-modules is induced as  $$\int\M := R\Hom_{\O_X}\left(\omega_X,\int (\M\otimes_{\O_Y} \omega_Y)\right).$$
\end{remark}
The definition for the direct image functor is somewhat subtle due to passing through derived categories but many desirable properties follow.
Most notably, it is immediate from the derived definition that one gets a long exact sequence.
\begin{proposition}
    For any short exact sequence of $\D_Y$-modules
    $$0 \to \M_1 \to \M_2 \to \M_3 \to 0 $$
    there is a long exact sequence of $\D_X$-modules
    $$0 \to \IntJ{0}\M_1 \to\IntJ{0} \M_2 \to \IntJ{0} \M_3 \to \IntJ{1} \M_1 \to \cdots.$$
\end{proposition}
\begin{proposition}{\cite[Chapter VI, Section 5]{borel1987algebraic}}
  Let $\mu:Z\to Y$ and $\nu:Y\to X$ be a morphisms of smooth varieties.
  Then there is an isomorphism of functors $\int_{\nu\circ \mu} \cong \int_\nu \int_\mu$.
\end{proposition}
A similar theorem applies to complex manifolds provided $\mu$ is proper \cite[Theorem 3.3.6]{sabbah2011introduction}.
Denote $D_{coh}^{*,*}(\D_X)$ for the full subcategory of $D^{*,*}(\D_X)$ consisting of the objects with coherent cohomology.
The coherence properties of the direct image in the analytic case require the following notion.
\begin{definition}
  A $\D_Y$-module $\M$ is said to be {\it $\mu$-good} if there exists an open cover $\{V_j\}_{j\in J}$ of $X$ such that $\M$ admits a good filtration on $\mu^{-1}(V_j)$ for any $j\in J$.
\end{definition}
Note that, by \Cref{prop: GoodFiltration}, any coherent $\D_Y$-module on an algebraic variety is $\mu$-good.
\begin{theorem}{\cite[Theorem 3.4.1.]{sabbah2011introduction}}\label{thm: MuGoodCoherent}
  Let $\M$ be a $\mu$-good $\D_Y$-module and suppose that $\mu$ is proper on the support of $\M$.
  Then, $\int \M$ has coherent cohomology.
\end{theorem}
%Consider the following cotangent diagram.
%$$
%\begin{tikzcd}
%    & \mu^* T^* X\arrow[swap]{ld}{T^* \mu} \arrow{rd}{\widetilde{\mu}} & \\
%    T^* Y & & T^*X
%\end{tikzcd}
%$$
%\begin{proposition}{\cite[Theorem 3.4.1.]{sabbah2011introduction}}\label{prop: EstimateProper}
%  Let $\M$ be a $\mu$-good $\D_Y$-module and suppose that $\mu$ is proper on the support of $\M$. Then, for any $j\geq 0$
%  $$\Ch\left(\IntJ{j} \M \right)\subseteq  \widetilde{\mu}\left((T^*\mu)^{-1}(\Ch \M) \right).$$
%\end{proposition}
\section{Riemann-Hilbert correspondence}\label{sec: Riemann-Hilbert}
This section concerns the Riemann-Hilbert correspondence which states that a system of differential equations is equivalent to its system of solutions.
The systems of differential equations are encoded in regular holonomic $\D_X$-modules.
The solutions are given by perverse sheaves.
\subsection{Holonomic modules}
A particularly nice class of $\D_X$-modules are given by maximally overdetermined systems of differential equations.
This is to say that there are many relations for $\M$ or equivalently that $\Ch\M$ is small.
Observe that the involutive part of \Cref{prop: StructureChVar} implies that $\dim \Ch\M \geq n$ for any coherent $\D_X$-module $\M$.
\begin{definition}
  A coherent $\D_X$-module $\M$ is called {\it holonomic} if
  $\dim \Ch \M  = n.$
\end{definition}
The full subcategory of $D^{*,*}(\D_X)$ consisting of complexes with holonomic cohomology is denoted $D_h^{*,*}(\D_X)$.
For technical purposes it is mostly important that holonomic modules have finiteness properties.
\begin{proposition}{\cite[Proposition 4.42]{kashiwara2003d}}\label{prop: FiniteLength}
  Let $\M$ be a holonomic $\D_X$-module. Then, for any $x\in X$, the stalk $\M_x$ is a $\D_{X,x}$-module of finite length.
\end{proposition}
\begin{proposition}{\cite[Chapter 5, Proposition 9.2]{bjork1979rings}}\label{prop: HomAlgebraic}
  Let $\M$ be a holonomic $\D_X$-module.
  Then $\Hom_{\D_X}(\M,\M)$ is $\C$-algebraic.
  This is to say that for any $\varphi \in\Hom_{\D_X}(\M,\M) $ there exists some polynomial $b$ with coefficients in $\C$ such that $b(\varphi)=0$.
\end{proposition}
\subsubsection{Holonomicity and direct images}
The goal of this section is to show that the direct image functor preserves holonomicity.
Let $\mu:Y\to X$ be a proper morphism.
Given a coherent right $\D_X$-module $\M$ with characteristic variety $\Ch \M$.
We must estimate $\Ch \IntJ{j} \M$ in terms of $\Ch\M$.

The original proof by \cite{kashiwara1976b} uses the theory of microlocal differential operators.
The idea of the following proof is due to \cite{malgrange1985images} in a $K$-theoretic context.
We follow the exposition of \cite{sabbah2011introduction}.
For the sake of notational simplicity we assume that $\mu$ is a morphism of varieties, the analytic case is similar and may be found in {\it loc. cit.}
 %We note that the assumption that $\mu$ is proper can be relaxed but this version will suffice for our purposes.
\\

Consider the following cotangent diagram
$$
\begin{tikzcd}
    & \mu^* T^* X \arrow[swap]{ld}{T^* \mu} \arrow{rd}{\widetilde{\mu}} & \\
    T^* Y & & T^*X
\end{tikzcd}
$$
The first step is to note that the behaviour of $\gr \D_Y$-modules is easy to understand.
The direct image of a right $\gr \D_Y$-module $\mathcal{M}$ is defined by $\int \mathcal{M} :=  R\widetilde{\mu}_* ( L(T^*\mu)^*\mathcal{M}).$
%Here, $(T^*\mu)^*(\blank)$ produces a sheaf on $\mu^*T^*X$ by $ \blank\otimes_{\mu^{-1}\O_X} \gr \D_X$.
Looking at the supports the following result is immediate.
\begin{lemma}\label{lem: GrKashiwara}
    For any $\gr\D_Y$-module $\mathcal{M}$ it holds that
    $$\supp \int^j \mathcal{M}\subseteq \widetilde{\mu}\left((T^* \mu)^{-1} \supp \mathcal{M}\right).$$
\end{lemma}
Applying this lemma to $\gr\M$ it remains to show that $\supp\gr\IntJ{j}\M\subseteq \supp\int^j \gr\M$ for some good filtration on $\IntJ{j}\M$.
This is proved in \Cref{prop: SuppGrrelIntInclusion}.
The main technical ingredient in the proof is the Rees module associated to a filtered $\D_Y$-module $\M$.
\begin{definition}
    Let $\rho$ be a new variable. The {\it Rees sheaf of rings} $\Rees\D_Y$ is defined as the subsheaf $\oplus_{j\geq 0} F_j \D_Y \rho^j $ of $\D_Y \otimes_\C \C[\rho]$.
    Similarly, any filtered $\D_Y$-module $\M$ gives rise to a $\Rees\D_Y$-module $\Rrel\M := \oplus_{j\geq 0} F_j \M \rho^j$.
\end{definition}
Given a coherent $\D_Y$-module $\M$ with a good filtration it follows that $\Rrel\M$ is a coherent $\Rees\D_Y$-module.% similarly to \Cref{prop: CoherentAndGoodFiltration}.
The following isomorphisms of filtered modules on $Y$ are essential.
They mean that the Rees module can be viewed as a parametrisation of various relevant modules.
$$\frac{\Rrel\M}{(\rho-1)\Rrel\M} \cong \M; \qquad \frac{\Rrel\M}{\rho\Rrel\M} \cong \gr \M;\qquad \frac{\Rrel\M}{\rho^\ell\Rrel\M} \cong  \grl\M.$$
Here $\grl\M = \oplus_k F_{k}\M/F_{k-\ell}\M$ is a $\grl \D_X$-module.
The first formula may be be used to find a corresponding filtered $\D_Y$-module for any graded $\Rees\D_Y$-module without $\C[\rho]$-torsion.

The direct image of a $\Rees\D_Y$-module $\mathcal{M}$ is defined by $\int \mathcal{M} = R^j\mu_*(\mathcal{M}\otimes^L_{\Rees \D_Y} \Rrel \D_{Y\to X})$.
Here the filtration on $\D_{Y\to X}$ is defined by $F_i\D_{Y\to X} =\O_{Y} \otimes_{\mu^{-1}\O_X}\mu^{-1}F_i\D_X $.
Coherence is preserved similarly to \Cref{thm: MuGoodCoherent}.

The direct image may be restricted to the category of graded Rees modules.
Note that we now have multiple notions of direct images for modules over $\D_Y$ and $\gr\D_Y$.
The Rees module viewpoint agrees with the earlier definitions by the following lemma.
\begin{lemma}\label{lem: ReesAndOtherDirectImagesAgree}
  Consider a filtered right $\D_Y$-module $\M$.
  Then viewing $\int^j \Rrel\M / \rho\Rrel\M$ with its $\gr\D_X$-module structure as a sheaf on $T^*X$ recovers the $\gr\D_Y$-module direct image $\int^j \gr\M$.
  Viewing  $\int^j \Rrel\M / (\rho-1)\M$ as a $\D_X$-module recovers $\IntJ{j} \M$.
\end{lemma}
\begin{proof}
  We give the proof for $\int^j \gr \M$, the proof for $\IntJ{j} \M$ is similar but easier.
  Consider the following Cartesian square
  $$
      \begin{tikzcd}
        \mu^*T^* X \arrow{r}{T^*\mu} \arrow{d}{{\widetilde{\mu}}} &T^*Y \arrow{r}{\pi_Y} & Y\arrow{d}{\mu} \\
        T^*X\arrow{rr}{\pi_X}  && X.
      \end{tikzcd}
  $$
  The derived version of the flat base change theorem \cite[Chapter 4, Proposition 3.1.0]{berthelot2006theorie}  yields that
  $$L\pi_X^*R\mu_*\left(\frac{\Rrel\M}{\rho\Rrel \M}\otimes^L_{\Rrel\D_Y}\Rrel \D_{Y\to X}\right)\cong  R\widetilde{\mu}_*L(T^*\mu)^*L(\pi_Y)^*\left(\frac{\Rrel\M}{\rho\Rrel \M}\otimes^L_{\Rrel\D_Y}\Rrel \D_{Y\to X}\right).$$
  Since $\pi_X$ is flat it follows that $H^j L\pi_X^*(R\mu_* \blank) = \pi_X^*(R^j\mu_*\blank)$.

  It now suffices to show that the right hand of the isomorphism is $\int \gr\M$.
  First observe that, using \Cref{rem: Spencer}, one can take a resolution $\F^\bullet$ for $\Rrel \D_{Y\to X}$ by free left $\Rees\D_Y$-modules such that $ (\Rees \D_{Y} / \rho\Rees \D_{Y})\otimes_{\Rees \D_Y}\F^\bullet$ is a resolution for $\gr \D_{Y\to X}$ by free $\gr\D_Y$-modules.
  By use of this free resolution one sees that
  $$ \frac{\Rrel\M}{\rho\Rrel \M}\otimes^L_{\Rrel\D_Y}\Rrel \D_{Y\to X} \cong \frac{\Rrel\M}{\rho\Rrel \M} \otimes^L_{\Rrel\D_Y}\frac{\Rrel \D_{Y\to X}}{\rho\Rrel \D_{Y\to X}}.$$
  Note that $L\pi_Y^*$ involves taking a tensor product with $\O_{T^*Y}$ so that we get
  $$L\pi_Y^*\left( \frac{\Rrel\M}{\rho\Rrel \M}\otimes^L_{\Rrel\D_Y} \Rrel \D_{Y\to X}\right) \cong \gr\M \otimes_{\O_{T^*Y}}^L \left( \O_{T^*Y}\otimes_{(\mu\circ \pi_Y)^{-1}\O_X}(\mu\circ\pi_Y)^{-1}(\gr\D_X)\right).$$
  Finally observe that $\O_{\mu^*T^*X} \cong \widetilde{\mu}^*\gr\D_X$.
  This means that the term $\gr\M$ is being tensored with in the above formula is already implicit in $L(T^*\mu)^*$.
  This is to say that
  $$L(T^*\mu)^*L\pi_Y^*\left( \frac{\Rrel\M}{\rho\Rrel \M}\otimes^L_{\Rrel\D_Y} \Rrel \D_{Y\to X}\right) \cong L(T^*\mu)^*\left(\gr\M\right)$$
  which yields the desired result.
\end{proof}
It turns out that one can directly compare $\grl\IntJ{j}\M$ and $\int^j \grl\M$ when $\ell$ is large.
Some care is required since since $\int^j \Rrel \M$ may have $\C[\rho]$-torsion.
\begin{lemma}\label{lem: KernelZellStabilises}
  Consider a $\D_Y$-module $\M$ with a good filtration.
  Then, for sufficiently large $\ell$, the kernel of $\rho^\ell$ in $\int^j \Rrel \M$ stabilises.
  For such $\ell$ the quotient $\int^j \Rrel \M/ \ker \rho^\ell$ is the $\Rees \D_X$-coherent module associated to a good filtration on $\IntJ{j} \M$.
\end{lemma}
\begin{proof}
  By $\int^j \Rrel \M$ being coherent over the sheaf of Noetherian rings $\Rees\D_X$ it follows that $\ker \rho^\ell$ stabilises.

    Now consider the short exact sequence $0\to \Rrel \M \xrightarrow{\rho-1} \Rrel \M \to \M \to 0$. This induces a long exact sequence
    $$\cdots \to \int^j \Rrel \M \xrightarrow{\rho-1} \int^j \Rrel \M \to \IntJ{j} \M \to \int^{j+1} \Rrel \M \xrightarrow{\rho-1}\cdots. $$
    Since $\int^{j+1} \Rrel \M$ is a graded $\Rees\D_X$-module it follows that $\rho-1$ is injective whence $\int^j \Rrel \M / (\rho-1)\int^j \Rrel \M \cong \IntJ{j} \M$. This yields the desired result using that $\int^j \Rrel \M / \ker \rho^\ell$ is $\C[\rho]$-torsion free and the isomorphism
    $$ \frac{\int^j \Rrel \M }{(\rho-1)\int^j \Rrel \M } \cong \frac{\int^j \Rrel \M /\ker \rho^\ell }{(\rho-1)(\int^j \Rrel \M/\ker \rho^\ell) }.$$
\end{proof}
From now on we equip $\IntJ{j} \M$ with the good filtration inherited from the Rees module's direct image.
\begin{lemma}\label{lem: EllLargeSubquotent}
    Consider a $\D_Y$-module $\M$ with a good filtration.
    Then, if $\ell$ is sufficiently large, $\grl \IntJ{j}\M$ is a subquotient of $\int^j\grl\M$.
\end{lemma}
\begin{proof}
  The short exact sequence $0\to \Rrel\M \xrightarrow{\rho^\ell}\Rrel \M \to \Rrel\M / \rho^\ell \Rrel\M \to 0$ induces a long exact sequence
  $$\cdots \to \int^j \Rrel \M \xrightarrow{\rho^\ell} \int^j \Rrel \M \to \int^j \Rrel\M/\rho^\ell \Rrel\M \to \int^{j+1} \Rrel \M \xrightarrow{\rho^\ell}\cdots. $$
  Hence, $\int^j \Rrel \M / \rho^\ell \int^j \Rrel \M$ is a submodule of $\int^j (\Rrel\M/\rho^\ell \Rrel\M)$ and it remains to show that $\Rrel \IntJ{j} \M/ \rho^\ell \Rrel \IntJ{j} \M$ is a quotient of $\int^j \Rrel \M / \rho^\ell \int^j \Rrel \M$.

  Let $\ell$ be sufficiently large so that \Cref{lem: KernelZellStabilises} yields an isomorphism $\int^j \Rrel \M / \ker \rho^\ell \cong \Rrel\IntJ{j}\M$.
  The map $\rho^\ell$ induces an isomorphism $\int^j \Rrel \M / \ker \rho^\ell \cong \rho^\ell \int^j \Rrel \M$.
  Therefore $\rho^\ell \int^j \Rrel \M / \rho^{2\ell}\int^j \Rrel\M \cong \Rrel \IntJ{j} \M / \rho^\ell \Rrel\IntJ{j} \M $.
  The desired quotient follows by applying the map $m\mapsto \rho^\ell m$ on $\int^j \Rrel \M / \rho^\ell \int^j \Rrel \M$.
\end{proof}
The main remaining task is to relate these results to the desired case of $\ell = 1$.
\begin{definition}
  For any $\ell \geq 1$ the {\it $G$-filtration} on a $\Rees\D_Y$-module $\mathcal{M}$ is defined by the decreasing sequence $G_j \mathcal{M} := \rho^{j}\mathcal{M}$.
\end{definition}
Due to the decreasing nature of the filtration the graded parts now have to be defined as $\gr^G_j\mathcal{M}:= G_j\mathcal{M}/G_{j+1}\M$.
Observe that $G_j\grl\M = \oplus_k F_{k-j}\M /F_{k-\ell}\M$ for any filtered $\D_Y$-module $\M$.
Hence, the following lemma is immediate.
\begin{lemma}\label{lem: GradedGGradedLYieldsGraded}
  For any filtered $\D_Y$-module $\M$ and $\ell \geq 1$ there is an isomorphism
  $$\gr^G_j \grl \M \cong \gr\M$$
  for any $j= 0,\ldots, \ell - 1$.
\end{lemma}
\begin{lemma}\label{lem: grGCommutes}
  Consider a $\Rees\D_Y$-module $\mathcal{M}$.
  Then one has an isomorphism $\gr^G\int\mathcal{M} \cong \int\gr^G\mathcal{M}$ in $\D^{b,r}(\gr\D_X)$.
\end{lemma}
\begin{proof}
  Observe that the free resolution for $\Rees \D_{Y\to X}$ following from \Cref{rem: Spencer} can be made to respect the $G$-filtrations.
  It follows that $\gr^G(\mathcal{M}\otimes^L_{\Rees\D_Y} \Rees\D_{Y\to X}) \cong \gr^G\mathcal{M}\otimes^L_{\mu^{-1}\O_X}\gr\D_X$.
  Similarly, a $\mu_*$-acyclic resolution can be found using the Godement resolution whose terms are essentially direct sums over stalks and hence respect the $G$-filtration.
  We conclude that
   $$\gr^GR\mu_*(\mathcal{M}\otimes^L_{\Rees\D_Y} \Rees\D_{Y\to X})  \cong R\mu_*(\gr^G\mathcal{M}\otimes^L_{\mu^{-1}\O_X}\gr\D_X)$$
  which is the desired isomorphism.

  %Let $\F^\bullet$ be a bimodule resolution for $\Rrel\D_{Y\to X}$ by locally free left $\Rees \D_Y$-modules.
  %There is a $G$-filtration on this complex given by $\rho^j(\mathcal{M}\otimes_{\Rees\D_Y} \F^\bullet) = (\rho^j\mathcal{M})\otimes_{\Rees\D_Y} \F^\bullet$.
  %By the flatness of locally free sheaves and the short exact sequence $0\to \oplus_j \rho^j \mathcal{M} \to \oplus_j \rho^{j-1}\mathcal{M} \to \gr^G \mathcal{M} \to 0$ it follows that $\gr^G(\mathcal{M}\otimes_{\Rees\D_Y} \F^\bullet) \cong (\gr^G\mathcal{M})\otimes_{\Rees\D_Y} \F^\bullet$.
  %Similarly to the arguments in the proof of \Cref{lem: ReesAndOtherDirectImagesAgree} the complex of $\gr^G\D_Y$-modules  $(\gr^G\mathcal{M})\otimes_{\Rees\D_Y} \F^\bullet$ can be viewed as a representative of $(\gr^G\mathcal{M})\otimes^L_{\mu^{-1}\O_X}\gr\D_X$.

  %Denote $\mathcal{G}(\blank)$ for the functor which takes a sheaf complex and returns its Godement resolution.
  %Flabby sheaves are acyclic for $\mu_*$ so the Godement resolution may be used to compute $R\mu_*$.
  %Moreover, since the terms of a Godement resolution are essentially direct sums of formal products of stalks, it is immediate that $\rho^i \mathcal{G}(\mathcal{N}^\bullet) = \mathcal{G}(\rho^i\mathcal{N}^\bullet)$ and that $\gr^G\mathcal{G}(\mathcal{N}^\bullet) =\mathcal{G}(\gr^G\mathcal{N}^\bullet)$ for any complex of right $\mu^{-1}\Rees\D_X$-modules $\mathcal{N}^\bullet$.
  %Applying $\mu_*$ to these equalities and setting $\mathcal{N}^\bullet = \mathcal{M}\otimes_{\Rees\D_Y} \F^\bullet$ yields the desired result.
\end{proof}
\begin{proposition}\label{prop: SuppGrrelIntInclusion}
  For a filtered $\D_Y$-module $\M$ with a good filtration it holds that  $$\supp \gr\IntJ{j}\M \subseteq \supp \int^j \gr\M.$$
\end{proposition}
\begin{proof}
  Let $\ell\geq 0$ be sufficiently large so that \Cref{lem: EllLargeSubquotent} holds, that is to say that $\grl\IntJ{j} \M$ is a subquotient of $\int^j \grl \M$.
  By \Cref{lem: GradedGGradedLYieldsGraded} it holds that $\gr^G\grl \IntJ{j} \M \cong (\gr\IntJ{j}\M)^\ell$.
  Morover, by \Cref{lem: EllLargeSubquotent} $\grl \IntJ{j} \M$ is a subquotient of $\int^{j} \grl\M$.
  This shows that $\supp\gr\int\M \subseteq \supp \gr^G\int\grl \M$.
  Finally, observe that $\supp \gr^G\int\grl \M = \supp \int \gr \M$ since, by \Cref{lem: grGCommutes}, $\gr^G\int\grl \M \cong \int\gr^G\grl\M\cong \int (\gr\M)^\ell$.
  This concludes the proof.
\end{proof}
\begin{theorem}\label{thm: KashiwaraEstimate}
    Let $\M$ be a coherent $\D_Y$-module. Then, for any $j\geq 0$, we have
    $$\Ch\left(\IntJ{j} \M \right)\subseteq  \widetilde{\mu}\left((T^*\mu)^{-1}(\Ch \M) \right).$$
\end{theorem}
\begin{proof}
  This is immediate from \Cref{lem: GrKashiwara} and \Cref{prop: SuppGrrelIntInclusion}.
\end{proof}
\begin{corollary}\label{cor: RelHolConserved}
  Let $\M$ be a holonomic $\D_Y$-module.
  Then, for any $j\geq 0$ the direct image $\IntJ{j}\M$ is a holonomic $\D_X$-module.
\end{corollary}
\begin{proof}
  This follows from \Cref{thm: KashiwaraEstimate} and \Cref{lem: IsotropicDirectImage}.
\end{proof}
\begin{lemma}{\cite[Proposition 4.9.]{kashiwara1976b}}\label{lem: IsotropicDirectImage}
  Let $\mu:Y\to X$ be a proper morphism and $V\subseteq T^*Y$ an isotropic subvariety. Then $\widetilde{\mu}((T^*\mu)^{-1}(\Ch \M) )$ is also isotropic.
\end{lemma}
\subsection{Regular singularities}
Let $X=\C$ considered as a complex manifold and consider an ordinary differential operator
$P(x,\partial) = \sum_{k=0}^m a_k(x)\partial^k.$
Suppose that $a_m(x)\neq 0$ for any $x\neq 0$.
Then $\M :=\D_X/\D_X P$ is locally isomorphic to $\O_X^m$ as a $\D_X$-module near any point $x\neq 0$.
In particular the solutions $\Hom_{\D_X}(\M,\O_X)$ form a locally constant sheaf of rank $m$ outside of $0$.
The solutions near zero may be more subtle due to monodromy.

Observe that $\Ch \M\subseteq \{(x,\xi): x\xi = 0\}$.
Hence, for any filtration on $\M$ there exists some $N>0$ such that
$(x\xi)^N \gr\M = 0 $.
\begin{proposition}{\cite[Section 5.1]{kashiwara2003d}}
  The following conditions are equivalent.
  \begin{enumerate}
    \item There exists a filtration on $\M$ such that $x\xi\gr\M = 0$.
    \item The equation $P(x,\partial)u=0$ has $m$ linearly independent solutions of the form $x^\lambda \sum_{j=0}^s u_j \log(x)^j $
    near $0$ for some $s\geq 0$, $\lambda \in \C$ and holomorphic $u_j$.
  \end{enumerate}
\end{proposition}
If these two equivalent conditions are satisfied one calls $0$ a {\it regular singularity} of $\M$.
This has the following generalisation to higher dimensions.
\begin{definition}
   Let $\M$ be a holonomic $\D_X$-module on a complex manifold $X$ with characteristic variety determined by some ideal sheaf $\mathcal{I}$.
   Then $\M$ is called {\it regular holonomic} if it it admits a filtration such that $\mathcal{I} \gr(\M) = 0$.
\end{definition}
Denote $D^{**}_{rh}(\D_X)$ for the full subcategory of $D^{**}(\D_X)$ consisting of complexes with regular holonomic cohomology.

It appears that these definitions should generalise directly to the algebraic situation.
However, this has unintended consequences for the Riemann-Hilbert correspondence.
For an example, let $X = \C$ as before and consider the regular holonomic $\D_X$-modules $\O_X$ and $\M := \D_X/\D_X(\partial - 1)$.
These are analytically isomorphic by the map which sends $f(x)$ to $f(x)\exp(x)$.
In particular the Riemann-Hilbert correspondence shows that they have isomorphic systems of solutions.
However, $\O_X$ and $\M$ are not algebraically isomorphic.
This seems to suggest that the equivalence between differential equations and their systems of solutions would not hold in the algebraic case.
The problem is that $\M$ is not regular at infinity.

There are a number of equivalent definitions for regularity in the algebraic case.
The following definition expresses that the analytic definition may be used provided one adds the points at infinity.
This uses the analytification functor which is provided by the GAGA principle and respects holonomicity.
\begin{definition}
  Let $\M$ be a holonomic $\D_X$-module on a smooth variety $X$.
  Denote $\iota:X \to \overline{X}$ for the smooth completion of $X$.
  Then $\M$ is called {\it regular} if $(\int_\iota \M)^{an}$ is regular holonomic on the complex manifold $\overline{X}^{an}$.
\end{definition}
\subsection{Perverse sheaves}
  Classically, the solutions to a differential equation on a vector bundle produces a local system.
  One can not expect local systems in the case of general $\D_X$-modules since their support could be a proper subvariety.
  \begin{definition}
    Let $X$ be a complex manifold. A {\it stratification} of $X$ consists of a locally finite partition $X  = \sqcup_{j\in J} X_j$ into connected locally closed subsets, called {\it strata}, such that
    \begin{enumerate}
      \item[(i)] For any $j\in J$ the {\it fronteer} $\partial X_j = \overline{X}_j\setminus X_j$ is a union of strata.
      \item[(ii)] For any $j\in J$ the spaces $\overline{X}_j$ and $\partial X_j$ are closed complex analytic subspaces.
    \end{enumerate}
  \end{definition}
  The same definition applies on algebraic varieties by replacing the analytic subspaces by subvarieties.
  \begin{definition}
     A $\C_X$-module $\mathcal{F}$ is called a {\it constructible sheaf} on $X$ if there exists a stratification $X = \sqcup_{j\in J}X_j$ such that $\mathcal{F}\vert_{X_j}$ is a local system of finite rank on $X_j$ for any $j\in J$.
  \end{definition}
  Denote $D^b_c(X)$ for the full subcategory of $D^b(\C_X)$ consisting of complexes with constructible cohomology.
  Such complexes are called {\it constructible}.

  For a constructible complex $\mathcal{F}^\bullet$ in $D^b_c(X)$ the {\it supports} and {\it cosupports} are defined dually by
  $$\supp^m\mathcal{F}^\bullet = \supp H^m \mathcal{F}^\bullet; \qquad \operatorname{cosupp}^m\mathcal{F}^\bullet = \supp^{-m}\mathbb{D}\mathcal{F}^\bullet$$
  where $\mathbb{D}\mathcal{F}^\bullet := R \Hom_\C(\mathcal{F}^\bullet,\C_X)$.
  The {\it support} $\supp \mathcal{F}^\bullet$ is the closure of the union of the $\supp^m\mathcal{F}^\bullet$.
  \begin{theorem}{\cite[Theorem 4.1.5.]{dimca2004sheaves}}
    Let $\mathcal{F}^\bullet$ be a constructible complex on $Y$ and consider a morphism $\mu:Y\to X$ which is proper on $\supp \mathcal{F}^\bullet$.
    Then $Rf_*(\mathcal{F}^\bullet)$ is constructible on $X$.
  \end{theorem}
  \begin{theorem}{\cite[Theorem 4.1.16]{dimca2004sheaves}}
    Let $\mathcal{F}^\bullet$ be a complex of $D^b(\C_X)$. Then $\mathcal{F}^\bullet$ is constructible if and only if the {\it dual} $\mathbb{D}\mathcal{F}^\bullet$ is constructible.
  \end{theorem}
  Let $D^{\leq 0}(X)$ denote the full subcategory of $D^b_c(X)$ of complexes with $\dim \supp^{-m} \mathcal{F}^\bullet < m$ and $\dim \supp^m \mathcal{F}^\bullet = 0$ for all $m\geq 0$.
  Dually $D^{\geq 0}(X)$ consists of complexes with $\dim \op{cosupp}^{-m}\mathcal{F}^\bullet <m$ and $\dim \op{cosupp}^m \mathcal{F}^\bullet = 0$ for all $m\geq 0$.
  \begin{proposition}{\cite[Proposition 5.1.12]{dimca2004sheaves}}
    The pair $(D^{\leq 0}(X), D^{\geq 0}(X))$ is a non-degenerated $t$-structure on the triangulated category $D^{b}_c(X)$.
  \end{proposition}
  \begin{definition}
    The heart of the $t$-structure on $D^b_c(X)$ are called the {\it perverse sheaves} $\operatorname{Perv}(X) = D^{\leq 0}(X)\cap D^{\geq 0}(X).$
  \end{definition}
  Observe that the objects in $\operatorname{Perv}(X)$ are not sheaves but complexes.
  The reason for the terminology perverse sheaves is that the functor $U\mapsto \operatorname{Perv}(U)$ has the gluing property of sheaves.
  More precisely, it is a stack.
  Perverse sheaves still capture the local systems.
  \begin{theorem}{\cite[Theorem 5.1.20]{dimca2004sheaves}}
    Let $X$ be a complex manifold of dimension $n$. Then $\mathcal{L}[n]$ is a perverse sheaf on $X$ for any local system $\mathcal{L}$ on $X$.
  \end{theorem}
  The following are immediate from \Cref{prop: HeartExtension} and \Cref{prop: tStructCohomD}.
  \begin{proposition}
    A constructible complex $\mathcal{F}^\bullet$ is a perverse sheaf if and only if $^pH(\mathcal{F}^\bullet) = 0$ for all $k\neq 0$.
  \end{proposition}
  \begin{proposition}
    For any distinguished triangle in $D_c^b(X)$
    $$\mathcal{F}^\bullet \to \mathcal{G}^\bullet \to \mathcal{H}^\bullet \xrightarrow{+1} $$
    it holds that if two terms are perverse sheaves then so is the third.
  \end{proposition}
\subsection{Riemann-Hilbert correspondence}
  Recall from \Cref{ex: Solutions} and \Cref{rem: Solutions} that $\Hom_{\D_X}(\M, \O_X)$ encodes the solutions of a system of differential equations.
  More generally, the solutions complex is the functor $\operatorname{Sol}(\blank) := R \Hom_{\D_X}(\blank,\O_X)[n]$ from $D^{b,\ell}(\D_X)^{opp}$ to $D^{b}(\C_X)$.
  This is a contravariant functor.
  The contravariance may be fixed using the duality functor
  $$\mathbb{D} = R\Hom_{\D_X}(\blank,\D_X)\otimes_{\O_X}^L\omega_X^{-1}[n]$$
  from $D^{b,*}(\D_X)^{opp}$ to $D^{b,*}(\D_X)$.
  The {\it de Rham complex} of $\M^\bullet$ is defined by
  $$\DR(\M^\bullet):=\Omega_X^\bullet \otimes_{\D_X} \M^\bullet[n]. $$
  \begin{proposition}{\cite[Theorem 5.3.1. ]{dimca2004sheaves}}
    There is a natural isomorphism $\Sol(\blank) \cong \DR(\mathbb{D}\blank)$.
  \end{proposition}
  \begin{proposition}{\cite[Theorem 5.3.1.]{dimca2004sheaves}}
    For any holonomic complex $\M^\bullet$ in $D_h^{b,\ell}(\D_X)$ the complexes $\Sol(\M^\bullet)$ and $\DR(\M^\bullet)$ are constructible.
  \end{proposition}
  We are finally ready to state the Riemann-Hilbert correspondence on the equivalence between differential equations and their solutions.
  \begin{theorem}[Riemann-Hilbert Correspondence]
    The de Rham functor $\DR:D_{rh}^{b,\ell}(\D_X)\ab \to D_c^b(X)$ is a $t$-exact equivalence of categories and commutes with direct images.
  \end{theorem}
  \begin{corollary}
    The de Rham functor is an equivalence of categories between the category of regular holonomic $\D_X$-modules and $\operatorname{Perv}(X)$.
  \end{corollary}
  \begin{proof}
    Follows from the Riemann-Hilbert correspondence and \Cref{prop: FunctorHeart}.
  \end{proof}
\section{Interpretation and estimation of Bernstein-Sato polynomials}\label{sec: MonodromyBS}
Philosophically, the Riemann-Hilbert correspondence states that there is an intimate connection between $\D_X$-modules and topology.
The goal of this section is to investigate a particular instantiation of this connection, namely the connection between Bernstein-Sato polynomials and monodromy.


Further, we include Kashiwara and Lichtin's proof for the estimation of the roots of the Bernstein-Sato polynomial.
This proof is an important framework for the generalisation in \cref{ch: ChapterRelHol}.

We focus on the local analytic case.
The algebraic case will be discussed in detail in the next chapter.
Consider $\C^n$ as a complex manifold and take an analytic function germ $f:(\C^n,0)\to (\C,0)$ with  $f(x) = 0$.
\subsection{Bernstein-Sato polynomials}
\begin{definition}
  Let $s$ be a new variable.
  The {\it local Bernstein-Sato polynomial} $b_{f,0}(s)\in \C[s]$ is the monic polynomial of minimal degree such that there exists some differential operator $P(x,\partial,s)$ in $\D_{\C^n,0}\otimes_{\C}\C[s]$ with
  $$P(x,\partial,s) f^{s+1} = b_{f,0}(s) f^s$$
  in the stalk at $x$.
\end{definition}
The fact that there always exists a Bernstein-Sato polynomial was proved by I.N. Bernstein, I.S. Gelfand and independently by Atiyah.
Algorithms to compute the Bernstein-Sato polynomials are known due to \cite{oaku1997algorithm}.
These algorithms have been implemented in software packages such as SINGULAR.
This package was used in the computation of the following examples.
\begin{example}\label{ex: Monomial}
  The monomial $f(x) = x_1^{\alpha_1}\cdots x_n^{\alpha_n}$ on $\C^n$ satisfies the Bernstein-Sato relation
  $$\partial_1^{\alpha_1}\cdots \partial_n^{\alpha_n} f^{s+1} = \prod_{i=1}^n (\alpha_i s + \alpha_i)\cdots (\alpha_i s + 1) f^{s}. $$
\end{example}
\begin{example}
  The hyperplane arrangement $f(x,y) = x(x+y)(x+2y)$ on $\C^2$ has local Bernstein-Sato polynomial
  $$ b_{f,0} = (s+2/3)(s+1)^2(s+4/3).$$
\end{example}
\begin{example}\label{example: CuspBs}
  The cusp singularity $f(x,y) = x^2 - y^3$ on $\C^2$ has local Bernstein-Sato polynomial
  $$b_{f,0}(s) = (s+5/6)(s+1)(s+7/6).$$
\end{example}
Note that in all these examples the set of roots $Z(b_{f,0})$ of the local Bernstein-Sato polynomial consists of negative rational numbers.
This is a general fact due to \cite{kashiwara1976b}.
The proof of this statement will be discussed in further on.
\begin{proposition}\label{prop: TrivialRoot}
  Whenever $f$ is non-constant with $f(0)=0$ it holds that $-1\in Z(b_{f,0}).$
\end{proposition}
\begin{proof}
  Substitute $s = -1$ in the Bernstein-Sato equation
  $$P(x,\partial,s)f^{s+1} = b_{f,0}(s)f^s $$
  to get that $p = b_{f,0}(-1)f^{-1}$ for some analytic germ $p\in \O_{\C^n,0}$.
  In particular,  $p$ is a well-defined in $0$ whereas $f^{-1}$ has a pole in $0$.
  This means that the equality is only possible if $b_{f,0}(-1)=0$.
\end{proof}
The roots of the Bernstein-Sato polynomial provide an invariant of singularities.
In particular, these are trivial whenever there are no singularities.
\begin{proposition}{\cite[Section 4.2]{igusa2007introduction}}
  If $f$ is non-singular in $0$ then $Z(b_{f,0}) = \{-1\}$.
\end{proposition}
\begin{remark}
  There are a number of connections between Bernstein-Sato polynomials and other invariants of singularities.
  We will soon discuss how $Z(b_{f,0})$ is connected to the topological invariant of the eigenvalues of monodromy.
  An invariant called the jumping numbers will be encountered in \cref{ch: ChapterRelHol}.

  An open problem, called the monodromy conjecture, concerns the relation between the roots of Bernstein-Sato polynomials and the poles of a certain meromorphic function called the Zeta function.
  Another connection to the world of topology is was given by a conjecture of \cite{yano1982exponents}.
  This conjecture uses the topological invariant of Puiseux characteristics in the case of a plane curve.
  The conjecture was proved in full generality by \cite{blanco2019yano}.
\end{remark}

\subsection{Monodromy}
\begin{theorem}{(\cite{milnor1968singular})}
  Let $B\subseteq \C^n$ be a small ball and pick $t\in \C^\times$ close to zero.
  The diffeomorphism class of $F_{f,0} := f^{-1}(t)\cap B $  is independent of the choice of $t$.
  This diffeomorphism class is called the {\it Milnor fiber}.
\end{theorem}
Going over a loop around the origin in $\C^\times$ induces a well-defined endomorphism $M^*$ on the singular cohomology $H^j(F_{f,0},\C)$ for every $j\in \Z$.
This is called the {\it monodromy action} and only depends on the local singularity $(f,0)$.
In particular, this means that the eigenvalues of $M^*$ on $H^j(F_{f,0},\C)$ are invariants of the singularity.
If $\lambda \in \C$ is an eigenvalue of $M^*$ on some $H^j(F_{f,0},\C)$ it is called an {\it eigenvalue of monodromy}.
The following theorem is due to Malgrange and Kashiwara.
\begin{theorem}\label{thm: EigMonodromy}
The set of eigenvalues of monodromy is equal to the set $\exp(2\pi i\ Z(b_{f,0}))$.
\end{theorem}

Monodromy is a topological notion whereas the Bernstein-Sato polynomial is defined in terms of $\D_X$-modules.
This suggest that the Riemann-Hilbert correspondence is involved.
Indeed, the monodromy of the Milnor fiber can be encoded in a constructible complex so that the Riemann-Hilbert correspondence is applicable.

Take a small open ball $B\subseteq \C^n$ such that $f$ is defined on $B$.
Let $\widetilde{\C}^\times$ denote the universal cover of $\C^\times$ and consider the projection $p:B\times \widetilde{\C}^\times \to B$.
Denote $\iota:f^{-1}(0)\to B$ for the inclusion map.
\begin{definition}
  {\it Deligne's nearby cycle functor} from $D^b_c(B)$ to $D_c^b(f^{-1}(0))$ is given by $\psi_f:= L\iota^* \circ Rp_*\circ Lp^*$.
\end{definition}
Denote $\iota_0:\{0\}\to f^{-1}(0)$ for the inclusion map.
The following theorem is due to Deligne.
\begin{theorem}
  There is an isomorphism
  $$H^i(F_{f,0}, \C) \cong \mathbb{H}^i(L\iota_0^* (\psi_f \C_B)) $$
  and the monodromy action on the cohomology of the Milnor fiber corresponds with the action of the covering transformations $\widetilde{\C}^\times \to \widetilde{\C}^\times$ on the nearby cycles.
\end{theorem}
To describe the $\D$-theoretic counterpart of this constructible complex requires the technical notion of $V$-filtrations.
The interested reader may find these concepts in \cite{budur2015bernstein}.
\subsection{Estimation of $Z(b_{f,0})$}\label{sec: Estimation}
The main idea employed in the estimation of $Z(b_{f,0})$ by \cite{kashiwara1976b} is that one can reduce to the monomial case of \Cref{ex: Monomial} by a resolution of singularities.
Hereafter one can use the $\D$-module direct image functor to relate the result on the resolution to the desired result on the original space.
Fix a small ball $B$ on which $f$ may be defined.
\begin{definition}
  Let $D$ be a divisor on $B$.
  A {\it strong log-resolution} of $(B,D)$ consists of a projective morphism $\mu:Y\to B$  with $Y$ smooth such that $\mu$ is an isomorphism over the complement of $D$ and $\mu^*D$ a simple normal crossings divisor.
\end{definition}
Let $D$ be the divisor determined by $f$.
By Hironaka's resolution of singularities one can find a strong log-resolution $\mu:Y\to B$ for $(B,D)$.
Let $g = f\circ \mu$ denote the pullback of $f$ to $Y$ and let $\operatorname{mult}_{E}(g)$ denotes the order of vanishing of $g$ on some irreducible component $E$ of $\mu^*D$.
Kashiwara was able to establish the following estimate by consideration of the direct image of the $\D_Y$-module $\D_Y g^s$.
\begin{theorem}{\cite[Corollary 5.2]{kashiwara1976b}}
  Every root of $b_{f,0}(s)$ is of the form $ -c/\operatorname{mult}_{E}(g) $ with $c\in \mathbb{Z}_{>0}$.
  In particular $Z(b_{f,0})\subseteq \mathbb{Q}_{<0}$.
\end{theorem}
Combining this estimate with \Cref{thm: EigMonodromy} one gets the following theorem.
\begin{theorem}
  The eigenvalues of monodromy are roots of unity.
\end{theorem}
\cite{lichtin1989poles} improved the estimate by similar computations for the right $\D_Y$-module $\M$ spanned by $g^s \mu^*(dx)$ inside $\D_Yg^s\otimes_{\O_Y} \omega_Y$.
The advantage of this approach is that $\mu^*(dx)$ involves the local behaviour of $\mu$.
Denote $k_E$ for the order of vanishing of the Jacobian $\operatorname{Jac}\mu$ on $E$, this is also the coefficients of the {\it relative canonical divisor} $K_{Y/B}$ on $E$.
\begin{theorem}{\cite[Theorem 5]{lichtin1989poles}}\label{thm: LichtinEstimate}
  Every root of $b_{f,0}(s)$ is of the form $-(k_E + c)/\operatorname{mult}_{E}(g)$ with $c\in \mathbb{Z}_{>0}$.
\end{theorem}
We now provide the proof for this improved estimate following Lichtin and Kashiwara.
\\

One can ensure that multiplication by $s$ stays inside $\D_B f^s$ with the following trick.
Introduce a new coordinate $x_{n+1}$ and set $\widetilde{f}= x_{n+1}f$ on a small ball $\widetilde{B}$ of $\C^{n+1}$.
Then $x_{n+1}\partial_{n+1}$ acts like $s$ on $\widetilde{f}^s$.
The induced map $\widetilde{Y} \to \widetilde{B}$ is a strong log resolution for the divisor determined by $\widetilde{f}$.
Now suppose we can prove \Cref{thm: LichtinEstimate} for $\widetilde{f}$.
Then, the theorem also follows for $f$ due to the following result.
\begin{lemma}{\cite[Section 3.32]{bjork1979rings}}\label{lem: BernsteinTilde}
  The Bernstein-Sato polynomial $b_{f,0}(s)$ is a divisor of $b_{\widetilde{f},0}(s)$.
\end{lemma}
\begin{proof}
  Let $P$ be in the stalk $\D_{\widetilde{B},0}$ such that $P \widetilde{f}^{s+1} = b_{\widetilde{f},0}(s) \widetilde{f}^s $.
  Expand $P = \sum_{j=1}^N P_j  \partial_{n+1}^{j}$
  with coefficients $P_j$ in $\D_{B,0}$.
  Then
  $$x_{n+1}^N b_{\widetilde{f},0}(s) \widetilde{f}^s = \left(\sum_{j=1}^k (s + 1)^{j} \sum_\alpha Q_{\alpha} \partial_1^{\alpha_1}\cdots \partial_n^{\alpha_n} \right)\widetilde{f}^{s+1}$$
  where the $P_j$ were expanded as polynomials in $\partial_1,\ldots,\partial_n$ with coefficients $Q_{\alpha}$ in $\O_{B,0}$.

  Observe that $\partial_1,\ldots, \partial_n$ act on the formal symbol $\widetilde{f}^{s+1}$ the same as they act on the formal symbol $f^{s+1}$.
  Expand the $Q_{\alpha}$ as power series in $x_1,\ldots,x_{n+1}$ and identify powers of $x_{n+1}$ on both sides for the desired functional equation.
\end{proof}
For notational simplicity we write $f$ instead of $\widetilde{f}$ and $B$ instead of $\widetilde{B}$ from here on.
The dimension of $B$ will be denoted by $m=n+1$.

Let $t$ be a new variable.
The sheaf of rings $\D_B\langle s,t\rangle$ is found from $\D_B$ by adjoining $s$ and $t$ subject to $ts -st = 1$ where $s,t$ commute with $\D_B$.
%The notation with the angle brackets is to emphasise that $s$ and $t$ do not commute with each other.
One can view $\D_B f^s$ as a $\D_B\langle s,t\rangle$-module by the action $t P(s)f^s = P(s+1) f^{s+1}$ for any differential operator $P$ in $\D_B[s]$.
In this notation the functional equation for $b_{f,0}$ means that $b_{f,0}\in \operatorname{Ann}_{\C[s]} (\D_B f^s / t \D_B f^s)_x$.

There is a $\O_{B}$-linear isomorphism between any left $\D_{B}$-module $\N$ and its right version $ \N \otimes_{\O_{B}}\omega_{B}$.
Concretely, any section $u$ of $\N$ gives rise to the section $u^* := u dx$.
Further, for any operator $P$ of $\D_B$ there is an adjoint $P^*$ such that
$$(P\cdot u)^* =   u^* \cdot P^*$$
for any section $u$ of $\N$.
For a vector field $\xi := \sum_i\xi_i \partial_i$ comparison of the definitions shows that $\xi^* := -\sum_i\partial_i\xi_i$ satisfies this equality and this extends to $\D_B$ by iterating.
By this procedure the functional equation $P f^{s+1} = b(s) f^s$ may equivalently be stated as the equation
$$f^{s+1}dx \cdot P^* = b(s) f^s dx $$
in $\D_{B,0} f^s \otimes_{\O_{B,0}}\omega_{B,0}$.
The corresponding module $\M$ on $Y$ will be the submodule of $\D_{Y} g^s \otimes_{\O_Y}\omega_Y$ spanned by $g^s \mu^*(dx)$.
Observe that $\M$ can be equipped with a $\D_Y\langle s,t\rangle$-module structure as before.
\begin{lemma}\label{lem: UpstairsB}
  The polynomial $b(s) = \prod_{i} \prod_{j=1}^{\mult_{E_i}(g)} (\mult_{E_i}(g)s + k_i + j)$ annihilates $\M / t\M$ where $E_i$ runs over the irreducible components of $\mu^*D$.
\end{lemma}
\begin{proof}
  This may be checked locally.
  If the chosen point is on none of divisors $E_i$ of $\mu^*D$ then $g$ is invertible so that $\M/t\M$ is trivial.
  Now suppose we are working near a point $y\in Y$ which is on $E_i$ if and only if $i\in I$ with $I$ non-empty.
  Then one can pick local coordinates $y_i$ such that
  $$ g = \prod_{i\in I} y_i^{\mult_{E_i}(g)}; \qquad \mu^*(dx) =u \prod_{i\in I} y_i^{k_i}dy$$
  where $u$ is a local unit.
  Now set $P = u^{-1}(\prod_{i\in I}\partial_i^{\mult_{E_i}(g)})u$ to get
  $$g^{s+1} \mu^*(dx)\cdot P^* = q(s) g^s \mu^*(dx)$$
  where $q(s) = \prod_{i\in I}\prod_{j=1}^{\mult_{E_i}(g)} (\mult_{E_i}(g)s +  k_i + j ). $
\end{proof}
Observe that $s,t$ can be viewed as $\D_Y$-linear injective endomorphisms on $\M$.
The associated the long exact sequence of direct images yields a $\D_B\langle s,t\rangle$-module structure on the direct image $\Int \M$ where the functorial nature of the direct image is used to ensure that $ts -st = 1$.
Similarly, the polynomial $ b(s)$ provided by \Cref{lem: UpstairsB} annihilates $\Int\M/t\Int\M$.

Consider the surjection $\D_Y\to \M$ induced by $1 \mapsto g^s \mu^*(dx)$.
The associated long exact sequence includes a morphism $\int^0\D_Y \to \Int\M$.
Observe that $\int^0\D_Y = R^0 \mu_*(\D_{Y\to B})$ contains a global section corresponding to the section $1$ of $\D_{Y\to B}$.
Let $u$ be the image of this section in $\Int\M$ and denote $\U$ for the right $\D_B\langle s,t\rangle$-module generated by $u$.
\begin{lemma}\label{lem: SurjectiveUf}
  There is a surjective morphism of right $\D_B\langle s,t\rangle$-modules $\U \to \D_B f^s \otimes_{\O_B} \omega_B$ sending $u$ to $f^s dx$.
\end{lemma}
\begin{proof}
  Pick some open set $V\subseteq B$. To show this yields a well-defined morphism of $\D_B$-modules it must be show that $(f^s dx)P = 0$ whenever $uP = 0$ in $\U(V)$.

  The resolution of singularities $Y\to B$ is an isomorphism on the complement of the divisor $D$ determined by $f$.
  Hence, $\U$, $\Int \M$ and $\D_B f^s  \otimes_{\O_B}\omega_B$ are isomorphic outside of $D$.
  It follows that the support of the coherent sheaf of $\O_V$-modules $\O_V (f^s dx) P $ lies in $D$.
  The Nullstellen Satz now yields that $f^N (f^s dx) P  = 0$ for some sufficiently large $N\geq 0$.
  Note that $f$ is a non-zero divisor of $(\D_Bf^s\otimes_{\O_B} \omega_B)(V)$.
  Therefore, $(f^s dx) P= 0$ on $V$ as desired.

  Finally, observe that $tu = fu$ so that this morphism of $\D_B$-modules also commutes with the actions by $t$ and $s$.
\end{proof}
Due to \Cref{lem: UpstairsB} there is a suitable $b$-polynomial for $\Int \M$.
By \Cref{lem: SurjectiveUf} it remains to compare $\Int\M$ and $\U$.
\begin{lemma}\label{lem: QuotientHolonomic}
  The quotient $\Int\M / \U$ is a holonomic $\D_B$-module.
\end{lemma}
\begin{proof}
  By \Cref{prop: SESBehaviourChar} the characteristic variety of $\M$ is a subset of the characteristic variety of $\D_Yg^s \otimes_{\O_Y} \omega_Y$.
  This has the same characteristic variety as $\D_Y g^s$ using the $\O_Y$-linear isomorphism between $\D_Yg^s$ and $\D_Yg^s \otimes_{\O_Y} \omega_Y$.
  By \Cref{prop: IsotropicAndDominate} it follows that $\Ch \M \subseteq W \cup \Lambda$ for some isotropic $\Lambda\subseteq T^*Y$ and an irreducible $(m+1)$-dimensional variety $W$ which dominates $Y$.

  Observe that $\M$ is certainly $\mu$-good since it admits a global good filtration $F_i\M := F_i\D_Y \cdot g^s \mu^*(dx)$.
  Hence, \Cref{thm: KashiwaraEstimate} is applicable and yields that
  $$\Ch \Int \M \subseteq \widetilde{\mu}\left((T^*\mu)^{-1} (\Lambda \cup W)\right).$$
  By \Cref{lem: IsotropicDirectImage} the set $\widetilde{\mu}((T^*\mu)^{-1}(\Lambda))$ is still isotropic and will not form any obstruction to $\Int\M/\U$ being holonomic.
  Further, observe that $\widetilde{\mu}((T^*\mu)^{-1}(W))$ remains an irreducible $(m+1)$-dimensional variety which dominates $B$.
  On the other hand $\mu$ is an isomorphism outside of $D$ so $\Int\M/\U$ is only supported on $D$.
  Intersecting $\widetilde{\mu}((T^*\mu)^{-1}(W))$ with $D$ yields a $m$-dimensional variety whence the desired result follows.
\end{proof}
\begin{proposition}\label{prop: StableZero}
  For sufficiently large $N$ it holds that $t^N (\Int \M)_0 / \U_0 = 0$.
\end{proposition}
\begin{proof}
  The sequence $t^n \Int\M / \U$ forms a decreasing sequence of holonomic $\D_B$-modules.
  By \Cref{prop: FiniteLength} the induced sequence of $\D_{B,0}$ modules in the stalk at $0$ must stabilise.
  Let $N$ be sufficiently large such that $t^N(\Int\M)_0/\U_0$ attains the stable value.

  Applying \Cref{prop: HomAlgebraic} to the $\D_{B,0}$-linear endomorphism $s$ produces a non-zero polynomial $q(s)\in \C[s]$ which annihilates $t^N(\Int\M)_0/\U_0$.
  Let $q(s)$ be of minimal degree with this property.
  Observe that $q(s+1)t = tq(s)$ so, using the stabilisation, it follows that
  $$q(s+1)t^N(\Int\M)_0/\U_0 = t q(s) t^N(\Int\M)_0/\U_0 = 0.$$
  This means that $q(s) - q(s+1)$ also annihilates $t^N(\Int\M)_0/\U_0$.
  By the minimality of the degree of $q(s)$ it follows that $q(s) - q(s+1)=0$ which is to say that $q(s)$ is a non-zero constant.
  This means that $t^N(\Int\M)_0/\U_0 = 0 $ as desired.
\end{proof}
Putting all these facts together yields the proof of \Cref{thm: LichtinEstimate}.
\begin{proof}
  Let $N$ be as in \Cref{prop: StableZero} and denote $b(s)$ for the polynomial provided by \Cref{lem: UpstairsB}.
  Set $B(s) = b(s+N+1)b(s+N)\cdots b(s)$ and observe that $B(s)\M_0 \subseteq t^{N+1}\M_0 \subseteq t\U_0$.
  In particular this means that $B(s) \in \operatorname{Ann}_{\C[s]} \U_0 / t\U_0$.

  The $\D_B\langle s,t\rangle$-linear surjection $\U \to \D_B f^s \otimes_{\O_B} \omega_B$ from \Cref{lem: SurjectiveUf} now implies that $b_{f,0}(s)$ divides $B(s)$.
  This yields the desired estimate for $Z(b_{f,0})$.
\end{proof}

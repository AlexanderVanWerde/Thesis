\chapter{Relative Holonomic Modules}\label{ch: ChapterRelHol}
\section{Introduction}\label{sec: IntoductionChapterRelative}
Let $X$ be a complex manifold or a smooth variety and a consider a morphism $F:X\to \C^p: x \mapsto (f_1(x), \ldots, f_p(x))$.
Denote $D$ for the divisor defined by $\prod f_i$ and let $\mu:Y\to X$ be a resolution of singularities for $(X,D)$.
This means that $\mu$ is a projective morphism which is a isomorphism over the complement of $D$ and such that $\mu^*D = \sum_{i=1}^r a_i E_i$ is in normal crossings form.
The behaviour of $\mu$ over $D$ is measured by the relative canonical divisor $K_{Y/X} = \sum_{i=1}^r k_i E_i$ which is locally defined by the Jacobian of $\mu$.
Write $G:Y\to \C^p$ for the lift of $F$ to $Y$.
Introducing new variables $s_1,\ldots,s_p$ we abbreviate $F^s= f_1^{s_1} \cdots f_p^{s_p}$ and similarly for $G^s$.


The local Bernstein-Sato Ideal $B_{F,x}$ of the function germ of $F$ at some point $x\in X$ consists of all polynomials $b(s_1,\ldots, s_n)$ such that there exists some local partial differential operator $P\in \D_{X,x}\otimes_{\C} \C[s_1,\ldots,s_n]$ with the following equality in the stalk at $x$
$$b(s_1,\ldots, s_n) F^s = P\cdot F^{s+1}.$$
The global Bernstein-Sato Ideal $B_F$ of $F$ is the intersection of all local Bernstein-Sato Ideals.\todo{Restate more generally with $+a$ when proof is done.}

The goal of this chapter is to estimate the zero locust $Z(B_{F})\subseteq \C^p$.
This zero locust generalises the roots of the Bernstein-Sato polynomial in the monovariate case.
The classical approximation of the roots of the $b$-polynomial is due to \cite{kashiwara1976b} and this estimation was further refined by \cite{lichtin1989poles}.
The idea in both proofs is that it is easy to explicitly compute the Bernstein-Sato polynomial for monomials and that one can reduce to this case by use of the resolution of singularities.
The main non-trivial step in these arguments is to translate the solution upstairs to a solution on $X$.
This makes use of the direct image of $\D_X$-modules.
The essential insight in the refined estimate due to Lichtin is that the direct image of $\D_X$-modules is more natural for right $\D_X$-modules than left $\D_X$-modules.


The estimate by Kashiwara has been generalised to the multivariate situation in \cite{budur2020zero}.
The main challenge in such a multivariate generalisation is that the classical proof relies on modules of the type $\D_X f^{s}/ \D_X f^{s+1}$ being holonomic.
This is no longer the case for the multivariate generalisation $\D_X[s_1,\ldots, s_n]f^s /\D_X[s_1,\ldots, s_n]f^{s+1}.$
The notion of relative holonomicity, due to \cite{maisonobe2016filtration}, still holds.

In this chapter we generalise the refined estimate by \cite{lichtin1989poles} to the multivariate situation.
The main new ingredient is a induction argument which reduces the problem to the monovariate case where relative holonomicity becomes ordinary holonomicity.
This induction is similar to the arguments in \cite{budur2019zero}.
\begin{theorem}\label{thm: EstimateBernsteinSatoZeroLocust}
  With notation as above every irreducible component of $Z(B_F)$ of codimension $1$ is a hyperplane of the form
  $$\operatorname{mult}_{E_i}(g_1) s_1 + \cdots + \operatorname{mult}_{E_i}(g_r)s_r + k_i + c_i=0$$
  with $c_i \in \mathbb{Z}_{> 0 }$.
\end{theorem}
\todo{Should also give a overview of the results that are already known here. }
\section{Relative Notions}
Let $X$ be a smooth complex irreducible algebraic variety of dimension $n$.
For a regular commutative $\C$-algebra integral domain $R$ we define a sheaf of rings on $X\times \Spec R$ by
$$\A_{X}^R = \D_X \otimes_{\C} \O_{\Spec R}; \qquad \A_X = \A_{X}^{\C[s]}$$
It will also be convenient to use the abbreviation $\O_{X}^R := \O_{X \times \Spec R}$.
These sheaves can be viewed as a particular case of the sheaf of relative differential operators $\D_{X\times S / S}$ for some product space $X\times S$.
Such sheaves have been studied in \cite{monteiro2016riemann}, in particular there is a suitable version of the Riemann-Hilbert correspondence.

The order filtration $F_p\D_X$ extends to a filtration $F_p\A^R_X = F_p\D_X \otimes_{\C} \O_R$ on $\A^R_X$ which is called the relative filtration.
The associated graded objects are denoted by $\grrel$. Denote $\pi:T^*X\times \Spec R \to X\times \Spec R$ for the projection map.
As in the case of $\D_X$-modules one can view $\pi^{-1}(\grrel\A_X^R)$ as a subsheaf of $\O_{T^*X}^R$ and for any $\grrel\A_X^R$-module $\mathcal{M}$ there is a corresponding module on $T^*X\times \Spec R$ defined by $\O_{T^*X}^R\otimes_{\pi^{-1}\grrel\A_X^R}\pi^{-1}\mathcal{M}$.
By abuse of notation the corresponding module on $T^*X\times \Spec R$ is still denoted with $\mathcal{M}$ and we adopt the perspective that $\grrel\A_X^R$-modules always live on $T^*X\times \Spec R$ unless explicitly mentioned otherwise.

Similarly to the case of $\D_X$ it holds that $\A_X^R$ is the sheaf of rings generated by $\O_X^R$ and $\Theta_X$ inside of $\mathcal{E}nd_{\C}(\O_X^R)$. Giving a left $\A_X^R$-module is equivalent to giving a $\O_X^R$-module $\M$ with $\Theta_X$-action such that
$\xi\cdot (fm) = f (\xi \cdot m)  + \xi(f)\ m  $
for any sections $f$ of $\O_X^R$ and $\xi$ of $\Theta_X$. Similarly, giving a right $\A_X^R$-module is equivalent to giving a $\O_X$-module $\M$ with $\Theta_X$-action such that $(mf)\cdot\xi = (m\cdot\xi)f - m\ \xi(f) $ for any sections $f$ of $\O_X^R$ and $\xi$ of $\Theta_X$.

The following results are analogous to those in \cref{ch: ChapterDX}.
They can also follow from general results in \cite[Appendix III]{bjork1993analytic}.
\begin{proposition}\label{prop: CoherentAndGoodFiltration}
    A quasi-coherent $\A_X^R$-module $\M$ is coherent if and only if it admits a filtration such that $\grrel \M$ is coherent over $\grrel \A_X^R$. Such a filtration is called a good filtration.
\end{proposition}
\begin{proposition}
    Let $\M$ be a coherent $\A_X^R$-module, then the support of $\grrel \M$ in $T^*X \times \Spec R$ is independent of the chosen good filtration. It is called the characteristic variety of $\M$ and denoted $\Chrel \M$.
\end{proposition}
\begin{lemma}\label{lem: SESBehaviourA}
    Consider a short exact sequence of coherent $\A_X^R$-modules
    $$0\to \M_1 \to \M_2 \to\M_3 \to 0 $$
    then it holds that
    $$\Chrel \M_2 = \Chrel \M_1 \cup \Chrel \M_3. $$
\end{lemma}
A coherent $\A_X^R$-module $\M$ is said to be relative holonomic over $R$ if $\Chrel \M = \cup_w \Lambda_w \times S_w$
for irreducible conic Lagrangian subvarieties $\Lambda_w\subseteq T^*X$ and irreducible closed subvarieties $S_w\subseteq \Spec R$.

\begin{lemma}\label{lem: RelHolGs}
  The sheaf of $\A_X^R$-modules $\A_Y F^s$ is relative holonomic.
\end{lemma}
\begin{proof}
  This result may be found as proposition 13 in \cite{maisonobe2016filtration}. The proof applies in both the analytic and algebraic cases.
\end{proof}

\begin{lemma}\label{lem: InclusionCharVar}
  Let $\M$ be a finitely generated $\A_Y^R$-module. Suppose that $\Chrel \M \subseteq \Lambda \times \Spec R$ for some, not necessarily irreducible, conic Lagrangian subvariety $\Lambda\subseteq T^*X$. Then $\M$ is relative holonomic over $R$.
\end{lemma}
\begin{proof}
  This result may be found in \cite{maisonobe2016filtration} in the analytical case and \cite{budur2019zero} in the algebraic case.
\end{proof}
The Bernstein-Sato ideal may be defined more generally for any $\A_X^R$-module $\M$ as $B_\M := \Ann_{R}\M$. To see how this generalises $B_F$ one considers $\A_X^R F^s$ as a $\Xt$-module.
Here $t$ is a new variable which commutes with sections of $\D_X$ and satisfies $ts_i - s_it = 1$ for any $i=1,\ldots, n$.  The $\Xt$-module structure on $\A_X^R F^s$ is then defined by extending $tF^s = F^{s + 1}$. From this point of view $B_F = B_{\A_X^R F^s / t\A_X^R F^s}$.

The Bernstein-Sato ideal may be recovered from the characteristic variety.
\begin{proposition}\label{prop: ProjectionBernsteinSatoRelativeChar}
  Let $\M$ be a relative holonomic $\A_X^R$ module. Then  $Z(B_\M) = \pi_2(\Ch^{rel}(\M))$ where $\pi_2:T^*X\times \Spec R \to \Spec R$ is the projection on the second coordinate.
\end{proposition}
\begin{proof}
  This result may be found in \cite{maisonobe2016filtration} in the analytical case and \cite{budur2019zero} in the algebraic case.
\end{proof}
\section{Direct Image Functor for $\A_X^R$-modules}
    In this section we state the natural generalisation of the direct image functor for $\D_X$-modules to the relative case of $\A_X^R$-modules. As with $\D$-modules this is the most natural for right-modules.\todo{more introduction}

    Consider some morphism $\mu:Y\to X$ and denote $\mu^R$ for the induced map from $Y\times \Spec R$ to $X\times \Spec R$.
    A transfer $(\A_Y^R,(\mu^R)^{-1}\A_X^R)$-bimodule is defined by $\A_{Y\to X}^R:= \D_{Y\to X}\otimes_{\C} R .$ Written out, this means that $\A_{Y\to X}^R = \O_Y^R \otimes_{(\mu^R)^{-1}\O_X^R}(\mu^R)^{-1}\A_X^R$.
    \begin{definition}
      The direct image functor $\int_{\mu^R}$ from $D^{b,r}(\A_Y^R)$ to $D^{b,r}(\A_X^R)$ is defined to be $R\mu^R_* (\blank\otimes_{\A_Y^R}^L \A_{Y\to X}^R)$.
      For any $\A_Y^R$ module $\M$ the $j$-th direct image is the $\A_X^R$-modules $\int_{\mu^R} \M = \H^j \int_{\mu^R} \M$.
      The subscript $\mu^R$ will be suppressed whenever there is no ambiguity.
    \end{definition}
    Observe that a free $\A_Y^R$-resolution for a complex $\M^\bullet$ is also a free $\D_Y$-resolution.
    Hence, the following isomorphism holds in $D^{b,r}(\D_X)$ on $Y\times \Spec R$
    $$\M^\bullet \otimes_{\A_Y^R}^L \A_{Y\to X}^R \cong \M^\bullet \otimes_{\D_Y}^L \D_{Y\to X}.$$
    Denote $p_X:X\times \Spec R \to X$ for the projection map.
    Due to \cref{prop: GrothendieckIsomorphism} one has isomorphisms
    $$R(p_X)_* \circ R\mu^R_* \cong R(p_X \circ \mu^R)_* \cong R\mu^* \circ R(p_Y)_*.$$
    Combining the right-hand-sides of these isomorphisms yields the $\D_X$-module direct image.
    This is to say that the $\A_Y^R$-module direct image computes the $\D_Y$-module direct image with additional structure.

    By definition as a derived functor a long exact sequence is immediate.
    \begin{proposition}
        For any short exact sequence of $\A_Y^R$-modules
        $$0\to \M_1 \to \M_2 \to \M_3 \to 0$$
        there is a long exact sequence in direct images
        $$0\to \int^0 \M_1 \to \int^0 \M_2 \to \int^0 \M_3 \to \int^1 \M_1 \to \cdots. $$
    \end{proposition}
    Analogously to the case of $\D_X$-modules the direct image conserves relative holonomic modules.
  \begin{definition}
      A $\D_Y$-module $\M$ is said to be $\mu$-good if $X$ admits a open cover $\{V_j\}_{j\in J}$ such that $\M$ has a good filtration on $\mu^{-1}(V_j)$ for every $j\in J$.
  \end{definition}
  \begin{theorem}\label{thm: RelHolConserved}
      Suppose that $\mu$ is proper and let $\M$ be a $\mu$-good relative holonomic $\D_Y$-module. Then $\int \M$ has relative holonomic cohomology.
  \end{theorem}
  \begin{proof}
      This result may be found in \cite[Theorem 1.17]{monteiro2016riemann}.
  \end{proof}
\section{Non-commutative Homological Notions}
In this section we discuss homological notions associated to the $\Ext$-functor the noncommutative sheaf of rings $\A_X^R$.
These notions are particularly well-behaved for relatively holonomic modules.
The results are sheaf-theoretic rewording of the similar results in \cite{budur2019zero} which are themselves derived from the appendices of \cite{bjork1993analytic}.
\begin{definition}
  For a non-zero coherent sheaf of $\A_X^R$-modules $\M$ the smallest integer $k\geq 0$ such that $\Ex{\A_X^R}{k}(\M,\A_X^R)\neq 0$ is called the grade of $\M$ and is denoted $j(\M)$.
\end{definition}


The following proposition gives geometrical meaning to grades.
\begin{proposition}\label{prop: AXRBehaviourGradesJAndChrel}
  For coherent $\A_X^R$-modules $\M$ it holds that
  $$j(\M) + \dim \Chrel \M = 2n + \dim R $$
  where $\dim R$ denotes the Krull dimension of the ring $R$.
\end{proposition}
\begin{proof}
  This is lemma 3.2.2 in \cite{budur2019zero}.
\end{proof}
\begin{corollary}\label{cor: GradeIFFBernsteinIdeal}
  Let $\M$ be a relative holonomic $\A_X^R$-module. Then $\M$ has grade strictly greater than $n$ if and only if $B_\M$ is non-zero.
\end{corollary}
\begin{proof}
  This is immediate from \cref{prop: ProjectionBernsteinSatoRelativeChar} and \cref{prop: AXRBehaviourGradesJAndChrel}.
\end{proof}
\begin{definition}
  A non-zero coherent sheaf of $\A_X^R$-modules $\M$ is called $j$-pure if $j(\N)=j(\M)=j$ for every non-zero submodule $\N$.
\end{definition}
\begin{lemma}\label{lem: ExtGrade}
  Let $\M$ be a non-zero coherent $\A_X$-module of grade $j$. Then $\Ex{\A_X^R}{k}(\M,\A)$ has grade greater than or equal to $k$ for any $k\geq 0$ and $\Ex{\A_X^R}{j}(\M,\A_X^R)$ is a $j$-pure $\A_X^R$-module.

  Moreover $\M$ is $j$-pure if and only if $\Ex{\A_X^R}{j}(\Ex{\A_X^R}{k}(\M,\A_X^R),\A_X^R)=0$ for every $k\neq j$.
\end{lemma}
\begin{proof}
  This is lemma 4.3.5 in \cite{budur2019zero}.
\end{proof}
\begin{lemma}
  Let $\M$ be a relative holonomic $\A_X^R$-module of grade $j$. Then $\Ex{\A_X^R}{j}(\M,\A_X^R)$ is a relative holonomic $\A_X^R$-module and
  $$\Ch^{rel}\Ex{\A_X^R}{j}(\M,\A_X^R)\subseteq \Chrel \M. $$
\end{lemma}
\begin{proof}
  This is lemma 3.2.4 in \cite{budur2019zero}.
\end{proof}
\begin{lemma}
  Let $P \subseteq R$ be a prime ideal and let $\M$ be a coherent $\A_X^{R/P}$-module. If $\M$ is relative holonomic as a $\A_X^R$-module then it is also relative holonomic over $\A_X^{R/P}$.
\end{lemma}
\begin{proof}
  That $\M$ is relative holonomic over $\A_X^{R}$ means that it admits a good filtration such that
  $$\supp \gr_{\A_X^R}^{rel} \M  = \bigcup \Lambda \times S_\Lambda $$
  for Lagrangian subvarieties $\Lambda \subseteq T^* X \times \Spec R$ and algebraic varieties $S_\Lambda \subseteq \Spec R$.
  This filtration descends to a good filtration over $\A_{X}^{R/P}$ and it holds that
  $$\supp \gr_{\A_X^{R/P}}^{rel}\M = (\Id_{T^*X} \times \Delta)^{-1}(\supp \gr_{\A_X^R}^{rel}\M)$$
  where $\Delta:\Spec R/P\to \Spec R$ is the closed embedding.
  This yields the desired result.
\end{proof}
\begin{lemma}\label{lem: TorRelHol}
  Let $\M$ be a relative holonomic $\A_X^R$-module and let $P\subseteq R$ be a prime ideal. Then, for any $k\geq 0$, $\Tr{\A_X^R}{k}(\M, \A_X^{R/P})$ is a relative holonomic $\A_X^{R/P}$-module.
 \end{lemma}
\begin{proof}
  Compute $\Tr{\A_X^R}{k}(\M, \A_X^{R/I})$ with a locally free $\A_X^R$-resolution of $\A_X^{R/I}$.
  Then \cref{lem: SESBehaviourA} and \cref{lem: InclusionCharVar} show that it is a relative holonomic $\A_X^R$-module.
  The claim follows by the foregoing lemma.
\end{proof}
\begin{lemma}\label{lem: NotBernsteinInjectiveAutomorphism}
  Let $\M$ be a relative holonomic $\A_X^R$-module which is $(n+k)$-pure for some $0\leq k \leq \dim R$. If $b\in R$ is not contained in any minimal prime ideal containing $B_\M$ then multiplication by $b$ induces injective automorphisms on $\M$ and $\Ex{\A_X^R}{n+k}(\M,\A_X^R)$. Moreover, there exists a good filtration on $\M$ such that $b$ induces a injection on $\grrel \M$.
\end{lemma}
\begin{proof}
  This is lemma 3.4.2 in \cite{budur2019zero}.
\end{proof}
The proof of the following lemma is a slight modification on the proof of proposition 3.4.3 in \cite{budur2019zero}.
\begin{lemma}\label{lem: RestrictToCM}
  Let $\M$ be a non-zero relative holonomic $\A_X^R$-module of grade $j(\M) = n$  then, for any non-unit $b\in R$, it holds that $\M \otimes_R R/(b)$ is a non-zero relative holonomic  $\A_X^{R/(\ell)}$-module of grade $n$.
\end{lemma}
\begin{proof}
  Applying \cref{lem: TorRelHol} with $k=0$ yields that $\M \otimes_R R/(b)$ is a relative holonomic $\A_X^{R/(\ell)}$-module.

  It remains to establish that $\M \otimes_R R/(b)$ is non-zero of grade $n$.
  By taking a free resolution of $\M$ one has that
  $$R\Hom_{\scaleto{\A_X^R}{8pt}}(\M,\A_X^R)\otimes_{\scaleto{\A_X^R}{8pt}}^L \A_X^{R/(b)} \cong R \Hom_{\scaleto{\A_X^{R/(b)}}{8pt}}(\M\otimes_{\scaleto{\A_X^R}{8pt}}^L \A_X^{R/(b)}, \A_X^{R/(b)}) $$
  where we note that $\A_X^{R/(b)}$ is a $\A_X^{R}$-bimodule so that both tensor products are well-defined.
  We compare the Grothendieck spectral sequences of both sides of this isomorphism.

  The spectral sequence associated with the right-hand-side has $E^2$-sheet\todo{Fix super/subscripts etc}
  $$E_{pq}^2 = \Ex{\A_X^{R/(b)}}{p}(\Tr{\A_X^R}{-q}(\M, \A_X^{R/(b)}), \A_X^{R/(b)}).$$
  Recall from \cref{lem: ExtGrade} terms with $p>n$ have grade greater than $n$ and due to \cref{lem: AXRBehaviourGradesJAndChrel} there are no non-zero terms with $p<n$.
  Hence, the only term with $p+q = n$ which could potentially have degree $n$ is $E_{n0}^2$.
  If we can show that the total cohomology of degree $n$ on the left-hand-side has grade $n$ then it follows that $\Ex{\A_X^{R/(b)}}{n}(\M\otimes_{\scaleto{\A_X^R}{8pt}} \A_X^{R/(b)}), \A_X^{R/(b)}) \neq 0$.

  The spectral sequence associated to the left-hand-side has $E^2$-sheet given by
  $$E^2_{pq} =\Tr{\A_X^R}{-q}( \Ex{\A_X^R}{p}(\M,\A_X^R), \A_X^{R/(b)}).$$
  Note that there are no non-zero differentials which map into $E^j_{0n}$ or for $j\geq 2$.
  Further, the differentials out of the $E_{0n}^j$ land in $E_{-j(n+j)}^j$ which is a subquotient of $\Tr{\A_X^R}{j}(\Ex{\A_X^R}{n+j+1}(\M,\ab \A_X^R)\ab , \A_X^{R/(b)})$.
  Since $\Ex{\A_X^R}{n+j}(\M,\A_X^R)$ is relative holonomic of degree $n+j$ \cref{prop: AXRBehaviourGradesJAndChrel} and a argument similarly to that which established that $\M \otimes_R R/(b)$ is relative holonomic yield that $E_{j(n+j+1)^j}$ has grade greater than or equal to $n+j-1$.
  We will show that that $E^2_{0n}$ has grade $n$.
  Then using \cref{prop: AXRBehaviourGradesJAndChrel} and \cref{lem: SESBehaviourA} on the exact sequences
  $$0 \to E^{j+1}_{0n}\to  E^j_{0n} \to E_{j(n+j+1)^j} $$
  it follows that $E^j_{0n}$ has grade $n$ for every $j\geq 2$.
  This shows that the total cohomology of degree $n$ has grade $n$ and concludes the proof.

  Denote $\E^n := \Ex{\A_X^R}{n}(\M,\A_X^R)$, by \cref{lem: ExtGrade} it holds that $\E^n$ is a $n$-pure relative holonomic $\A_X^R$-module.
  By \cref{lem: NotBernsteinInjectiveAutomorphism} it follows that $b$ induces injections on $\E^{n}$ and $\gr^{rel} \E^{n}$ for some appropriate filtration.
  In particular the vertical maps in the following diagram are injective
  $$\begin{tikzcd}
    0 \arrow{r} & F_{i-1} \E^n\arrow{r} \arrow{d}{b}& F_i \E^{n}\arrow{r} \arrow{d}{b}& \gr^{rel}_i \E^n\arrow{r}\arrow{d}{b} & 0\\
    0 \arrow{r} & F_{i-1} \E^n\arrow{r} & F_i \E^{n}\arrow{r} & \gr^{rel}_i \E^n\arrow{r} & 0
  \end{tikzcd} $$
  so the snake lemma yields a short exact sequence
  $$\begin{tikzcd}
    0 \arrow{r} & F_{i-1} \E^n\otimes_R R/(b)\arrow{r} & F_i \E^{n}\otimes_R R/(b)\arrow{r} & \gr^{rel}_i \E^n\arrow{r}\otimes_R R/(b) & 0.
  \end{tikzcd} $$
  The injectivity of $b$ on $\gr^{rel}\E^n$ implies that $b$ is also injective on $\E^n/F_i\E^n$. A similar application of the snake lemma now yields a short exact sequence
  $$\begin{tikzcd}
    0 \arrow{r} & F_{i} \E^n\otimes_R R/(b)\arrow{r} & \E^{n}\otimes_R R/(b)\arrow{r} & (\E^n/F_i \E^n )\arrow{r}\otimes_R R/(b) & 0.
  \end{tikzcd} $$
  A filtration on $\E^n \otimes_R R/(b)$ is induced by the image of $F_i\E^n$. By the injectivity of the short exact sequences one now has isomorphisms
  \begin{align*}
    F_i(\E^n \otimes_R R/(b)) \cong F_i\E^n / (F_i \E^n \cap b\E^n) \cong F_i \E^n / b F_i \E^n \cong  (F_i\E^n) \otimes_R R/(b)
  \end{align*}
  combined with the surjectivity of the first short exact sequence it follows that
  $$\gr^{rel}(\E^n \otimes_R R/(b)) \cong \gr^{rel}\E^n \otimes_R R/(b). $$
  It follows that
  $$\Ch^{rel}(\E^n \otimes_{\A_X^R} \A_X^{R/(b)})  = (\Id_{T^*X} \times \Delta)^{-1}(\Chrel \M)$$
  with $\Delta: \Spec R/(b) \to \Spec R$ the closed embedding as before. Since $\M$ has grade $n$ this equality and \cref{prop: AXRBehaviourGradesJAndChrel} imply that $\Ch^{rel}(\E^n \otimes_{\A_X^R} \A_X^{R/(b)})$ has dimension $n + \dim R - 1$.
  In particular it follows that $\E^n \otimes_{\A_X^R} \A_X^{R/(b)}$ is non-zero and has grade $n$. This concludes the proof.
\end{proof}
By \cref{lem: ExtGrade} the following definition gives a class of $j$-pure modules.
\begin{definition}
  A coherent $\A_X^R$-module $\M$ is said to be $j$-Cohen-Macaulay for some $j\geq 0$ if $\Ex{\A_X^R}{k}(\M,\A_X^R) = 0$ for any $k\neq j$.
\end{definition}
The property of being $j$-pure is not stable when restricting to a subscheme of $\Spec R$.
For the subclass of $j$-Cohen-Macaulay modules the restriction is more well-behaved.
\begin{lemma}\label{lem: CMLemmaBudur}
  Let $\M$ be a relative holonomic and $(n+k)$-Cohen-Macaulay $\A_X^R$-module. Let $b\in R$ be non-vanishing on every irreducible component of $Z(B_\M)$. Then it holds that $\M\otimes_R R/(b)$ is a relative holonomic $(n+k)$-Cohen-Macaulay $\A_X^{R/(b)}$-module or zero.
\end{lemma}
\begin{proof}
  This is shown in the proof of proposition 3.4.3 in \cite{budur2019zero}. This proof is similar to the proof of \cref{lem: RestrictToCM} which was based on \cite{budur2019zero}.
\end{proof}
\begin{lemma}\label{lem: GradeToCMOverOpen}
  Let $\M$ be a relative holonomic $\A_X^R$-module of grade $n+k$. Then there exists a open $\Spec R' \subseteq \Spec R$ such that $\M\otimes_R R'$ is a relative holonomic and $(n+k)$-Cohen-Macaulay $\A_X^{R'}$ module. Moreover it may be assumed that the complement of $\Spec R'$ in $\Spec R$ has codimension $>k$.
\end{lemma}
\begin{proof}
  This is established in the proof of lemma 3.5.2 in \cite{budur2019zero}.
\end{proof}
The following lemma is a generalisations of a result by \cite{kashiwara1976b} to the relative case.
The proof and statement are more involved than the original result by Kashiwara but follow the same line of thought.
\begin{lemma}\label{lem: StabilisationtN}
  Let $\M$ be a relative holonomic $\A_X^R$-module which comes equipped with the structure of a $\Xt$-module.
  Suppose that $\M$ has grade $j(\M) = n+k$ with $k\geq 1$.
  Then there exists a open $\Spec R' \subseteq \Spec R$ such that $\M' = \M \otimes_{R} R'$ is a relative holonomic $\A_X^{R'}$-module with $t^N \M' = 0$ for $N$ sufficiently large. Moreover, it may be assumed that $\Spec R \setminus \Spec R'$ has codimension strictly greater than $k$.
\end{lemma}
\begin{proof}
  The proof is split in two main parts. The first part it is establishes that $\Ex{\A_X^{R'}}{n+k}(t^i\M',\ab\A_X^{R'})$ stabilises and that the $t^i\M'$ are $(n+k)$-Cohen-Macauley. It follows that $t^i\M'$ stabilises and the final part of the proof deduces that the stable value is zero.

  Note that $\M/t\M$ is a coherent sheaves over the Noetherian sheaf of rings $\A_X^R$.
  Hence, the kernel of the morphisms $\M/t\M \to t^i\M / t^{i+1}\M$ stabilise.
  Let $N\geq 0$ be sufficiently large so that these kernels are constant for $i\geq N$.

  By use of \cref{lem: GradeToCMOverOpen} it may be assumed that $\Spec R'$ is such that $t^i\M'$, $\M'/t^{i}\M'$, $t^i\M'/t^{i+1}\M'$ and the kernels $K_i$ of the morphisms $\M'/t\M' \to t^i \M'/ t^{i+1} \M'$ are zero or $(n+k)$-Cohen-Macauley for any $i=0,\ldots,N$.
  Since localisation is an exact functor the stabilisation of kernels for $i\geq N$ is still valid over $\Spec R'$.
  The first steps in this proof use the stabilisation to establish that the modules are actually $(n+k)$-Cohen-Macaulay for arbitrary $i\geq 0$. For notational simplicity we abbreviate $\E^{k}(\M') :=\Ex{\A_X^{R'}}{k}(\M',\A_X^{R'})$.

  The surjection $\M'/t\M' \twoheadrightarrow t^i \M'/t^{i+1}$ induces a long exact sequence
  $$0 \to \E^{n+k}\left(\frac{t^i\M'}{ t^{i+1}\M'}\right) \to  \E^{n+k}\left(\frac{\M'}{t\M'}\right) \to \E^{n+k}\left(K_i\right) \to \E^{n+k+1}\left(\frac{t^i\M'}{ t^{i+1}\M'}\right)\to \cdots $$
  In particular there is a isomorphism $\E^{n+k+1}(t^i\M'/t^{i+1}\M') \cong \E^{n+k}(K_i)\ab/\img \E^{n+k}(\M'\ab /t\M')$ whose left-hand-side is known to vanish when $i\leq N$.
  Since the right-hand-side is constant for $i\geq N$ it follows that $\E^{n+k+1}(t^i\M'/t^{i+1}\M')\cong 0$ for any $i\geq 0$.
  The higher order terms of the long exact sequence yield $\E^{n+k+j}(\frac{t^i\M'}{ t^{i+1}\M'}) \cong 0$ for $j>1$.
  This shows that $t^i \M'/t^{i+1}\M'$ is $(n+k)$-Cohen-Macaulay or zero for any $i\geq 0$.


  The injection $t^{i+1} \M'\to t^{i}\M'$ induces exact sequences
  $$\E^{n+k+j}\left(\frac{t^i\M'}{ t^{i+1}\M'}\right) \to  \E^{n+k+j}\left(t^{i}\M'\right) \to \E^{n+k +j}\left(t^{i+1} \M'\right).$$
  By induction on $i$ it follows that $t^i\M'$ is $(n+k)$-Cohen-Macaulay or zero for any $i\geq 0$.
  Similarly the long exact sequence induced by the surjection $\M/t^{i+1}\M' \twoheadrightarrow \M'/t^{i}\M'$ yields that $\M/t^{i}\M$ is $(n+k)$-Cohen-Macaulay or zero for any $i\geq 0$.


  By the Cohen-Macauley results which have been established it follows that the morphisms $\E^{n+k}( t^i\M') \to  \E^{n+k}(t^{i+1}\M')$ and $\E^{n+k}(\M') \to \E^{n+k} (t^i\M',\ab \A_X^{R'})$ are surjective.
  Note that $\E^{n+k}(\M)$ is a coherent sheaf over the Noetherian sheaf of rings $\A_X^{R'}$.
  Hence the kernels of $\E^{n+k}(\M') \to \E^{n+k} (t^i\M')$ stabilise.
  After possibly increasing $N$ it follows that the morphisms $\E^{n+k}(t^i\M') \to  \E^{n+k}(t^{i+1}\M')$ are isomorphisms for $i\geq N$ which means that $\E^{n+k}(t^{i+1}\M')$ stabilises.

  By $t^i \M'$ being $(n+k)$-Cohen-Macaulay it follows that $\E^{n+k}(\E^{n+k}(t^i\M')) \cong t^i\M'$.\todo{Provide reference, maybe include and prove earlier since this is easy from double complex}
  It follows that $t^i \M'$ stabilises for $i\geq N$ and remains to show that this stable value is $0$.
  If the stable value is non-zero then it is $(n+k)$-Cohen-Macaulay with $k>1$.
  By \cref{cor: GradeIFFBernsteinIdeal} it follows that there exists some non-zero $b(s_1,\ldots,s_p) \in B_{t^N\M'}$.
  Note that one has the commutation relation
  $$tb(s_1,\ldots,s_p) = b(s_1+1,\ldots, s_p + 1)t.$$
  Since $t^{N+1}\M' = t^N\M'$ it follows by iteration that $b(s_1+n,\ldots, s_p + n)\in B_{t^N \M'}$ for any $n\geq 0$.
  This implies that $Z(B_{t^N\M'}) = 0$ which means that $t^N\M' = 0$.\todo{Geometrically obvious but may want to add formal argument}
\end{proof}
\section{Estimation of the Bernstein-Sato Zero Locust}
This section contains the main result of this chapter, namely a proof of the improved estimate for the Bernstein-Sato zero locust which was announced in \cref{thm: EstimateBernsteinSatoZeroLocust}.
We use the same notation as \cref{sec: IntoductionChapterRelative}.
This proof is similar to the method employed by \cite{lichtin1989poles} and \cite{kashiwara1976b} but a new induction argument is required in the proof of \cref{lem: GradeNPlusOne}.\\

\noindent
Recall that the global Bernstein-Sato Ideal is the intersection of all local ones.
This means that the global Bernstein-Sato zero locust $Z(B_F)$ is the union of all local ones so it suffices to estimate $Z(B_{F,x})$.
In particular, it may be assumed that $X$ is affine and admits global coordinates $x_1,\ldots,x_n$.

Due to these global coordinates there is a $\O_X^R$-linear isomorphism between any left $\A_X^R$-module $\N$ and it's right version $\omega_X \otimes_{\O_X}\N$. Concretely, any section $u$ of $\N$ gives rise to the section $u^* := u dx$. Further, for any operator $P$ of $\A_X^R$ there is a adjoint $P^*$ such that
$$(P\cdot u)^* =   u^* \cdot P^*$$
for any section $u$ of $\N$. For a vector field $\xi := \sum_i\xi_i \partial_i$ comparison of the definitions shows that $\xi^* := \sum_i\partial_i\xi_i$ satisfies this equality and this extends to $\A_X^R$ by iterating.

By this procedure the functional equation $P F^{s+1} = b F^s$ may equivalently be stated as the equation
$$F^{s+1}dx \cdot P^* = b F^s dx $$
in $\A_X F^s \otimes_{\O_X}\omega_X$.
The corresponding module $\M$ on $Y$ will be the submodule of $\omega_Y\otimes_{\O_Y} \A_Y G^s$ spanned by $G^s \mu^*(dx)$.
Observe that $\omega_Y\otimes_{\O_Y} \A_Y G^s$ is relative holonomic by \cref{lem: RelHolGs} so the submodule $\M$ is certainly also relative holonomic.
One can equip $\M$ with the structure of a $\XtR{Y}{}$-module by the action $t G^s \mu^*(dx) = G^{s+1} \mu^*(dx)$.

The replacement of $\A_XF^s$ by it's right version $\A_XF^s \otimes_{\O_X}\omega_X$ is convenient because the direct image functor is more natural for right modules.
This will make it easier to transfer information along the resolution of singularities.
Further, it explains why the relative canonical divisor occurs in the improved estimate of \cref{thm: EstimateBernsteinSatoZeroLocust}.
This is because $\mu^*(dx)$ gives a local equation for $K_{Y/X}$.
\begin{lemma}\label{lem: BernsteinSatoPolynomialUpstairs}
  In the notation of \cref{sec: IntoductionChapterRelative} a polynomial of the form
  $\prod_{i=1}^p \prod_{j=1}^N(\operatorname{mult}_{E_i}(g_1)\ab s_1 + \cdots + \operatorname{mult}_{E_i}(g_r)\ab s_r + k_i + j)$
  belongs to the Bernstein-Sato ideal $B_{\M/t\M}$ if $N\geq 0$ is sufficiently large.
\end{lemma}
\begin{proof}
  This may be checked locally.
  Take a open $U\subseteq Y$ which is sufficiently small to admit local coordinates $z_1,\ldots,z_n$ where $z_i$ determines $E_i$ if $E_i\cap U \neq \emptyset$.

  In these local coordinates $G^s = \prod_{i=1}^p u_i^{s_i} \prod_{i=1}^nz_i^{\sum_{j=1}^p M_{ij}s_j}$ and $\mu^*(dx) = v \prod_{i=1}^n z_i^{m_i} dz$ where $M_{ij} \leq \operatorname{mult}_{E_i}(g_j)$, $m_i \leq k_i$ and $u_i,v$ are local units.
  For notational convenience set $u_i=1$ and $s_i=0$ for $i>p$.
  Denote $N_i = \sum_j M_{ij}$ and $\xi_i = \partial_i - \sum_{j=1}^n s_ju_j \partial_i(u_j)$.
  Let $P = v^{-1}(\prod_{i=1}^p u_i^{-1})\xi_1^{N_1} \cdots \xi_p^{N_p} v$ then
  $$v\prod_{i=1}^n u_i^{s_j + 1}z_i^{\sum_{j=1}^p M_{ij}(s_j+1) + m_i}dz \cdot P =  b v \prod_{i=1}^nu_i^{s_j}z_i^{\sum_{j=1}^p M_{ij}s_j + m_i}dz $$
  where
  $$b = \prod_{i=1}^p(\sum_{j=1}^p M_{ij}s_j + m_i + N_i)(\sum_{j=1}^p M_{ij}s_j + m_i + N_i - 1)\cdots(\sum_{j=1}^p M_{ij}s_j + m_i +1 ).$$
\end{proof}
Consider the surjection $\A_Y^R\to \M$ induced by $1\mapsto G^s \mu^*(dx)$.
The associated long exact sequence includes a morphism $\int^0 \A_Y^R \to \Int\M$.
Observe that $\int^0 \A_Y^R = R^0\mu_*(\A_{Y\to X}^R)$ contains global section corresponding to $1$.
Write $u$ for the image of this section in $\Int \M$ and denote $\U$ for the right $\A_X$-module generated by $u$.
From \cref{lem: BernsteinSatoPolynomialUpstairs} one gets a $b$-polynomial of a desirable form for $\Int \M/t\Int\M$.
The main remaining difficulty in is to induce a $b$-polynomial for $\U/t\U$.
This will exploit \cref{lem: StabilisationtN} whence it is needed that $\Int\M /\U$ has grade at least $n+1$.

In what follows we want to consider the $\A_Y$-module $\M$ as a $\D_Y$-module.
This could disturb coherence.
To solve this one introduces new coordinates such that there are vector fields $\mathcal{S}_1,\ldots, \mathcal{S}_p$ which acts as $s_1,\ldots,s_p$ on the generator.

Note that there are finitely many codimension $1$ components in $Z(B_F)$.
Hence, there exist $p$ independent linear polynomials $\sum_{i=1}^p d_{ij}s_i$ such that for any $j$ there is no hyperplane parallel to $\sum_{i=1}^p d_{ij}s_i = 0$ in $Z(B_F)$.
Moreover, it may be assumed that the $d_{ij}$ are non-negative integers.
Introduce new coordinates $z_{n+1}, \ldots,z_{n+p}$ and set $\X:= X\times \C^p$ and $\Y := Y\times \C^p$.
For any $j=1,\ldots, p$ set $\widetilde{f}_j = f_j\prod_{i=1}^p z_{n+i}^{d_{ij}}$.
Note that the induced map $\Y \to \X$ is a resolution of singularities for $\prod \widetilde{f}_i$ and that $\widetilde{g}_j = g_j\prod_{i=1}^p z_{n+i}^{d_{ij}}$ is the pullback of $\widetilde{f}_i$.

For any $i=1,\ldots,p$ it holds that
$$\widetilde{G}^s \mu^*(dx)\cdot \partial_{n+i} = \sum_{j=1}^p d_{ij}s_j x_j^{-1} \widetilde{G}^s \mu^*(dx).$$
Since the linear polynomials are independent a appropriate $\C$-linear combination provides a vector field $\zeta_j$ with $\widetilde{G}^s \mu^*(dx)\cdot \zeta_j = s_{j}z_j^{-1}\widetilde{G}^s \mu^*(dx)$.
Set $\mathcal{S}_j = \zeta_jz_j$ so that $\widetilde{G}^s \mu^*(dx) \cdot \mathcal{S}_j = s_j \widetilde{G}^s \mu^*(dx) $.
This solves the coherence issue.
\begin{lemma}\label{lem: ReplacementIsAllowed}
  If $b\in B_{\widetilde{F}}$ for any $x\in X\times \{0\}^p$ then $b \in B_F$.
\end{lemma}
\begin{proof}
  Take local coordinates $x_1,\ldots, x_{n+p}$ near $x$ and let $P$ be in the stalk of $\A_{\X}$ at $x$ such that $b \widetilde{F}^s = P \widetilde{F}^{s+1}$.
  Similarly to the above there is a $\C$-basis $\xi_1,\ldots,\xi_p$ for the span of $\partial_{n+1}, \ldots, \partial_{n+p}$ so that $\mathcal{S}_j := x_{n+j}\xi_j$ satisfies $\mathcal{S}_j \cdot \widetilde{F}^s = s_{j}\widetilde{F}^s$.
  Expand $P$ as a polynomials in $\xi_1,\ldots,\xi_p$
  $$P = \sum_{\alpha} P_\alpha \xi_{1}^{\alpha_1}\cdots \xi_{p}^{\alpha_p}$$
  where the coefficients $P_\alpha$ live in a stalk of $\O_{\X}\otimes_{\O_\X}\D_\X$.

  Let $N$ be greater than the maximal value of $\abs{\alpha}$ then
  $$(x_{n+1}\cdots x_{n+p})^N b \widetilde{F}^s = \left(\sum_{\alpha} \prod_{i=1}^p (s_i + 1)^{\alpha_i} \sum_\beta Q_{\alpha\beta} \partial_1^{\beta_1}\cdots \partial_n^{\beta_n} \right)\widetilde{F}^{s+1}$$
  where the $P_\alpha$ were expanded as polynomials in $\partial_1,\ldots,\partial_n$ with coefficients $Q_{\alpha\beta}$ from $\O_{\X}$.
  Observe that $\partial_1,\ldots, \partial_n$ act on the formal symbol $\widetilde{F}^{s+1}$ the same as they act on the formal symbol $F^{s+1}$.

  Now consider this functional equation on the analytification of $\X$ and expand the $Q_{\alpha\beta}$ as power series at $x$.
  Identifying powers of $x_{n+1}\cdots x_{n+p}$ on both sides a functional equation with analytical coefficients for $F^s$ follows.
  This establishes that $b \in B_{F,x}$ for any $x\in X$ provided analytical and algebraic Bernstein-Sato ideals are equal.\todo{Is this true?}
\end{proof}
Note that replacing $F$ by $\widetilde{F}$ leaves \cref{thm: EstimateBernsteinSatoZeroLocust} unchanged up to hyperplanes parallel to $\sum_{i=1}^p d_{ij}s_i = 0$.
These are not in $Z(B_F)$ by assumption so, by \cref{lem: ReplacementIsAllowed}, it remains to prove the theorem for $\widetilde{F}$.
For notational simplicity we simply write $F$ instead of $\widetilde{F}$.
Further, we denote $m = n+p$ for the the dimension of $\X$ and $\Y$.

Let $\ell_1,\ldots,\ell_{p-1}\in \C[s]$ be degree one polynomials which will be fixed later.
For any $i=0\ldots,p$ let $L_i$ be the ideal of $\C[s]$ generated by $\ell_1,\ldots,\ell_i$.
Assume that the $\ell_i$ are chosen sufficiently generically so that $Z(L_{p-1})$ is a line.
\begin{lemma}\label{lem: CharVarEstimateW}
  The $\D_\Y$-module $\M\otimes_{\C[s]}\C[s]/L_{p-1}$ is coherent and it's characteristic variety satisfies $\Ch\M\otimes_{\C[s]}\C[s]/L_{p-1} \subseteq V \cup W $ where $V$ is isotropic and $W$ is a irreducible variety of dimension $m +1$ which dominates $\Y$.
\end{lemma}
\begin{proof}
  Recall that we ensured that $\M$ is a coherent $\D_\Y$-module.
  Hence, also $\M\otimes_{\C[s]}\C[s]/L_{p-1}$ will be a coherent $\D_\Y$-module.

  Take local coordinates $z_1,\ldots,z_n,z_{n+1},\ldots,z_{n+p}$ on $\Y$ as in the proof of \cref{lem: BernsteinSatoPolynomialUpstairs}.
  This is to say that locally
  $$G^s \mu^*(dx) = v \prod_{i=1}^nu_i^{s_j}z_i^{\sum_{j=1}^p M_{ij}s_j + m_i}\prod_{i=1}^n z_{n+i}^{\sum_{j=1}^p d_{ij}s_j} dz.$$
  Let $s_0$ denote a new variable so that $\C[s]/L_{p-1}\cong \C[s_0]$.
  Then $\M\otimes_{\C[s_0]}R/L_{p-1}$ may be viewed as the $\D_\Y$-module which is locally generated by a formal symbol
  $$[G^s \mu^*(dx)] =v \prod_{i=1}^{2n} u_i^{A_i s_0 + a_i}z_i^{B_i s_0 + b_i} dz $$
  where $A_i,B_i,a_i,b_i$ are complex numbers and we set $u_{n+i}=1$.
  Moreover, since the linear functions $\sum_{j=1}^p d_{ij}s_j$ on the final terms in $G^s\mu^*(dx)$ formed a basis for the linear polynomials there will be at least one $B_{i+n}$ which is non-zero.

  Denote $w = v\prod_{i=1}^n u_i^{a_i}$ and consider for any $j=1,\ldots,n+p$ the operation of $w^{-1}\partial_j wz_j$ on the generator
  $$[G^s \mu^*(dx)]\cdot w^{-1}\partial_j w =((B_j s_0 + b_j)z_j^{-1} + \sum_{i=1}^{n} A_i s_0 u_i^{-1}\partial_j(u_i) )[G^s \mu^*(dx)].$$
  Recall that the $s_1,\ldots,s_n$ could be produced by acting with a vector field.
  Since $s_0$ is found with affine relations it follows that there exists some differential operator $\mathcal{S}_0$ of degree $1$ such that $s_0 [G^s \mu^*(dx)] = [G^s \mu^*(dx)]\cdot \mathcal{S}_0$.
  Now we get a well-defined surjection $\D_\Y/I \twoheadrightarrow \M\otimes_{\C[s]}\C[s]/L_{p-1}$ where $I$ denotes the right ideal generated by $w^{-1}\partial_j wz_j - b_j - \mathcal{S} h_i$ with $h_j = B_j + z_j\sum_{i=1}^n A_iu_i^{-1}\partial_j(u_i)$ for $j=1,\ldots, n+p$.

  Note that $ z_j\sum_{i=1}^n A_iu_i^{-1}\partial_j(u_i) = 0$ for $j>n$.
  Hence, the $h_{n+j}$ are complex scalars and they are not all zero since there exists a non-zero $B_{n+j}$.
  After renumbering we now have that $h_1 \in \C^\times$.
  Denoting $\zeta_j, \sigma_0$ for the elements of $\gr \D_\X$ which correspond to $\partial_j, \mathcal{S}_0$ respectively it holds that $\gr I$ contains $z_j \zeta_j - h_j \sigma_0$ for any $j=1,\ldots, n+p$.
  Then also $h_1z_j \zeta_j - h_jz_1 \zeta_1$ is in $\gr I$ for any $j=2,\ldots, n+p$.
  This yields the desired bound for the characteristic variety.
\end{proof}
\begin{lemma}\label{lem: QuotientsRelativeHolonomic}
  If the $\A_\X$-module $\Int\M/U$ has grade $m$ then the quotients $(\Int\M/\U)\otimes_{\C[s]} \C[s]/L_{i}$ are relative holonomic $\A_\X^{R/L_i}$-modules of grade $m$.
\end{lemma}
\begin{proof}
  This follows by induction on $i=0,\ldots,p$ using \cref{lem: RestrictToCM} which is applicable by \cref{cor: GradeIFFBernsteinIdeal}.
\end{proof}
\begin{lemma}\label{lem: InjectiveEll}
  Any polynomial $b\in \C[s]$ which is not in $L_i$ induces a injective automorphisms on $\M \otimes_{\C[s]}\C[s]/L_i$.
\end{lemma}
\begin{proof}
  Observe that $\M$ has a trivial Bernstein-Sato ideal so that it has degree $m$ by \cref{cor: GradeIFFBernsteinIdeal}
  By inductively applying \cref{lem: RestrictToCM} it holds that $\M \otimes_{\C[s]}\C[s]/L_i$ has degree $m$.
  In particular, it has a trivial Bernstein-Sato ideal.

  Similarly to the proof of \cref{lem: CharVarEstimateW} one can pick local coordinates $z_i$ such that $\M \otimes_{\C[s]}\C[s]/L_i$ is generated by some formal symbol $[G^s \mu^*(dx)]$.
  Further pick some isomorphism $\C[s]/L_i \cong \C[\widetilde{s}]$.
  By definition of the formal symbol $\partial_i$ acts on $[G^s \mu^*(dx)]$ as a polynomial in $\widetilde{s}$ with rational functions of the $z_i$ as coefficients.

  If $b$ is not injective it follows by clearing denominators that there is some non-zero polynomial $f = \sum_{\alpha,\beta} c_{\alpha,\beta} z^\alpha \widetilde{s}^\beta$ with $[G^s \mu^*(dx)] f = 0$.
  Further, it can be assumed that the degree of $f$ in $z$ is zero.
  Indeed, if $z_i$ occurs in $f$ then one can find a non-zero polynomial $g$ of lesser degree such that
  $$[G^s \mu^*(dx)] f\partial_1 = [G^s \mu^*(dx)]\partial_1 f + [G^s \mu^*(dx)] g.$$
  The left-hand-side of this equality vanishes and the term $[G^s \mu^*(dx)]\partial_1 f$ must also vanish since $\partial_i$ acts as a rational function.
  This means that $[G^s \mu^*(dx)] g = 0$.
  Repeating this procedure it may be assumed that $f$ is a non-zero polynomial in $\C[\widetilde{s}]$.

  Since $\C[\widetilde{s}]$ commutes with $\A_Y^{\C[\widetilde{s}]}$ it follows that $f$ is a non-zero Bernstein-Sato polynomial of $\M \otimes_{\C[s]}\C[s]/L_i$ which is a contradiction.
\end{proof}
\begin{lemma}\label{lem: GradeNPlusOne}
  The relative holonomic $\A_\X$-module $\Int\M/\U$ has grade $j(\Int\M/\U)\geq m+1$.
\end{lemma}
\begin{proof}
  Suppose that $\Int\M/\U$ has grade $m$.
  A contradiction will be derived by replacing $\Int\M/\U$ with a holonomic $\D_\X$-module.
  The first task is to understand how $\int^0(\M\otimes_{\C[s]}\C[s]/L_{p-1})$ relates to $(\Int\M)\otimes_{\C[s]}\C[s]/L_{p-1}$.

  Recall from \cref{lem: InjectiveEll} that $\ell_{i}$ is injective on $\M \otimes_{\C[s]} \C[s]/L_{i-1}$. This implies that
  $\ell_{i}\Int \M \otimes_{\C[s]} \C[s]/L_{i-1} = \int^0 \ell_{i}\M\otimes_{\C[s]} \C[s]/L_{i-1}.$
  The injective automorphisms of $\ell_i$ on $\M \otimes_{\C[s]} \C[s]/L_{i-1}$ induces a long exact sequence of $\A_X^{\C[s]/L_{i-1}}$-modules
  $$0 \to \int^0\left(\M \otimes_{\C[s]} \frac{\C[s]}{L_{i-1}}\right) \xrightarrow{\ell_i} \int^0 \left(\M \otimes_{\C[s]} \frac{\C[s]}{L_{i-1}}\right) \to \int^0\left(\M \otimes_{\C[s]} \frac{\C[s]}{L_{i}}\right) \to \cdots $$
  whence $(\Int \M\otimes_{\C[s]} \C[s]/L_{i-1})\otimes_{\C[s]} \C[s]/(\ell_{i})$ is a submodule of $\int^0(\M \otimes_{\C[s]} \C[s]/L_{i})$.
  The quotient is isomorphic to the kernel $K_i$ of $\ell_i$ on $\int^1(\M \otimes_{\C[s]} \C[s]/L_{i-1})$.


  Applying a tensor product with $\C[s]/L_{p-1}$ to the inclusion $(\Int \M/L_{i-1}) \otimes_{\C[s]}\C[s]/(\ell_i)\hookrightarrow \int^0(\M\otimes_{\C[s]}\C[s]/L_i)$ yields a exact sequence
  $$\cdots \to \Tr{\C[s]}{1}\left(K_i, \frac{\C[s]}{L_{p-1}}\right) \to \left(\Int \M\otimes_{\C[s]}\frac{\C[s]}{L_{i-1}}\right) \otimes_{\C[s]}\frac{\C[s]}{L_{p-1}} \to \left(\Int\M\otimes_{\C[s]}\frac{\C[s]}{L_i}\right)\otimes_{\C[s]}\frac{\C[s]}{L_{p-1}}.$$

  We claim that the $\ell_i$ can be chosen so that $\Tr{\A_\X^{\C[s]/L_i} }{1}(K_i, \A_\X^{\C[s]/L_{p-1}})$ is a relative holonomic $\A_\X^{R/L_{p-1}}$-module of grade greater than or equal to $m+1$.
  Let's show how this suffices to finish the proof and prove this claim afterwards. \\

  By \cref{cor: GradeIFFBernsteinIdeal} the statement that $\Tr{\A_\X^{\C[s]/L_i} }{1}(K_i, \A_\X^{\C[s]/L_{p-1}})$ has grade greater than $m$ is equivalent to the existence of a non-zero polynomial $b_i\in \C[s]/L_{p-1}$ which annihilates $\Tr{\C[s]/L_{i}}{1}(K_i, \C[s]/L_{p-1} ))$.
  Denote $B = \prod_{i=1}^{p-1}b_i$ and note that the kernels of the automorphisms induced by $B^N$ form a increasing sequence inside the coherent $\A_X^{\C[s]/L_{p-1}}$-module $(\Int \M\otimes_{\C[s]}\C[s]/L_{i-1})\otimes_{\C[s]}\C[s]/L_{p-1}$.
  Such a increasing sequence must stabilise for sufficiently large $N$.
  Then it follows that
  $$\img \Tr{\C[s]}{1}\left(K_i, \frac{\C[s]}{L_{p-1}}\right)\bigcap B^N\left(\Int \M\otimes_{\C[s]}\frac{\C[s]}{L_{i-1}}\right)\otimes_{\C[s]}\frac{\C[s]}{L_{p-1}} = 0.$$


  We get injections
  $$\cdots \hookrightarrow B^N \left(\Int \M\otimes_{\C[s]}\frac{\C[s]}{L_{i-1}}\right) \otimes_{\C[s]}\frac{\C[s]}{L_{p-1}} \hookrightarrow B^N \left(\Int\M\otimes_{\C[s]}\frac{\C[s]}{L_i}\right)\otimes_{\C[s]}\frac{\C[s]}{L_{p-1}}\hookrightarrow\cdots  $$

  Since $\mu$ is proper the Kashiwara estimate for $\D_\X$-modules\todo{Put in Chapter 1} is applicable and \cref{lem: CharVarEstimateW} yields that $\int^0(\M\otimes_{\C[s]} \C[s]/L_{p-1})$ is a coherent $\D_\X$-module with characteristic variety $\widetilde{\mu}\left((T^*\mu)^{-1}(V\cup W)\right)$.
  It follows that $B^N(\Int\M)\otimes_{\C[s]}\C[s]/L_{p-1}$ is a coherent $\D_\X$-module
  and
  $$ \Ch B^N \left(\left(\Int\M\right)\otimes_{\C[s]}\frac{\C[s]}{L_{p-1}}\right)\subseteq \mathcal{L} \cup \widetilde{\mu}\left((T^*\mu)^{-1}(V\cup W)\right).$$

  Now observe that $B^N(\Int\M/ \U)\otimes_{\C[s]}\C[s]/L_{p-1}$ is a quotient of $B^N(\Int\M) \otimes_{\C[s]} \C[s]/L_{p-1}$ with support in the divisor $D$.
  Hence, $B^N(\Int\M/ \U)\otimes_{\C[s]}\C[s]/L$ is a coherent $\D_\X$-module with
  $$\Ch\left( B^N\left(\Int\M/ \U\right)\otimes_{\C[s]}\C[s]/L_{p-1}) \right)\subseteq \mathcal{L} \cup \widetilde{\mu}\left((T^*\mu)^{-1}(V\cup W)\right) \cap \left(T^*\X\times_\X \supp D\right).$$

  This means $B^N(\Int\M/ \U)\otimes_{\C[s]}\C[s]/L_{p-1}$ is a holonomic $\D_\X$-module.
  Indeed, by (\todo{Put somewhere in Chapter 1 \cite[proposition 4.9]{kashiwara1976b}.}) $\widetilde{\mu}((T^*\mu)^{-1}(V))$ remains isotropic and forms no obstruction to the characteristic variety being Lagrangian.
  Moreover, $\widetilde{\mu}((T^*\mu)^{-1}(W))$ is irreducible of dimension $m+1$ and dominates $\X$.
  Intersecting with $T^*\X\times_\X \supp D$ then yields a closed strict subset which necessarily has lower dimension.
  Hence, it follows that $\dim \Ch B^N (\Int\M/ \U)\otimes_{\C[s]}\C[s]/L_{p-1} \leq m$.
  This means that $B^N(\Int\M/ \U)\otimes_{\C[s]}\C[s]/L_{p-1}$ is holonomic.
  By (\todo{\cite{bjork1979rings} holonomic implies $s$ is algebraic}) the Bernstein-Sato ideal of holonomic modules is non-zero.
  But then also the Bernstein-Sato ideal of $(\Int\M/ \U)\otimes_{\C[s]}\C[s]/L_{p-1}$ is non-zero.
  This contradicts \cref{lem: QuotientsRelativeHolonomic} and we conclude that the assumption the grade is $m$ must have been wrong.\\

  It remains to show that the $\ell_j$ can be chosen so that $\Tr{\A_\X^{\C[s]/L_i} }{1}(K_i, \A_\X^{\C[s]/L_{p-1}})$ is a relative holonomic $\A_\X^{\C[s]/L_{p-1}}$-module of grade greater than or equal to $m+1$.
  This means we must understand the $\Ext$-functor of a $\Tor$.
  Hence, we consider the interaction between the derived $\Hom$-functor and the derived tensor product.

  By a taking a $\A_{\X}^{\C[s]/L_{i}}$-free resolution of $K_i$ one finds that
  $$R \Hom_{\scaleto{\A_\X^{ \C[s]/L_{p-1} }}{8pt} }(K_i\otimes^L_{\scaleto{ \A_\X^{\C[s]/L{i}} }{8pt} } \A_\X^{\C[s]/L_{p-1} },\A_\X^{ \C[s]/L_{p-1}} ) \cong R \Hom_{ \scaleto{\A_\X^{\C[s]/L_{i}}}{8pt} } (K_i,\A_\X^{\C[s]/L_{i}}) \otimes^L_{\scaleto{ \A_\X^{\C[s]/L_{i}}}{8pt} } \A_\X^{\C[s]/L_{p-1}}$$
  where we note that $\A_\X^{\C[s]/L_{p-1}}$ is a $\A_X^{\C[s]/L_{i}}$-bimodule so that both tensor products are defined.
  We compare the Grothendieck spectral sequences of both sides.

  The spectral sequence on the left-hand-side has terms
  $$E_{rq}^2 = \Ex{\A_\X^{\C[s]/L_{p-1}}}{r}(\Tr{\A_\X^{\C[s]/L_{i}} }{-q}(K_i,\A_X^{\C[s]/L_{p-1}}),\A_\X^{\C[s]/L_{p-1}}).$$
  Since $\Tr{\A_\X^{\C[s]/L_{i}} }{-q}(K_i,\A_X^{\C[s]/L_{p-1}})$ is a relative holonomic $\A_X^{\C[s]/L_{p-1}}$-module these terms are only non-zero for $r=m$ or $r = m+1$.
  In particular, the spectral sequence degenerates at $E^2$.
  Note that the statement that $\Tr{\A_\X^{\C[s]/L_i}}{1}(K_i, \A_\X^{\C[s]/L_{p-1}})$ has grade greater than or equal to $m+1$ is equivalent to $E^2_{m,-1} = 0$.
  %This term is $\dim\X$-pure.
  %Hence, it suffices to ensure that all terms on the right-hand-side with $p+q = \dim\X-1$ have grade greater at least $n+1$.

  The spectral sequence on the right-hand-side has terms
  $$E^2_{rq} = \Tr{\A_\X^{\C[s]/L_{i}} }{-q}(\Ex{ \A_\X^{\C[s]/L_{i}} }{r} (K_i,\A_\X^{\C[s]/L_{i}}), \A_\X^{\C[s]/L_{p-1}}).$$
  The claim follows if we can ensure that that all terms with $r-q = m -1$ vanish on $\X\times\Spec R$ for some open subset $\Spec R\subseteq \C^p$.  %\todo{Maybe add more explanation?}
  Indeed, then by \cref{cor: GradeIFFBernsteinIdeal} the terms have grade $m+1$ and it follows that the same must hold for the terms of the spectral sequence on the left hand side.
  Since $\Ext^{m}$ of a relative holonomic module is $m$-pure or zero this means that the $E^2_{m,-1}$-term in the left-hand-side spectral sequence vanishes.
  \\

\newpage
  The $\ell_i$ and the open $\Spec R$ are constructed by induction on $i$. For any $i,j,k$ with $k\leq i$ denote $\E_{ik}^{n+j}:= \Ex{\A_\X^{R/L_{k}} }{n+j}(K_k, \A_\X^{R/L_k}) \otimes_{\scaleto{\A_\X^{R/L_{k}}}{8pt}} \A_\X^{R/L_{i}}$.
  In every induction step it is ensured that
  \begin{enumerate}[label=(\roman*)]
    \item $\E_{ii}^{n+j}$ is $(n+j)$-Cohen-Macaulay over $\A_X^{R/L_i}$ or zero for every $j\geq 0$.
    \item $Z(L_i)\cap \Spec R \neq 0$.
    \item $\ell_i$ induces a injection on $\E_{(i-1)k}^{n+j}$
    for every $j\geq 0$ and $k<i$.
  \end{enumerate}
  By abuse of notation $L_i$ may also denote the ideal of $R$ generated by $\ell_1,\ldots,\ell_i$.

  Take some arbitrary $\ell_1$ for the base-case and use \cref{lem: GradeToCMOverOpen} to find a open $\Spec R \subseteq \C^p$ such that $\E^{n+j}_{11}$  is $(n+j)$-Cohen-Macaulay for every $j\geq 0$.
  This only requires removing a strict closed subset of $\Spec \C[s]/L_1$ so $Z(L_1)\cap \Spec R = \Spec R/L_1$ is non-empty.
  The final property is vacuous for $i=1$.

  Now assume that $i>1$ and that $\ell_1,\ldots, \ell_{i-1}$ are already constructed.
  First let's ensure that $\ell_i$
  induces a injection on $\E^{n+j}_{(i-1)k}$ for every $j\geq 0$ and $k<i$.
  By iterative application of \cref{lem: CMLemmaBudur} it holds that $\E^{n+j}_{(i-1)k }$
  is $(n+j)$-Cohen-Macaulay over $\A_\X^{L_{i-1}}$.
  Take $\ell_i$ so that the induced element of $R/L_{i-1}$ is non-constant and does not vanish on any irreducible component of the Bernstein-Sato zero locust of $\E^{n+j}_{(i-1)k}$ for every $j\geq 0$ and $k<i$.
  Then, by \cref{lem: NotBernsteinInjectiveAutomorphism} the desired injectivity follows.
  As before, \cref{lem: GradeToCMOverOpen} can be used to to find a open $\Spec R' \subseteq \Spec R$ such that $\E^{n+j}_{ii}$  is $(n+j)$-Cohen-Macaulay for every $j\geq 0$ and  $Z(L_i)\cap \Spec R' = \Spec R'/L_i$ is non-empty.
  Note that replacing $\Spec R$ by $\Spec R'$ will conserve the induction hypothesis.
  This concludes the inductive construction of the $\ell_i$.\\


  Applying injectivity of $\ell_i$ on $\E_{(i-1)k}^{n+j}$ with the free resolution $\A_\X^{R/L_{i-1}}\to\A_\X^{R/L_{i-1}}$ for $\A_\X^{R/L_i}$ yields that $\Tr{\A_\X^{R/L_i}}{m}(\E_{(i-1)k}^{n+j}, \A_\X^{R/L_i}) = 0$ for all $m>0$.
  By taking a $\A_\X^{R/L_{i-1}}$-free resolution of $\mathcal{E}_{(i-1)k}^{n+j}$ it follows that
  $$\mathcal{E}_{(i-1)k}^{n+j} \otimes^L_{\scaleto{\A_\X^{R/L_{i-1}}}{8pt}} \A_\X^{R/L_{p-1}} \cong  \mathcal{E}_{ik}^{n+j}  \otimes^L_{\scaleto{\A_\X^{R/L_{i}}}{8pt}}\A_\X^{R/L_{p-1}}. $$


  Iterative application of the isomorphism yields $\E_{ii}^{n+j}\otimes^L_{\scaleto{\A_\X^{R/L_{i}}}{8pt}} \A_\X^{R/L_{p-1}} \cong \E_{(p-2)i}^{n+j}\otimes^L_{\scaleto{\A_\X^{R/L_{p-2}}}{8pt}} \A_\X^{R/L_{p-1}}$.
  This means that
  $$\Tr{\A_\X^{\C[s]/L_{i}}}{-q} (\Ex{\A_\X^{\C[s]/L_{i}} }{r} (K_i,\A_\X^{\C[s]/L_{i}}), \A_\X^{\C[s]/L_{p-1}})\cong \Tr{\A_\X^{\C[s]/L_{i}} }{-q}(\E_{(p-2)i}^{r}, \A_\X^{\C[s]/L_{p-1}}) $$
  The right right-hand-side of this isomorphism was already observed to vanish for any $-q > 0$ and the left-hand-side is precisely the $E_{rq}^2$-term of the spectral sequence.
  This establishes that the $E_{rq}^2$-terms with $r-q = m -1$ vanish for $q>0$.
  The remaining terms $E_{m -1,0}$ is zero regardless since it involves $\Ext^{m - 1}$ of a relative holonomic module.
  This shows that the $\Tr{\A_\X^{\C[s]/L_i}}{1}(K_i, \A_\X^{\C[s]/L_{p-1}})$ are relative holonomic $\A_\X^{\C[s]/L_{p-1}}$-module of grade greater than or equal to $m+1$ and concludes the proof.
  \end{proof}



The following lemma and it's proof are similar to the monovariate case which may be found in \cite[p246]{bjork1979rings}.
\begin{lemma}\label{lem: SurjectionUF}
  There is a morphism right $\A_\X^R$-modules $\U\to \A_\X^RF^s \otimes_{\O_\X}\omega_\X$ sending $u$ to $F^sdx$.
\end{lemma}
\begin{proof}
   The resolution of singularities $\Y\to \X$ is a isomorphism on the complement of $\prod f_i = 0$. Hence, a isomorphism $\U = \Int \M \cong  \A_\X^RF^s  \otimes_{\O_\X}\omega_\X$ holds outside of $\prod f_i = 0$.

  Pick some open set $V\subseteq \X$ we must show that whenever $uP = 0$ in $\U(V)$ it follows that $(F^s dx)P = 0$.
  Due to the isomorphism it is certainly the case that $(F^s dx) P = 0$ outside of $\prod f_i = 0$.
  Hence, the support of the coherent sheaf of $\O_V^R$-modules $\O_V^R (F^s dx) P $ lies in $\prod f_i = 0$.
  The Nullstellen Satz now yields that $(\prod f_i)^N (F^s dx) P  = 0$ for some sufficiently large $N\geq 0$.
  Note that $\prod f_i$ is a non-zero divisor of $(F^s\otimes_{\O_\X} \omega_\X)(V)$. Hence, it follows that $(F^s dx) P= 0$ on $V$ as desired.
\end{proof}
Now all ingredients are in place for the proof of \cref{thm: EstimateBernsteinSatoZeroLocust}.
\begin{theorem}
  With notation as in \cref{sec: IntoductionChapterRelative} every irreducible component of $Z(B_F)$ of codimension $1$ is a hyperplane of the form
  $$\operatorname{mult}_{E_i}(g_1) s_1 + \cdots + \operatorname{mult}_{E_i}(g_r)s_r + k_i + c_i=0$$
  with $c_i \in \mathbb{Z}_{\geq 0 }$.
\end{theorem}
\begin{proof}
  By \cref{lem: GradeNPlusOne} the $\A_X$-module $\M/\U$ has grade greater than or equal to $m + 1$. Hence \cref{lem: StabilisationtN} provides $N\geq 1$ such that $t^N\M/\U = 0$ on a open $\X\times\Spec R$ for some open $\Spec R\subseteq \C^p$ with complement of codimension strictly greater than $1$.

  Let $b(s_1,\ldots,s_p)$ denote the Bernstein-Sato polynomial for $\M/t\M$ provided by \cref{lem: BernsteinSatoPolynomialUpstairs}.
  Set $B := \prod_{i=0}^{N+1} b(s_1 + i, \ldots, s_p + i)$ then it follows that
  $B\M \subseteq t\U$ on $\X \times \Spec R$.
  In particular this means that $B$ is in the Bernstein-Sato ideal of $\U/t\U$ over $\Spec R$.
  By the surjection of \cref{lem: SurjectionUF} this means that $B\in B_F$ over $\Spec R$. This proves which proves the theorem because the complement of $\Spec R$ has codimension strictly greater than 1.
\end{proof}
